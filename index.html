<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="site.webmanifest">
  <title>PBE Score Keeper</title>
  <link href="css/jquery-ui.min.css" rel="stylesheet">
  <script src="scripts/jquery-3.7.1.min.js"></script>
  <script src="scripts/jquery-ui.min.js"></script>
  <!-- Yjs CRDT Library - Bundled for browser -->
  <script src="scripts/yjs-bundle.min.js"></script>
  <script src="scripts/app-globals.js"></script>
  <script src="scripts/app-yjs.js"></script>
  <script src="scripts/app-theme.js"></script>
  <script src="scripts/app-state.js"></script>
  <script src="scripts/app-data.js"></script>
  <script src="scripts/app-reorder.js"></script>
  <script src="scripts/app-summaries.js"></script>
  <script src="scripts/app-import-export.js"></script>
  <script src="scripts/app-history.js"></script>
  <script src="scripts/app-display.js"></script>
  <script src="scripts/app-storage.js"></script>
  <script src="scripts/app.js"></script>

  <link rel="stylesheet" href="css/styles.css">

</head>

<body>

  <div data-role="page" id="main">
    <div data-role="header" class="jqm-header">
      <div class="header-row">
        <h1>PBE Score Keeper</h1>
        <label class="theme-picker" for="theme_preference">
          Theme
          <select id="theme_preference">
            <option value="system">System</option>
            <option value="light">Light</option>
            <option value="dark">Dark</option>
          </select>
        </label>
      </div>
    </div>
    <div id="accordion">
      <h3>Configuration (Session/Round/Game)</h3>
      <div data-role="session_configuration" id="session_configuration">
        <h4>Instructions</h4>
        <p>This is a score keeper for the Pathfinder Bible Experience (aka the Bible Bowl). Please enter your number of teams as well as blocks/groups below so that the scoring grid can be created</p>
        <h5>Data Storage Note</h5>
        <p>Data is stored only on your device, and is not shared in any way with any server. This also means that if you change devices your data will not appear on the new device.</p>
        <h4><span id="session_name" contenteditable="plaintext-only" onblur="local_data_update(this)"></span> (<span id="session_display_count"></span>) <button id="new_session" onclick='local_data_update(this)'>New Session</button></h4>
        <fieldset>
          <legend>Set up your Teams</legend>
          <span id="total_teams"></span> <span id="total_teams_text">teams</span> <button id="total_teams_decrease" onclick='local_data_update(this)'>-</button> <button id="total_teams_increase" onclick='local_data_update(this)'>+</button><br>
          <br>
          <div id="team_names"></div>
        </fieldset>
        <fieldset>
          <legend>Set up your Blocks/Groups</legend>
          <span id="total_blocks"></span> <span id="total_blocks_text">blocks/groups</span> <button id="total_blocks_decrease" onclick='local_data_update(this)'>-</button> <button id="total_blocks_increase" onclick='local_data_update(this)'>+</button><br>
          <br>
          <div id="block_names"></div>
        </fieldset>
        <br>
        <fieldset>
          <legend>Maximum Points per Question</legend>
          <span id="max_points"></span> <span id="max_points_text">points</span> <button id="max_points_decrease" onclick='local_data_update(this)'>-</button> <button id="max_points_increase" onclick='local_data_update(this)'>+</button><br>
        </fieldset>
        <fieldset>
          <legend>Rounding Live Team score to best team's total?</legend>
          <div id="rounding">
            <label><input type="radio" id="rounding_yes" name="rounding" value="true" onchange="local_data_update(this)"><span>Yes</span></label>
            <label><input type="radio" id="rounding_no" name="rounding" value="false" onchange="local_data_update(this)"><span>No</span></label>
          </div>
        </fieldset>
        <br>
        <br>
        <button onclick="local_data_update(this);$( '#accordion' ).accordion({active: 1});">Enter Scores</button>
      </div>
      <h3>Score Entry</h3>
      <div>
        <div data-role="score_entry">
          <div>
            <button id="previous_question" onclick='local_data_update(this)'>Previous Question</button>
            <button id="next_question" onclick='local_data_update(this)'>Next Question</button>
            <span style="margin-left: 20px;">
              <button id="undo_button" onclick='perform_undo()' disabled>â†¶ Undo</button>
              <button id="redo_button" onclick='perform_redo()' disabled>â†· Redo</button>
            </span>
            <br><br>
            <label><span id="ignore_question_warning" style="font-size: xx-large;display:none">ðŸš«</span><input type="checkbox" id="ignore_question" onchange="local_data_update(this)">Ignore this Question in Score Calculations</label></div>
        <div id="ignored_question">
          <label><input type="checkbox" id="extra_credit" onchange="local_data_update(this)">Allow Extra Credit</label>
          <h4><span id="current_question_title" contenteditable="plaintext-only" onblur="local_data_update(this)">Question</span> (<span id="current_question_title_count" ></span>)</h4>
            <fieldset>
              <legend id = "points_legend">Possible Points for Question</legend>
              <div id="question_score">
              </div>
            </fieldset>
            <fieldset>
              <legend>Block/Group</legend>
              <div id="question_block"></div>
            </fieldset>
            <div id = "question_teams"></div>
          </div><br>
          <button id="previous_question_2" onclick='local_data_update(this)'>Previous Question</button>
          <button id="next_question_2" onclick='local_data_update(this)'>Next Question</button>
        </div>
      </div>
      <h3>Score by Team (Exact)</h3>
      <div>
        <div data-role="team_scores" id="team_scores">
          Team Scores Go Here
        </div>
      </div>
      <h3>Score by Team (Rounded)</h3>
      <div>
        <div data-role="rounded_team_scores" id="rounded_team_scores">
          Rounded Team Scores Go Here
        </div>
      </div>
      <h3>Score by Block/Group</h3>
      <div>
        <div data-role="block_scores" id="block_scores">
          Block/Group Scores Go Here
        </div>
      </div>
      <h3>Score by Team & Block/Group</h3>
      <div>
        <div data-role="team_and_block_scores" id="team_and_block_scores">
          Team &amp; Block/Group Scores Go Here
        </div>
      </div>
      <h3>Question Log</h3>
      <div>
        <div data-role="scores" id="scores">
          Question Log Goes Here
        </div>
      </div>
      <h3>History</h3>
      <div>
        <div data-role="history" id="history_viewer">
          <h4>Change Log</h4>
          <table id="history_table">
            <thead>
              <tr>
                <th>Time</th>
                <th>Session</th>
                <th>Action</th>
                <th>Details</th>
              </tr>
            </thead>
            <tbody id="history_list">
              <tr>
                <td colspan="4" style="text-align: center; padding: 20px; color: #666;">
                  No changes recorded yet. Make some changes to see them here!
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <h3>Advanced</h3>
      <div>
        <div data-role="Advanced" id="Advanced">
          <fieldset>
            <legend id = "export_csv_label">Export CSV</legend>
            <button id= "export_team" onclick='local_data_update(this)'>Export Score by Team</button><br>
            <button id= "export_block" onclick='local_data_update(this)'>Export Score by Block/Group</button><br>
            <button id= "export_team_and_block" onclick='local_data_update(this)'>Export Score by Team & Block/Group</button><br>
            <button id= "export_question_log" onclick='local_data_update(this)'>Export Question Log</button><br>
          </fieldset>
          <fieldset>
            <legend id = "export_json_label">Export for Importing (JSON)</legend>
            <button id= "export_session_json" onclick='local_data_update(this)'>Export Session (Round/Game)</button><br>
            <button id= "export_all_json" onclick='local_data_update(this)'>Export All</button>
          </fieldset>
          <fieldset>
            <legend id = "danger_label">Danger Zone</legend>
            <fieldset>
              <legend id = "import_json_label">Import (JSON)</legend>
              <p>Warning: Importing bad files can curropt your data. It is strongly recommended that you run an "Export for Importing (JSON)" before importing.</p>
              <div id = "import_group">
                <div id="import" onchange="$(this).controlgroup('refresh')">
                  <label><input type="radio" id="import_json_append" name="import" value="append" checked="checked" onchange="local_data_update(this)"><span>Add this import as new Session(s) (Round(s)/Game(s))</span></label>
                  <label><input type="radio" id="import_json_replace" name="import" value="replace" onchange="local_data_update(this)"><span>Replace All Data with this Import</span></label>
                </div><br>
                Please Select file to import: 
                <input type="file" id="import_file" />
              </div>
            </fieldset>
            <fieldset>
              <legend id = "delete_label">Delete</legend>
              <button id="session_delete" onclick='local_data_update(this)'>Delete this Session (Round/Game)</button>
            </fieldset>
         </fieldset>
        </div>
      </div>
    </div>
    <footer><p>Have an idea to make this better? <a target="_blank" href="https://github.com/antgiant/PBE_Score_Keeper/issues">Let me know</a>.</p>
    <p><center>v 2.0.0</center></p></footer>
</body>

</html>
