<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PBE Score Keeper</title>
  <link href="jquery-ui.min.css" rel="stylesheet">
  <script src="jquery-3.7.1.min.js"></script>
  <script src="jquery-ui.min.js"></script>
  <script src="jquery.cookie.js"></script>
  <script>
    $(document).ready(initialize);
    //Setup Global Variables
    var blocks = 6;
    var teams = 1;
    var current_question = 1;

    function initialize() {
      //Setup Accordion display
      $("#accordion").accordion({
        heightStyle: "content"
      });

      //Setup score entry buttons
      $( "#question_block" ).controlgroup();
      
      $( "#team1_score" ).controlgroup();

      //Initialize variables
      blocks = ($.cookie("blocks") != undefined ? $.cookie(["blocks"]) : blocks);
      teams = ($.cookie("teams") != undefined ? $.cookie(["teams"]) : teams);
      current_question = ($.cookie("current_question") != undefined ? $.cookie(["current_question"]) : current_question);
      $("#blocks").val(blocks);
      $("#teams").val(teams);

      setup();
    }

    function setup() {
      //Set up Blocks
      blocks = $("#blocks").val();
      current_block_count = $("#block_names").children().length;
      if (current_block_count < blocks)
        for (i=current_block_count + 1;i<=blocks;i++) {
          //Add new
          $("#block_names").append('<label>Block '+i+' Name: <input type = "text" name = "block'+i+'_name" id = "block'+i+'_name" value = "Block '+i+'"><br></label>');
        }
      else if (current_block_count > blocks) {
        //remove extra
        for (i=current_block_count;i>blocks;i--) {
          $("#block_names").children()[i - 1].remove();
        }
      } else {
        //Already have the right number do nothing
      }
      
      //Set up Teams
      teams = $("#teams").val();
      current_teams_count = $("#team_names").children().length;
      if (current_teams_count < teams)
        for (i=current_teams_count + 1;i<=teams;i++) {
          //Add new
          $("#team_names").append('<label>Team '+i+' Name: <input type = "text" name = "team'+i+'_name" id = "team'+i+'_name" value = "Team '+i+'"><br></label>');
        }
      else if (current_teams_count > teams) {
        //remove extra
        for (i=current_teams_count;i>teams;i--) {
          $("#team_names").children()[i - 1].remove();
        }
      } else {
        //Already have the right number do nothing
      }
    }

    function update_score() {
      //Update Question Number
      $("#current_question_title").text("Question " + current_question)
    }
  </script>
</head>

<body>

  <div data-role="page" id="main">
    <div data-role="header" class="jqm-header">
      <h1>PBE Score Keeper</h1>
    </div>
    <div data-role="setup" id="accordion">
      <h3>Setup</h3>
      <div id="setup">
        <h4>Instructions</h4>
        <p>Please enter your number of blocks and teams below so that the scoring grid can be created</p>
        <fieldset>
          <legend>Set up your Blocks</legend>
          <label><input name="blocks" id="blocks" type="number" min="1" max="24" onchange="setup()"> blocks</label><br>
          <div id="block_names">

          </div>
        </fieldset>
        <fieldset>
          <legend>Set up your Teams</legend>

          <label><input name="teams" id="teams" type="number" min="1" max="20" onchange="setup()"> teams</label>
          <div id="team_names">

          </div>
        </fieldset>
        <br>
        <button onclick="setup();$( '#accordion' ).accordion({active: 1});">Submit</button>
      </div>
      <h3>Score Entry</h3>
      <div>
        <div data-role="score_entry">
          <h4 id="current_question_title">Question 1</h4>
          <fieldset>
            <legend>Points</legend>
          <label><input name="question_total" id="question_total" type="number" min=1, max=20 onchange="update_score()"> total points</label><br>
          <label><input type="checkbox" name="question_default_all_points" id="question_default_all_points"> all teams get points by default</label>
        </fieldset>
          <fieldset>
            <legend>Block</legend>
            <div id="question_block">
              <label><input type="radio" id="block1" name="question_block" onchange="update_score()">1</label>
              <label><input type="radio" id="block2" name="question_block" onchange="update_score()">2</label>
              <label><input type="radio" id="block3" name="question_block" onchange="update_score()">3</label>
            </div>
          </fieldset>
          <fieldset>
            <legend>Team Points</legend>
            <div id="team1_score">
              <label><input type="checkbox" id="team1_score_1" name="team1_score" onchange="update_score()">1</label>
              <label><input type="checkbox" id="team1_score_2" name="team1_score" onchange="update_score()">2</label>
              <label><input type="checkbox" id="team1_score_3" name="team1_score" onchange="update_score()">3</label>
            </div>
            Team 1 Score<br>
            <label><input type="number" id="team2_score" min=1, max=20 onchange="update_score()"> Team 2 Score<br></label>
            <label><input type="number" id="team3_score" min=1, max=20 onchange="update_score()"> Team 3 Score<br></label>
          </fieldset>
          <br>
          <button>Previous Question</button>
          <button>Next Question</button>
        </div>
      </div>
      <h3>Score by Team</h3>
      <div>
        <div data-role="team_scores">
          Team Scores Go Here
        </div>
      </div>
      <h3>Score by Block</h3>
      <div>
        <div data-role="block_scores">
          Team Scores Go Here
        </div>
      </div>
      <h3>Question Log</h3>
      <div>
        <div data-role="scores">
          Question Log Goes Here
        </div>
      </div>
    </div>
</body>

</html>