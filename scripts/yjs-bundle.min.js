(()=>{var ul=Object.create;var Ks=Object.defineProperty;var dl=Object.getOwnPropertyDescriptor;var fl=Object.getOwnPropertyNames;var pl=Object.getPrototypeOf,gl=Object.prototype.hasOwnProperty;var Hn=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var ml=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),bo=(e,t)=>{for(var n in t)Ks(e,n,{get:t[n],enumerable:!0})},yl=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of fl(t))!gl.call(e,i)&&i!==n&&Ks(e,i,{get:()=>t[i],enumerable:!(r=dl(t,i))||r.enumerable});return e};var wl=(e,t,n)=>(n=e!=null?ul(pl(e)):{},yl(t||!e||!e.__esModule?Ks(n,"default",{value:e,enumerable:!0}):n,e));var Ya=ml((Wa,io)=>{(function(e){if(typeof Wa=="object"&&typeof io<"u")io.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var t;t=typeof window>"u"?typeof global>"u"?typeof self>"u"?this:self:global:window,t.SimplePeer=e()}})(function(){var e=Math.floor,t=Math.abs,n=Math.pow;return(function(){function r(i,o,a){function h(u,f){if(!o[u]){if(!i[u]){var p=typeof Hn=="function"&&Hn;if(!f&&p)return p(u,!0);if(g)return g(u,!0);var y=new Error("Cannot find module '"+u+"'");throw y.code="MODULE_NOT_FOUND",y}var w=o[u]={exports:{}};i[u][0].call(w.exports,function(v){var R=i[u][1][v];return h(R||v)},w,w.exports,r,i,o,a)}return o[u].exports}for(var g=typeof Hn=="function"&&Hn,l=0;l<a.length;l++)h(a[l]);return h}return r})()({1:[function(r,i,o){"use strict";function a(_){var x=_.length;if(0<x%4)throw new Error("Invalid string. Length must be a multiple of 4");var C=_.indexOf("=");C===-1&&(C=x);var S=C===x?0:4-C%4;return[C,S]}function h(_,x,C){return 3*(x+C)/4-C}function g(_){var x,C,S=a(_),T=S[0],O=S[1],E=new w(h(_,T,O)),k=0,L=0<O?T-4:T;for(C=0;C<L;C+=4)x=y[_.charCodeAt(C)]<<18|y[_.charCodeAt(C+1)]<<12|y[_.charCodeAt(C+2)]<<6|y[_.charCodeAt(C+3)],E[k++]=255&x>>16,E[k++]=255&x>>8,E[k++]=255&x;return O===2&&(x=y[_.charCodeAt(C)]<<2|y[_.charCodeAt(C+1)]>>4,E[k++]=255&x),O===1&&(x=y[_.charCodeAt(C)]<<10|y[_.charCodeAt(C+1)]<<4|y[_.charCodeAt(C+2)]>>2,E[k++]=255&x>>8,E[k++]=255&x),E}function l(_){return p[63&_>>18]+p[63&_>>12]+p[63&_>>6]+p[63&_]}function u(_,x,C){for(var S,T=[],O=x;O<C;O+=3)S=(16711680&_[O]<<16)+(65280&_[O+1]<<8)+(255&_[O+2]),T.push(l(S));return T.join("")}function f(_){for(var x,C=_.length,S=C%3,T=[],O=16383,E=0,k=C-S;E<k;E+=O)T.push(u(_,E,E+O>k?k:E+O));return S===1?(x=_[C-1],T.push(p[x>>2]+p[63&x<<4]+"==")):S===2&&(x=(_[C-2]<<8)+_[C-1],T.push(p[x>>10]+p[63&x>>4]+p[63&x<<2]+"=")),T.join("")}o.byteLength=function(_){var x=a(_),C=x[0],S=x[1];return 3*(C+S)/4-S},o.toByteArray=g,o.fromByteArray=f;for(var p=[],y=[],w=typeof Uint8Array>"u"?Array:Uint8Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=0,m=v.length;R<m;++R)p[R]=v[R],y[v.charCodeAt(R)]=R;y[45]=62,y[95]=63},{}],2:[function(){},{}],3:[function(r,i,o){(function(){(function(){"use strict";var a=String.fromCharCode,h=Math.min;function g(s){if(2147483647<s)throw new RangeError('The value "'+s+'" is invalid for option "size"');var c=new Uint8Array(s);return c.__proto__=l.prototype,c}function l(s,c,d){if(typeof s=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(s)}return u(s,c,d)}function u(s,c,d){if(typeof s=="string")return w(s,c);if(ArrayBuffer.isView(s))return v(s);if(s==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof s);if(A(s,ArrayBuffer)||s&&A(s.buffer,ArrayBuffer))return R(s,c,d);if(typeof s=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var b=s.valueOf&&s.valueOf();if(b!=null&&b!==s)return l.from(b,c,d);var U=m(s);if(U)return U;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof s[Symbol.toPrimitive]=="function")return l.from(s[Symbol.toPrimitive]("string"),c,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof s)}function f(s){if(typeof s!="number")throw new TypeError('"size" argument must be of type number');if(0>s)throw new RangeError('The value "'+s+'" is invalid for option "size"')}function p(s,c,d){return f(s),0>=s||c===void 0?g(s):typeof d=="string"?g(s).fill(c,d):g(s).fill(c)}function y(s){return f(s),g(0>s?0:0|_(s))}function w(s,c){if((typeof c!="string"||c==="")&&(c="utf8"),!l.isEncoding(c))throw new TypeError("Unknown encoding: "+c);var d=0|x(s,c),b=g(d),U=b.write(s,c);return U!==d&&(b=b.slice(0,U)),b}function v(s){for(var c=0>s.length?0:0|_(s.length),d=g(c),b=0;b<c;b+=1)d[b]=255&s[b];return d}function R(s,c,d){if(0>c||s.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(s.byteLength<c+(d||0))throw new RangeError('"length" is outside of buffer bounds');var b;return b=c===void 0&&d===void 0?new Uint8Array(s):d===void 0?new Uint8Array(s,c):new Uint8Array(s,c,d),b.__proto__=l.prototype,b}function m(s){if(l.isBuffer(s)){var c=0|_(s.length),d=g(c);return d.length===0||s.copy(d,0,0,c),d}return s.length===void 0?s.type==="Buffer"&&Array.isArray(s.data)?v(s.data):void 0:typeof s.length!="number"||D(s.length)?g(0):v(s)}function _(s){if(s>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|s}function x(s,c){if(l.isBuffer(s))return s.length;if(ArrayBuffer.isView(s)||A(s,ArrayBuffer))return s.byteLength;if(typeof s!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof s);var d=s.length,b=2<arguments.length&&arguments[2]===!0;if(!b&&d===0)return 0;for(var U=!1;;)switch(c){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return Zt(s).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*d;case"hex":return d>>>1;case"base64":return Rt(s).length;default:if(U)return b?-1:Zt(s).length;c=(""+c).toLowerCase(),U=!0}}function C(s,c,d){var b=!1;if((c===void 0||0>c)&&(c=0),c>this.length||((d===void 0||d>this.length)&&(d=this.length),0>=d)||(d>>>=0,c>>>=0,d<=c))return"";for(s||(s="utf8");;)switch(s){case"hex":return ue(this,c,d);case"utf8":case"utf-8":return ft(this,c,d);case"ascii":return P(this,c,d);case"latin1":case"binary":return Dr(this,c,d);case"base64":return K(this,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Qt(this,c,d);default:if(b)throw new TypeError("Unknown encoding: "+s);s=(s+"").toLowerCase(),b=!0}}function S(s,c,d){var b=s[c];s[c]=s[d],s[d]=b}function T(s,c,d,b,U){if(s.length===0)return-1;if(typeof d=="string"?(b=d,d=0):2147483647<d?d=2147483647:-2147483648>d&&(d=-2147483648),d=+d,D(d)&&(d=U?0:s.length-1),0>d&&(d=s.length+d),d>=s.length){if(U)return-1;d=s.length-1}else if(0>d)if(U)d=0;else return-1;if(typeof c=="string"&&(c=l.from(c,b)),l.isBuffer(c))return c.length===0?-1:O(s,c,d,b,U);if(typeof c=="number")return c&=255,typeof Uint8Array.prototype.indexOf=="function"?U?Uint8Array.prototype.indexOf.call(s,c,d):Uint8Array.prototype.lastIndexOf.call(s,c,d):O(s,[c],d,b,U);throw new TypeError("val must be string, number or Buffer")}function O(s,c,d,b,U){function I(qn,an){return B===1?qn[an]:qn.readUInt16BE(an*B)}var B=1,z=s.length,ct=c.length;if(b!==void 0&&(b=(b+"").toLowerCase(),b==="ucs2"||b==="ucs-2"||b==="utf16le"||b==="utf-16le")){if(2>s.length||2>c.length)return-1;B=2,z/=2,ct/=2,d/=2}var Z;if(U){var J=-1;for(Z=d;Z<z;Z++)if(I(s,Z)!==I(c,J===-1?0:Z-J))J!==-1&&(Z-=Z-J),J=-1;else if(J===-1&&(J=Z),Z-J+1===ct)return J*B}else for(d+ct>z&&(d=z-ct),Z=d;0<=Z;Z--){for(var X=!0,cn=0;cn<ct;cn++)if(I(s,Z+cn)!==I(c,cn)){X=!1;break}if(X)return Z}return-1}function E(s,c,d,b){d=+d||0;var U=s.length-d;b?(b=+b,b>U&&(b=U)):b=U;var I=c.length;b>I/2&&(b=I/2);for(var B,z=0;z<b;++z){if(B=parseInt(c.substr(2*z,2),16),D(B))return z;s[d+z]=B}return z}function k(s,c,d,b){return Pt(Zt(c,s.length-d),s,d,b)}function L(s,c,d,b){return Pt(Pn(c),s,d,b)}function V(s,c,d,b){return L(s,c,d,b)}function q(s,c,d,b){return Pt(Rt(c),s,d,b)}function W(s,c,d,b){return Pt($n(c,s.length-d),s,d,b)}function K(s,c,d){return c===0&&d===s.length?M.fromByteArray(s):M.fromByteArray(s.slice(c,d))}function ft(s,c,d){d=h(s.length,d);for(var b=[],U=c;U<d;){var I=s[U],B=null,z=239<I?4:223<I?3:191<I?2:1;if(U+z<=d){var ct,Z,J,X;z===1?128>I&&(B=I):z===2?(ct=s[U+1],(192&ct)==128&&(X=(31&I)<<6|63&ct,127<X&&(B=X))):z===3?(ct=s[U+1],Z=s[U+2],(192&ct)==128&&(192&Z)==128&&(X=(15&I)<<12|(63&ct)<<6|63&Z,2047<X&&(55296>X||57343<X)&&(B=X))):z===4&&(ct=s[U+1],Z=s[U+2],J=s[U+3],(192&ct)==128&&(192&Z)==128&&(192&J)==128&&(X=(15&I)<<18|(63&ct)<<12|(63&Z)<<6|63&J,65535<X&&1114112>X&&(B=X)))}B===null?(B=65533,z=1):65535<B&&(B-=65536,b.push(55296|1023&B>>>10),B=56320|1023&B),b.push(B),U+=z}return Ut(b)}function Ut(s){var c=s.length;if(c<=4096)return a.apply(String,s);for(var d="",b=0;b<c;)d+=a.apply(String,s.slice(b,b+=4096));return d}function P(s,c,d){var b="";d=h(s.length,d);for(var U=c;U<d;++U)b+=a(127&s[U]);return b}function Dr(s,c,d){var b="";d=h(s.length,d);for(var U=c;U<d;++U)b+=a(s[U]);return b}function ue(s,c,d){var b=s.length;(!c||0>c)&&(c=0),(!d||0>d||d>b)&&(d=b);for(var U="",I=c;I<d;++I)U+=jn(s[I]);return U}function Qt(s,c,d){for(var b=s.slice(c,d),U="",I=0;I<b.length;I+=2)U+=a(b[I]+256*b[I+1]);return U}function rt(s,c,d){if(s%1!=0||0>s)throw new RangeError("offset is not uint");if(s+c>d)throw new RangeError("Trying to access beyond buffer length")}function st(s,c,d,b,U,I){if(!l.isBuffer(s))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>U||c<I)throw new RangeError('"value" argument is out of bounds');if(d+b>s.length)throw new RangeError("Index out of range")}function de(s,c,d,b){if(d+b>s.length)throw new RangeError("Index out of range");if(0>d)throw new RangeError("Index out of range")}function jt(s,c,d,b,U){return c=+c,d>>>=0,U||de(s,c,d,4,34028234663852886e22,-34028234663852886e22),F.write(s,c,d,b,23,4),d+4}function fe(s,c,d,b,U){return c=+c,d>>>=0,U||de(s,c,d,8,17976931348623157e292,-17976931348623157e292),F.write(s,c,d,b,52,8),d+8}function Ue(s){if(s=s.split("=")[0],s=s.trim().replace(Y,""),2>s.length)return"";for(;s.length%4!=0;)s+="=";return s}function jn(s){return 16>s?"0"+s.toString(16):s.toString(16)}function Zt(s,c){c=c||1/0;for(var d,b=s.length,U=null,I=[],B=0;B<b;++B){if(d=s.charCodeAt(B),55295<d&&57344>d){if(!U){if(56319<d){-1<(c-=3)&&I.push(239,191,189);continue}else if(B+1===b){-1<(c-=3)&&I.push(239,191,189);continue}U=d;continue}if(56320>d){-1<(c-=3)&&I.push(239,191,189),U=d;continue}d=(U-55296<<10|d-56320)+65536}else U&&-1<(c-=3)&&I.push(239,191,189);if(U=null,128>d){if(0>(c-=1))break;I.push(d)}else if(2048>d){if(0>(c-=2))break;I.push(192|d>>6,128|63&d)}else if(65536>d){if(0>(c-=3))break;I.push(224|d>>12,128|63&d>>6,128|63&d)}else if(1114112>d){if(0>(c-=4))break;I.push(240|d>>18,128|63&d>>12,128|63&d>>6,128|63&d)}else throw new Error("Invalid code point")}return I}function Pn(s){for(var c=[],d=0;d<s.length;++d)c.push(255&s.charCodeAt(d));return c}function $n(s,c){for(var d,b,U,I=[],B=0;B<s.length&&!(0>(c-=2));++B)d=s.charCodeAt(B),b=d>>8,U=d%256,I.push(U),I.push(b);return I}function Rt(s){return M.toByteArray(Ue(s))}function Pt(s,c,d,b){for(var U=0;U<b&&!(U+d>=c.length||U>=s.length);++U)c[U+d]=s[U];return U}function A(s,c){return s instanceof c||s!=null&&s.constructor!=null&&s.constructor.name!=null&&s.constructor.name===c.name}function D(s){return s!==s}var M=r("base64-js"),F=r("ieee754");o.Buffer=l,o.SlowBuffer=function(s){return+s!=s&&(s=0),l.alloc(+s)},o.INSPECT_MAX_BYTES=50,o.kMaxLength=2147483647,l.TYPED_ARRAY_SUPPORT=(function(){try{var s=new Uint8Array(1);return s.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},s.foo()===42}catch{return!1}})(),l.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){return l.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){return l.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),l.poolSize=8192,l.from=function(s,c,d){return u(s,c,d)},l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,l.alloc=function(s,c,d){return p(s,c,d)},l.allocUnsafe=function(s){return y(s)},l.allocUnsafeSlow=function(s){return y(s)},l.isBuffer=function(s){return s!=null&&s._isBuffer===!0&&s!==l.prototype},l.compare=function(s,c){if(A(s,Uint8Array)&&(s=l.from(s,s.offset,s.byteLength)),A(c,Uint8Array)&&(c=l.from(c,c.offset,c.byteLength)),!l.isBuffer(s)||!l.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===c)return 0;for(var d=s.length,b=c.length,U=0,I=h(d,b);U<I;++U)if(s[U]!==c[U]){d=s[U],b=c[U];break}return d<b?-1:b<d?1:0},l.isEncoding=function(s){switch((s+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(s,c){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(s.length===0)return l.alloc(0);var d;if(c===void 0)for(c=0,d=0;d<s.length;++d)c+=s[d].length;var b=l.allocUnsafe(c),U=0;for(d=0;d<s.length;++d){var I=s[d];if(A(I,Uint8Array)&&(I=l.from(I)),!l.isBuffer(I))throw new TypeError('"list" argument must be an Array of Buffers');I.copy(b,U),U+=I.length}return b},l.byteLength=x,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var s=this.length;if(s%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<s;c+=2)S(this,c,c+1);return this},l.prototype.swap32=function(){var s=this.length;if(s%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<s;c+=4)S(this,c,c+3),S(this,c+1,c+2);return this},l.prototype.swap64=function(){var s=this.length;if(s%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<s;c+=8)S(this,c,c+7),S(this,c+1,c+6),S(this,c+2,c+5),S(this,c+3,c+4);return this},l.prototype.toString=function(){var s=this.length;return s===0?"":arguments.length===0?ft(this,0,s):C.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(s){if(!l.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s||l.compare(this,s)===0},l.prototype.inspect=function(){var s="",c=o.INSPECT_MAX_BYTES;return s=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(s+=" ... "),"<Buffer "+s+">"},l.prototype.compare=function(s,c,d,b,U){if(A(s,Uint8Array)&&(s=l.from(s,s.offset,s.byteLength)),!l.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(c===void 0&&(c=0),d===void 0&&(d=s?s.length:0),b===void 0&&(b=0),U===void 0&&(U=this.length),0>c||d>s.length||0>b||U>this.length)throw new RangeError("out of range index");if(b>=U&&c>=d)return 0;if(b>=U)return-1;if(c>=d)return 1;if(c>>>=0,d>>>=0,b>>>=0,U>>>=0,this===s)return 0;for(var I=U-b,B=d-c,z=h(I,B),ct=this.slice(b,U),Z=s.slice(c,d),J=0;J<z;++J)if(ct[J]!==Z[J]){I=ct[J],B=Z[J];break}return I<B?-1:B<I?1:0},l.prototype.includes=function(s,c,d){return this.indexOf(s,c,d)!==-1},l.prototype.indexOf=function(s,c,d){return T(this,s,c,d,!0)},l.prototype.lastIndexOf=function(s,c,d){return T(this,s,c,d,!1)},l.prototype.write=function(s,c,d,b){if(c===void 0)b="utf8",d=this.length,c=0;else if(d===void 0&&typeof c=="string")b=c,d=this.length,c=0;else if(isFinite(c))c>>>=0,isFinite(d)?(d>>>=0,b===void 0&&(b="utf8")):(b=d,d=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var U=this.length-c;if((d===void 0||d>U)&&(d=U),0<s.length&&(0>d||0>c)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");b||(b="utf8");for(var I=!1;;)switch(b){case"hex":return E(this,s,c,d);case"utf8":case"utf-8":return k(this,s,c,d);case"ascii":return L(this,s,c,d);case"latin1":case"binary":return V(this,s,c,d);case"base64":return q(this,s,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,s,c,d);default:if(I)throw new TypeError("Unknown encoding: "+b);b=(""+b).toLowerCase(),I=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(s,c){var d=this.length;s=~~s,c=c===void 0?d:~~c,0>s?(s+=d,0>s&&(s=0)):s>d&&(s=d),0>c?(c+=d,0>c&&(c=0)):c>d&&(c=d),c<s&&(c=s);var b=this.subarray(s,c);return b.__proto__=l.prototype,b},l.prototype.readUIntLE=function(s,c,d){s>>>=0,c>>>=0,d||rt(s,c,this.length);for(var b=this[s],U=1,I=0;++I<c&&(U*=256);)b+=this[s+I]*U;return b},l.prototype.readUIntBE=function(s,c,d){s>>>=0,c>>>=0,d||rt(s,c,this.length);for(var b=this[s+--c],U=1;0<c&&(U*=256);)b+=this[s+--c]*U;return b},l.prototype.readUInt8=function(s,c){return s>>>=0,c||rt(s,1,this.length),this[s]},l.prototype.readUInt16LE=function(s,c){return s>>>=0,c||rt(s,2,this.length),this[s]|this[s+1]<<8},l.prototype.readUInt16BE=function(s,c){return s>>>=0,c||rt(s,2,this.length),this[s]<<8|this[s+1]},l.prototype.readUInt32LE=function(s,c){return s>>>=0,c||rt(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+16777216*this[s+3]},l.prototype.readUInt32BE=function(s,c){return s>>>=0,c||rt(s,4,this.length),16777216*this[s]+(this[s+1]<<16|this[s+2]<<8|this[s+3])},l.prototype.readIntLE=function(s,c,d){s>>>=0,c>>>=0,d||rt(s,c,this.length);for(var b=this[s],U=1,I=0;++I<c&&(U*=256);)b+=this[s+I]*U;return U*=128,b>=U&&(b-=n(2,8*c)),b},l.prototype.readIntBE=function(s,c,d){s>>>=0,c>>>=0,d||rt(s,c,this.length);for(var b=c,U=1,I=this[s+--b];0<b&&(U*=256);)I+=this[s+--b]*U;return U*=128,I>=U&&(I-=n(2,8*c)),I},l.prototype.readInt8=function(s,c){return s>>>=0,c||rt(s,1,this.length),128&this[s]?-1*(255-this[s]+1):this[s]},l.prototype.readInt16LE=function(s,c){s>>>=0,c||rt(s,2,this.length);var d=this[s]|this[s+1]<<8;return 32768&d?4294901760|d:d},l.prototype.readInt16BE=function(s,c){s>>>=0,c||rt(s,2,this.length);var d=this[s+1]|this[s]<<8;return 32768&d?4294901760|d:d},l.prototype.readInt32LE=function(s,c){return s>>>=0,c||rt(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},l.prototype.readInt32BE=function(s,c){return s>>>=0,c||rt(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},l.prototype.readFloatLE=function(s,c){return s>>>=0,c||rt(s,4,this.length),F.read(this,s,!0,23,4)},l.prototype.readFloatBE=function(s,c){return s>>>=0,c||rt(s,4,this.length),F.read(this,s,!1,23,4)},l.prototype.readDoubleLE=function(s,c){return s>>>=0,c||rt(s,8,this.length),F.read(this,s,!0,52,8)},l.prototype.readDoubleBE=function(s,c){return s>>>=0,c||rt(s,8,this.length),F.read(this,s,!1,52,8)},l.prototype.writeUIntLE=function(s,c,d,b){if(s=+s,c>>>=0,d>>>=0,!b){var U=n(2,8*d)-1;st(this,s,c,d,U,0)}var I=1,B=0;for(this[c]=255&s;++B<d&&(I*=256);)this[c+B]=255&s/I;return c+d},l.prototype.writeUIntBE=function(s,c,d,b){if(s=+s,c>>>=0,d>>>=0,!b){var U=n(2,8*d)-1;st(this,s,c,d,U,0)}var I=d-1,B=1;for(this[c+I]=255&s;0<=--I&&(B*=256);)this[c+I]=255&s/B;return c+d},l.prototype.writeUInt8=function(s,c,d){return s=+s,c>>>=0,d||st(this,s,c,1,255,0),this[c]=255&s,c+1},l.prototype.writeUInt16LE=function(s,c,d){return s=+s,c>>>=0,d||st(this,s,c,2,65535,0),this[c]=255&s,this[c+1]=s>>>8,c+2},l.prototype.writeUInt16BE=function(s,c,d){return s=+s,c>>>=0,d||st(this,s,c,2,65535,0),this[c]=s>>>8,this[c+1]=255&s,c+2},l.prototype.writeUInt32LE=function(s,c,d){return s=+s,c>>>=0,d||st(this,s,c,4,4294967295,0),this[c+3]=s>>>24,this[c+2]=s>>>16,this[c+1]=s>>>8,this[c]=255&s,c+4},l.prototype.writeUInt32BE=function(s,c,d){return s=+s,c>>>=0,d||st(this,s,c,4,4294967295,0),this[c]=s>>>24,this[c+1]=s>>>16,this[c+2]=s>>>8,this[c+3]=255&s,c+4},l.prototype.writeIntLE=function(s,c,d,b){if(s=+s,c>>>=0,!b){var U=n(2,8*d-1);st(this,s,c,d,U-1,-U)}var I=0,B=1,z=0;for(this[c]=255&s;++I<d&&(B*=256);)0>s&&z===0&&this[c+I-1]!==0&&(z=1),this[c+I]=255&(s/B>>0)-z;return c+d},l.prototype.writeIntBE=function(s,c,d,b){if(s=+s,c>>>=0,!b){var U=n(2,8*d-1);st(this,s,c,d,U-1,-U)}var I=d-1,B=1,z=0;for(this[c+I]=255&s;0<=--I&&(B*=256);)0>s&&z===0&&this[c+I+1]!==0&&(z=1),this[c+I]=255&(s/B>>0)-z;return c+d},l.prototype.writeInt8=function(s,c,d){return s=+s,c>>>=0,d||st(this,s,c,1,127,-128),0>s&&(s=255+s+1),this[c]=255&s,c+1},l.prototype.writeInt16LE=function(s,c,d){return s=+s,c>>>=0,d||st(this,s,c,2,32767,-32768),this[c]=255&s,this[c+1]=s>>>8,c+2},l.prototype.writeInt16BE=function(s,c,d){return s=+s,c>>>=0,d||st(this,s,c,2,32767,-32768),this[c]=s>>>8,this[c+1]=255&s,c+2},l.prototype.writeInt32LE=function(s,c,d){return s=+s,c>>>=0,d||st(this,s,c,4,2147483647,-2147483648),this[c]=255&s,this[c+1]=s>>>8,this[c+2]=s>>>16,this[c+3]=s>>>24,c+4},l.prototype.writeInt32BE=function(s,c,d){return s=+s,c>>>=0,d||st(this,s,c,4,2147483647,-2147483648),0>s&&(s=4294967295+s+1),this[c]=s>>>24,this[c+1]=s>>>16,this[c+2]=s>>>8,this[c+3]=255&s,c+4},l.prototype.writeFloatLE=function(s,c,d){return jt(this,s,c,!0,d)},l.prototype.writeFloatBE=function(s,c,d){return jt(this,s,c,!1,d)},l.prototype.writeDoubleLE=function(s,c,d){return fe(this,s,c,!0,d)},l.prototype.writeDoubleBE=function(s,c,d){return fe(this,s,c,!1,d)},l.prototype.copy=function(s,c,d,b){if(!l.isBuffer(s))throw new TypeError("argument should be a Buffer");if(d||(d=0),b||b===0||(b=this.length),c>=s.length&&(c=s.length),c||(c=0),0<b&&b<d&&(b=d),b===d||s.length===0||this.length===0)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>d||d>=this.length)throw new RangeError("Index out of range");if(0>b)throw new RangeError("sourceEnd out of bounds");b>this.length&&(b=this.length),s.length-c<b-d&&(b=s.length-c+d);var U=b-d;if(this===s&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(c,d,b);else if(this===s&&d<c&&c<b)for(var I=U-1;0<=I;--I)s[I+c]=this[I+d];else Uint8Array.prototype.set.call(s,this.subarray(d,b),c);return U},l.prototype.fill=function(s,c,d,b){if(typeof s=="string"){if(typeof c=="string"?(b=c,c=0,d=this.length):typeof d=="string"&&(b=d,d=this.length),b!==void 0&&typeof b!="string")throw new TypeError("encoding must be a string");if(typeof b=="string"&&!l.isEncoding(b))throw new TypeError("Unknown encoding: "+b);if(s.length===1){var U=s.charCodeAt(0);(b==="utf8"&&128>U||b==="latin1")&&(s=U)}}else typeof s=="number"&&(s&=255);if(0>c||this.length<c||this.length<d)throw new RangeError("Out of range index");if(d<=c)return this;c>>>=0,d=d===void 0?this.length:d>>>0,s||(s=0);var I;if(typeof s=="number")for(I=c;I<d;++I)this[I]=s;else{var B=l.isBuffer(s)?s:l.from(s,b),z=B.length;if(z===0)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(I=0;I<d-c;++I)this[I+c]=B[I%z]}return this};var Y=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,r("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(r,i,o){(function(a){(function(){function h(){let l;try{l=o.storage.getItem("debug")}catch{}return!l&&typeof a<"u"&&"env"in a&&(l=a.env.DEBUG),l}o.formatArgs=function(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;let u="color: "+this.color;l.splice(1,0,u,"color: inherit");let f=0,p=0;l[0].replace(/%[a-zA-Z%]/g,y=>{y==="%%"||(f++,y==="%c"&&(p=f))}),l.splice(p,0,u)},o.save=function(l){try{l?o.storage.setItem("debug",l):o.storage.removeItem("debug")}catch{}},o.load=h,o.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},o.storage=(function(){try{return localStorage}catch{}})(),o.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),o.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],o.log=console.debug||console.log||(()=>{}),i.exports=r("./common")(o);let{formatters:g}=i.exports;g.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}).call(this)}).call(this,r("_process"))},{"./common":5,_process:12}],5:[function(r,i){i.exports=function(o){function a(l){function u(...y){if(!u.enabled)return;let w=u,v=+new Date,R=v-(f||v);w.diff=R,w.prev=f,w.curr=v,f=v,y[0]=a.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let m=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(x,C)=>{if(x==="%%")return"%";m++;let S=a.formatters[C];if(typeof S=="function"){let T=y[m];x=S.call(w,T),y.splice(m,1),m--}return x}),a.formatArgs.call(w,y),(w.log||a.log).apply(w,y)}let f,p=null;return u.namespace=l,u.useColors=a.useColors(),u.color=a.selectColor(l),u.extend=h,u.destroy=a.destroy,Object.defineProperty(u,"enabled",{enumerable:!0,configurable:!1,get:()=>p===null?a.enabled(l):p,set:y=>{p=y}}),typeof a.init=="function"&&a.init(u),u}function h(l,u){let f=a(this.namespace+(typeof u>"u"?":":u)+l);return f.log=this.log,f}function g(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}return a.debug=a,a.default=a,a.coerce=function(l){return l instanceof Error?l.stack||l.message:l},a.disable=function(){let l=[...a.names.map(g),...a.skips.map(g).map(u=>"-"+u)].join(",");return a.enable(""),l},a.enable=function(l){a.save(l),a.names=[],a.skips=[];let u,f=(typeof l=="string"?l:"").split(/[\s,]+/),p=f.length;for(u=0;u<p;u++)f[u]&&(l=f[u].replace(/\*/g,".*?"),l[0]==="-"?a.skips.push(new RegExp("^"+l.substr(1)+"$")):a.names.push(new RegExp("^"+l+"$")))},a.enabled=function(l){if(l[l.length-1]==="*")return!0;let u,f;for(u=0,f=a.skips.length;u<f;u++)if(a.skips[u].test(l))return!1;for(u=0,f=a.names.length;u<f;u++)if(a.names[u].test(l))return!0;return!1},a.humanize=r("ms"),a.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(o).forEach(l=>{a[l]=o[l]}),a.names=[],a.skips=[],a.formatters={},a.selectColor=function(l){let u=0;for(let f=0;f<l.length;f++)u=(u<<5)-u+l.charCodeAt(f),u|=0;return a.colors[t(u)%a.colors.length]},a.enable(a.load()),a}},{ms:11}],6:[function(r,i){"use strict";function o(a,h){for(let g in h)Object.defineProperty(a,g,{value:h[g],enumerable:!0,configurable:!0});return a}i.exports=function(a,h,g){if(!a||typeof a=="string")throw new TypeError("Please pass an Error to err-code");g||(g={}),typeof h=="object"&&(g=h,h=""),h&&(g.code=h);try{return o(a,g)}catch{g.message=a.message,g.stack=a.stack;let u=function(){};return u.prototype=Object.create(Object.getPrototypeOf(a)),o(new u,g)}}},{}],7:[function(r,i){"use strict";function o(E){console&&console.warn&&console.warn(E)}function a(){a.init.call(this)}function h(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}function g(E){return E._maxListeners===void 0?a.defaultMaxListeners:E._maxListeners}function l(E,k,L,V){var q,W,K;if(h(L),W=E._events,W===void 0?(W=E._events=Object.create(null),E._eventsCount=0):(W.newListener!==void 0&&(E.emit("newListener",k,L.listener?L.listener:L),W=E._events),K=W[k]),K===void 0)K=W[k]=L,++E._eventsCount;else if(typeof K=="function"?K=W[k]=V?[L,K]:[K,L]:V?K.unshift(L):K.push(L),q=g(E),0<q&&K.length>q&&!K.warned){K.warned=!0;var ft=new Error("Possible EventEmitter memory leak detected. "+K.length+" "+(k+" listeners added. Use emitter.setMaxListeners() to increase limit"));ft.name="MaxListenersExceededWarning",ft.emitter=E,ft.type=k,ft.count=K.length,o(ft)}return E}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(E,k,L){var V={fired:!1,wrapFn:void 0,target:E,type:k,listener:L},q=u.bind(V);return q.listener=L,V.wrapFn=q,q}function p(E,k,L){var V=E._events;if(V===void 0)return[];var q=V[k];return q===void 0?[]:typeof q=="function"?L?[q.listener||q]:[q]:L?R(q):w(q,q.length)}function y(E){var k=this._events;if(k!==void 0){var L=k[E];if(typeof L=="function")return 1;if(L!==void 0)return L.length}return 0}function w(E,k){for(var L=Array(k),V=0;V<k;++V)L[V]=E[V];return L}function v(E,k){for(;k+1<E.length;k++)E[k]=E[k+1];E.pop()}function R(E){for(var k=Array(E.length),L=0;L<k.length;++L)k[L]=E[L].listener||E[L];return k}function m(E,k,L){typeof E.on=="function"&&_(E,"error",k,L)}function _(E,k,L,V){if(typeof E.on=="function")V.once?E.once(k,L):E.on(k,L);else if(typeof E.addEventListener=="function")E.addEventListener(k,function q(W){V.once&&E.removeEventListener(k,q),L(W)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}var x,C=typeof Reflect=="object"?Reflect:null,S=C&&typeof C.apply=="function"?C.apply:function(E,k,L){return Function.prototype.apply.call(E,k,L)};x=C&&typeof C.ownKeys=="function"?C.ownKeys:Object.getOwnPropertySymbols?function(E){return Object.getOwnPropertyNames(E).concat(Object.getOwnPropertySymbols(E))}:function(E){return Object.getOwnPropertyNames(E)};var T=Number.isNaN||function(E){return E!==E};i.exports=a,i.exports.once=function(E,k){return new Promise(function(L,V){function q(K){E.removeListener(k,W),V(K)}function W(){typeof E.removeListener=="function"&&E.removeListener("error",q),L([].slice.call(arguments))}_(E,k,W,{once:!0}),k!=="error"&&m(E,q,{once:!0})})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var O=10;Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return O},set:function(E){if(typeof E!="number"||0>E||T(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");O=E}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(E){if(typeof E!="number"||0>E||T(E))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+E+".");return this._maxListeners=E,this},a.prototype.getMaxListeners=function(){return g(this)},a.prototype.emit=function(E){for(var k=[],L=1;L<arguments.length;L++)k.push(arguments[L]);var V=E==="error",q=this._events;if(q!==void 0)V=V&&q.error===void 0;else if(!V)return!1;if(V){var W;if(0<k.length&&(W=k[0]),W instanceof Error)throw W;var K=new Error("Unhandled error."+(W?" ("+W.message+")":""));throw K.context=W,K}var ft=q[E];if(ft===void 0)return!1;if(typeof ft=="function")S(ft,this,k);else for(var Ut=ft.length,P=w(ft,Ut),L=0;L<Ut;++L)S(P[L],this,k);return!0},a.prototype.addListener=function(E,k){return l(this,E,k,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(E,k){return l(this,E,k,!0)},a.prototype.once=function(E,k){return h(k),this.on(E,f(this,E,k)),this},a.prototype.prependOnceListener=function(E,k){return h(k),this.prependListener(E,f(this,E,k)),this},a.prototype.removeListener=function(E,k){var L,V,q,W,K;if(h(k),V=this._events,V===void 0)return this;if(L=V[E],L===void 0)return this;if(L===k||L.listener===k)--this._eventsCount==0?this._events=Object.create(null):(delete V[E],V.removeListener&&this.emit("removeListener",E,L.listener||k));else if(typeof L!="function"){for(q=-1,W=L.length-1;0<=W;W--)if(L[W]===k||L[W].listener===k){K=L[W].listener,q=W;break}if(0>q)return this;q===0?L.shift():v(L,q),L.length===1&&(V[E]=L[0]),V.removeListener!==void 0&&this.emit("removeListener",E,K||k)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(E){var k,L,V;if(L=this._events,L===void 0)return this;if(L.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):L[E]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete L[E]),this;if(arguments.length===0){var q,W=Object.keys(L);for(V=0;V<W.length;++V)q=W[V],q!=="removeListener"&&this.removeAllListeners(q);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(k=L[E],typeof k=="function")this.removeListener(E,k);else if(k!==void 0)for(V=k.length-1;0<=V;V--)this.removeListener(E,k[V]);return this},a.prototype.listeners=function(E){return p(this,E,!0)},a.prototype.rawListeners=function(E){return p(this,E,!1)},a.listenerCount=function(E,k){return typeof E.listenerCount=="function"?E.listenerCount(k):y.call(E,k)},a.prototype.listenerCount=y,a.prototype.eventNames=function(){return 0<this._eventsCount?x(this._events):[]}},{}],8:[function(r,i){i.exports=function(){if(typeof globalThis>"u")return null;var o={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return o.RTCPeerConnection?o:null}},{}],9:[function(r,i,o){o.read=function(a,h,g,l,u){var f,p,y=8*u-l-1,w=(1<<y)-1,v=w>>1,R=-7,m=g?u-1:0,_=g?-1:1,x=a[h+m];for(m+=_,f=x&(1<<-R)-1,x>>=-R,R+=y;0<R;f=256*f+a[h+m],m+=_,R-=8);for(p=f&(1<<-R)-1,f>>=-R,R+=l;0<R;p=256*p+a[h+m],m+=_,R-=8);if(f===0)f=1-v;else{if(f===w)return p?NaN:(x?-1:1)*(1/0);p+=n(2,l),f-=v}return(x?-1:1)*p*n(2,f-l)},o.write=function(a,h,g,l,u,f){var p,y,w,v=Math.LN2,R=Math.log,m=8*f-u-1,_=(1<<m)-1,x=_>>1,C=u===23?n(2,-24)-n(2,-77):0,S=l?0:f-1,T=l?1:-1,O=0>h||h===0&&0>1/h?1:0;for(h=t(h),isNaN(h)||h===1/0?(y=isNaN(h)?1:0,p=_):(p=e(R(h)/v),1>h*(w=n(2,-p))&&(p--,w*=2),h+=1<=p+x?C/w:C*n(2,1-x),2<=h*w&&(p++,w/=2),p+x>=_?(y=0,p=_):1<=p+x?(y=(h*w-1)*n(2,u),p+=x):(y=h*n(2,x-1)*n(2,u),p=0));8<=u;a[g+S]=255&y,S+=T,y/=256,u-=8);for(p=p<<u|y,m+=u;0<m;a[g+S]=255&p,S+=T,p/=256,m-=8);a[g+S-T]|=128*O}},{}],10:[function(r,i){i.exports=typeof Object.create=="function"?function(o,a){a&&(o.super_=a,o.prototype=Object.create(a.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:function(o,a){if(a){o.super_=a;var h=function(){};h.prototype=a.prototype,o.prototype=new h,o.prototype.constructor=o}}},{}],11:[function(r,i){var o=Math.round;function a(f){if(f+="",!(100<f.length)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(f);if(p){var y=parseFloat(p[1]),w=(p[2]||"ms").toLowerCase();return w==="years"||w==="year"||w==="yrs"||w==="yr"||w==="y"?315576e5*y:w==="weeks"||w==="week"||w==="w"?6048e5*y:w==="days"||w==="day"||w==="d"?864e5*y:w==="hours"||w==="hour"||w==="hrs"||w==="hr"||w==="h"?36e5*y:w==="minutes"||w==="minute"||w==="mins"||w==="min"||w==="m"?6e4*y:w==="seconds"||w==="second"||w==="secs"||w==="sec"||w==="s"?1e3*y:w==="milliseconds"||w==="millisecond"||w==="msecs"||w==="msec"||w==="ms"?y:void 0}}}function h(f){var p=t(f);return 864e5<=p?o(f/864e5)+"d":36e5<=p?o(f/36e5)+"h":6e4<=p?o(f/6e4)+"m":1e3<=p?o(f/1e3)+"s":f+"ms"}function g(f){var p=t(f);return 864e5<=p?l(f,p,864e5,"day"):36e5<=p?l(f,p,36e5,"hour"):6e4<=p?l(f,p,6e4,"minute"):1e3<=p?l(f,p,1e3,"second"):f+" ms"}function l(f,p,y,w){return o(f/y)+" "+w+(p>=1.5*y?"s":"")}var u=24*(60*6e4);i.exports=function(f,p){p=p||{};var y=typeof f;if(y=="string"&&0<f.length)return a(f);if(y==="number"&&isFinite(f))return p.long?g(f):h(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))}},{}],12:[function(r,i){function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function h(C){if(y===setTimeout)return setTimeout(C,0);if((y===o||!y)&&setTimeout)return y=setTimeout,setTimeout(C,0);try{return y(C,0)}catch{try{return y.call(null,C,0)}catch{return y.call(this,C,0)}}}function g(C){if(w===clearTimeout)return clearTimeout(C);if((w===a||!w)&&clearTimeout)return w=clearTimeout,clearTimeout(C);try{return w(C)}catch{try{return w.call(null,C)}catch{return w.call(this,C)}}}function l(){_&&R&&(_=!1,R.length?m=R.concat(m):x=-1,m.length&&u())}function u(){if(!_){var C=h(l);_=!0;for(var S=m.length;S;){for(R=m,m=[];++x<S;)R&&R[x].run();x=-1,S=m.length}R=null,_=!1,g(C)}}function f(C,S){this.fun=C,this.array=S}function p(){}var y,w,v=i.exports={};(function(){try{y=typeof setTimeout=="function"?setTimeout:o}catch{y=o}try{w=typeof clearTimeout=="function"?clearTimeout:a}catch{w=a}})();var R,m=[],_=!1,x=-1;v.nextTick=function(C){var S=Array(arguments.length-1);if(1<arguments.length)for(var T=1;T<arguments.length;T++)S[T-1]=arguments[T];m.push(new f(C,S)),m.length!==1||_||h(u)},f.prototype.run=function(){this.fun.apply(null,this.array)},v.title="browser",v.browser=!0,v.env={},v.argv=[],v.version="",v.versions={},v.on=p,v.addListener=p,v.once=p,v.off=p,v.removeListener=p,v.removeAllListeners=p,v.emit=p,v.prependListener=p,v.prependOnceListener=p,v.listeners=function(){return[]},v.binding=function(){throw new Error("process.binding is not supported")},v.cwd=function(){return"/"},v.chdir=function(){throw new Error("process.chdir is not supported")},v.umask=function(){return 0}},{}],13:[function(r,i){(function(o){(function(){let a;i.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?o:window):h=>(a||(a=Promise.resolve())).then(h).catch(g=>setTimeout(()=>{throw g},0))}).call(this)}).call(this,typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{}],14:[function(r,i){(function(o,a){(function(){"use strict";var h=r("safe-buffer").Buffer,g=a.crypto||a.msCrypto;i.exports=g&&g.getRandomValues?function(l,u){if(l>4294967295)throw new RangeError("requested too many random bytes");var f=h.allocUnsafe(l);if(0<l)if(65536<l)for(var p=0;p<l;p+=65536)g.getRandomValues(f.slice(p,p+65536));else g.getRandomValues(f);return typeof u=="function"?o.nextTick(function(){u(null,f)}):f}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,r("_process"),typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{_process:12,"safe-buffer":30}],15:[function(r,i){"use strict";function o(p,y){p.prototype=Object.create(y.prototype),p.prototype.constructor=p,p.__proto__=y}function a(p,y,w){function v(m,_,x){return typeof y=="string"?y:y(m,_,x)}w||(w=Error);var R=(function(m){function _(x,C,S){return m.call(this,v(x,C,S))||this}return o(_,m),_})(w);R.prototype.name=w.name,R.prototype.code=p,f[p]=R}function h(p,y){if(Array.isArray(p)){var w=p.length;return p=p.map(function(v){return v+""}),2<w?"one of ".concat(y," ").concat(p.slice(0,w-1).join(", "),", or ")+p[w-1]:w===2?"one of ".concat(y," ").concat(p[0]," or ").concat(p[1]):"of ".concat(y," ").concat(p[0])}return"of ".concat(y," ").concat(p+"")}function g(p,y,w){return p.substr(!w||0>w?0:+w,y.length)===y}function l(p,y,w){return(w===void 0||w>p.length)&&(w=p.length),p.substring(w-y.length,w)===y}function u(p,y,w){return typeof w!="number"&&(w=0),!(w+y.length>p.length)&&p.indexOf(y,w)!==-1}var f={};a("ERR_INVALID_OPT_VALUE",function(p,y){return'The value "'+y+'" is invalid for option "'+p+'"'},TypeError),a("ERR_INVALID_ARG_TYPE",function(p,y,w){var v;typeof y=="string"&&g(y,"not ")?(v="must not be",y=y.replace(/^not /,"")):v="must be";var R;if(l(p," argument"))R="The ".concat(p," ").concat(v," ").concat(h(y,"type"));else{var m=u(p,".")?"property":"argument";R='The "'.concat(p,'" ').concat(m," ").concat(v," ").concat(h(y,"type"))}return R+=". Received type ".concat(typeof w),R},TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",function(p){return"The "+p+" method is not implemented"}),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",function(p){return"Cannot call "+p+" after a stream was destroyed"}),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",function(p){return"Unknown encoding: "+p},TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),i.exports.codes=f},{}],16:[function(r,i){(function(o){(function(){"use strict";function a(v){return this instanceof a?(u.call(this,v),f.call(this,v),this.allowHalfOpen=!0,void(v&&(v.readable===!1&&(this.readable=!1),v.writable===!1&&(this.writable=!1),v.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h))))):new a(v)}function h(){this._writableState.ended||o.nextTick(g,this)}function g(v){v.end()}var l=Object.keys||function(v){var R=[];for(var m in v)R.push(m);return R};i.exports=a;var u=r("./_stream_readable"),f=r("./_stream_writable");r("inherits")(a,u);for(var p,y=l(f.prototype),w=0;w<y.length;w++)p=y[w],a.prototype[p]||(a.prototype[p]=f.prototype[p]);Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(v){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=v,this._writableState.destroyed=v)}})}).call(this)}).call(this,r("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(r,i){"use strict";function o(h){return this instanceof o?void a.call(this,h):new o(h)}i.exports=o;var a=r("./_stream_transform");r("inherits")(o,a),o.prototype._transform=function(h,g,l){l(null,h)}},{"./_stream_transform":19,inherits:10}],18:[function(r,i){(function(o,a){(function(){"use strict";function h(s){return rt.from(s)}function g(s){return rt.isBuffer(s)||s instanceof st}function l(s,c,d){return typeof s.prependListener=="function"?s.prependListener(c,d):void(s._events&&s._events[c]?Array.isArray(s._events[c])?s._events[c].unshift(d):s._events[c]=[d,s._events[c]]:s.on(c,d))}function u(s,c,d){Ut=Ut||r("./_stream_duplex"),s=s||{},typeof d!="boolean"&&(d=c instanceof Ut),this.objectMode=!!s.objectMode,d&&(this.objectMode=this.objectMode||!!s.readableObjectMode),this.highWaterMark=$n(this,s,"readableHighWaterMark",d),this.buffer=new jn,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=s.emitClose!==!1,this.autoDestroy=!!s.autoDestroy,this.destroyed=!1,this.defaultEncoding=s.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,s.encoding&&(!jt&&(jt=r("string_decoder/").StringDecoder),this.decoder=new jt(s.encoding),this.encoding=s.encoding)}function f(s){if(Ut=Ut||r("./_stream_duplex"),!(this instanceof f))return new f(s);var c=this instanceof Ut;this._readableState=new u(s,this,c),this.readable=!0,s&&(typeof s.read=="function"&&(this._read=s.read),typeof s.destroy=="function"&&(this._destroy=s.destroy)),Qt.call(this)}function p(s,c,d,b,U){P("readableAddChunk",c);var I=s._readableState;if(c===null)I.reading=!1,m(s,I);else{var B;if(U||(B=w(I,c)),B)F(s,B);else if(!(I.objectMode||c&&0<c.length))b||(I.reading=!1,C(s,I));else if(typeof c=="string"||I.objectMode||Object.getPrototypeOf(c)===rt.prototype||(c=h(c)),b)I.endEmitted?F(s,new M):y(s,I,c,!0);else if(I.ended)F(s,new A);else{if(I.destroyed)return!1;I.reading=!1,I.decoder&&!d?(c=I.decoder.write(c),I.objectMode||c.length!==0?y(s,I,c,!1):C(s,I)):y(s,I,c,!1)}}return!I.ended&&(I.length<I.highWaterMark||I.length===0)}function y(s,c,d,b){c.flowing&&c.length===0&&!c.sync?(c.awaitDrain=0,s.emit("data",d)):(c.length+=c.objectMode?1:d.length,b?c.buffer.unshift(d):c.buffer.push(d),c.needReadable&&_(s)),C(s,c)}function w(s,c){var d;return g(c)||typeof c=="string"||c===void 0||s.objectMode||(d=new Pt("chunk",["string","Buffer","Uint8Array"],c)),d}function v(s){return 1073741824<=s?s=1073741824:(s--,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s++),s}function R(s,c){return 0>=s||c.length===0&&c.ended?0:c.objectMode?1:s===s?(s>c.highWaterMark&&(c.highWaterMark=v(s)),s<=c.length?s:c.ended?c.length:(c.needReadable=!0,0)):c.flowing&&c.length?c.buffer.head.data.length:c.length}function m(s,c){if(P("onEofChunk"),!c.ended){if(c.decoder){var d=c.decoder.end();d&&d.length&&(c.buffer.push(d),c.length+=c.objectMode?1:d.length)}c.ended=!0,c.sync?_(s):(c.needReadable=!1,!c.emittedReadable&&(c.emittedReadable=!0,x(s)))}}function _(s){var c=s._readableState;P("emitReadable",c.needReadable,c.emittedReadable),c.needReadable=!1,c.emittedReadable||(P("emitReadable",c.flowing),c.emittedReadable=!0,o.nextTick(x,s))}function x(s){var c=s._readableState;P("emitReadable_",c.destroyed,c.length,c.ended),!c.destroyed&&(c.length||c.ended)&&(s.emit("readable"),c.emittedReadable=!1),c.needReadable=!c.flowing&&!c.ended&&c.length<=c.highWaterMark,V(s)}function C(s,c){c.readingMore||(c.readingMore=!0,o.nextTick(S,s,c))}function S(s,c){for(;!c.reading&&!c.ended&&(c.length<c.highWaterMark||c.flowing&&c.length===0);){var d=c.length;if(P("maybeReadMore read 0"),s.read(0),d===c.length)break}c.readingMore=!1}function T(s){return function(){var c=s._readableState;P("pipeOnDrain",c.awaitDrain),c.awaitDrain&&c.awaitDrain--,c.awaitDrain===0&&ue(s,"data")&&(c.flowing=!0,V(s))}}function O(s){var c=s._readableState;c.readableListening=0<s.listenerCount("readable"),c.resumeScheduled&&!c.paused?c.flowing=!0:0<s.listenerCount("data")&&s.resume()}function E(s){P("readable nexttick read 0"),s.read(0)}function k(s,c){c.resumeScheduled||(c.resumeScheduled=!0,o.nextTick(L,s,c))}function L(s,c){P("resume",c.reading),c.reading||s.read(0),c.resumeScheduled=!1,s.emit("resume"),V(s),c.flowing&&!c.reading&&s.read(0)}function V(s){var c=s._readableState;for(P("flow",c.flowing);c.flowing&&s.read()!==null;);}function q(s,c){if(c.length===0)return null;var d;return c.objectMode?d=c.buffer.shift():!s||s>=c.length?(d=c.decoder?c.buffer.join(""):c.buffer.length===1?c.buffer.first():c.buffer.concat(c.length),c.buffer.clear()):d=c.buffer.consume(s,c.decoder),d}function W(s){var c=s._readableState;P("endReadable",c.endEmitted),c.endEmitted||(c.ended=!0,o.nextTick(K,c,s))}function K(s,c){if(P("endReadableNT",s.endEmitted,s.length),!s.endEmitted&&s.length===0&&(s.endEmitted=!0,c.readable=!1,c.emit("end"),s.autoDestroy)){var d=c._writableState;(!d||d.autoDestroy&&d.finished)&&c.destroy()}}function ft(s,c){for(var d=0,b=s.length;d<b;d++)if(s[d]===c)return d;return-1}i.exports=f;var Ut;f.ReadableState=u;var P,Dr=r("events").EventEmitter,ue=function(s,c){return s.listeners(c).length},Qt=r("./internal/streams/stream"),rt=r("buffer").Buffer,st=a.Uint8Array||function(){},de=r("util");P=de&&de.debuglog?de.debuglog("stream"):function(){};var jt,fe,Ue,jn=r("./internal/streams/buffer_list"),Zt=r("./internal/streams/destroy"),Pn=r("./internal/streams/state"),$n=Pn.getHighWaterMark,Rt=r("../errors").codes,Pt=Rt.ERR_INVALID_ARG_TYPE,A=Rt.ERR_STREAM_PUSH_AFTER_EOF,D=Rt.ERR_METHOD_NOT_IMPLEMENTED,M=Rt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r("inherits")(f,Qt);var F=Zt.errorOrDestroy,Y=["error","close","destroy","pause","resume"];Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(s){this._readableState&&(this._readableState.destroyed=s)}}),f.prototype.destroy=Zt.destroy,f.prototype._undestroy=Zt.undestroy,f.prototype._destroy=function(s,c){c(s)},f.prototype.push=function(s,c){var d,b=this._readableState;return b.objectMode?d=!0:typeof s=="string"&&(c=c||b.defaultEncoding,c!==b.encoding&&(s=rt.from(s,c),c=""),d=!0),p(this,s,c,!1,d)},f.prototype.unshift=function(s){return p(this,s,null,!0,!1)},f.prototype.isPaused=function(){return this._readableState.flowing===!1},f.prototype.setEncoding=function(s){jt||(jt=r("string_decoder/").StringDecoder);var c=new jt(s);this._readableState.decoder=c,this._readableState.encoding=this._readableState.decoder.encoding;for(var d=this._readableState.buffer.head,b="";d!==null;)b+=c.write(d.data),d=d.next;return this._readableState.buffer.clear(),b!==""&&this._readableState.buffer.push(b),this._readableState.length=b.length,this},f.prototype.read=function(s){P("read",s),s=parseInt(s,10);var c=this._readableState,d=s;if(s!==0&&(c.emittedReadable=!1),s===0&&c.needReadable&&((c.highWaterMark===0?0<c.length:c.length>=c.highWaterMark)||c.ended))return P("read: emitReadable",c.length,c.ended),c.length===0&&c.ended?W(this):_(this),null;if(s=R(s,c),s===0&&c.ended)return c.length===0&&W(this),null;var b=c.needReadable;P("need readable",b),(c.length===0||c.length-s<c.highWaterMark)&&(b=!0,P("length less than watermark",b)),c.ended||c.reading?(b=!1,P("reading or ended",b)):b&&(P("do read"),c.reading=!0,c.sync=!0,c.length===0&&(c.needReadable=!0),this._read(c.highWaterMark),c.sync=!1,!c.reading&&(s=R(d,c)));var U;return U=0<s?q(s,c):null,U===null?(c.needReadable=c.length<=c.highWaterMark,s=0):(c.length-=s,c.awaitDrain=0),c.length===0&&(!c.ended&&(c.needReadable=!0),d!==s&&c.ended&&W(this)),U!==null&&this.emit("data",U),U},f.prototype._read=function(){F(this,new D("_read()"))},f.prototype.pipe=function(s,c){function d(ln,hn){P("onunpipe"),ln===J&&hn&&hn.hasUnpiped===!1&&(hn.hasUnpiped=!0,U())}function b(){P("onend"),s.end()}function U(){P("cleanup"),s.removeListener("close",z),s.removeListener("finish",ct),s.removeListener("drain",an),s.removeListener("error",B),s.removeListener("unpipe",d),J.removeListener("end",b),J.removeListener("end",Z),J.removeListener("data",I),wo=!0,X.awaitDrain&&(!s._writableState||s._writableState.needDrain)&&an()}function I(ln){P("ondata");var hn=s.write(ln);P("dest.write",hn),hn===!1&&((X.pipesCount===1&&X.pipes===s||1<X.pipesCount&&ft(X.pipes,s)!==-1)&&!wo&&(P("false write response, pause",X.awaitDrain),X.awaitDrain++),J.pause())}function B(ln){P("onerror",ln),Z(),s.removeListener("error",B),ue(s,"error")===0&&F(s,ln)}function z(){s.removeListener("finish",ct),Z()}function ct(){P("onfinish"),s.removeListener("close",z),Z()}function Z(){P("unpipe"),J.unpipe(s)}var J=this,X=this._readableState;switch(X.pipesCount){case 0:X.pipes=s;break;case 1:X.pipes=[X.pipes,s];break;default:X.pipes.push(s)}X.pipesCount+=1,P("pipe count=%d opts=%j",X.pipesCount,c);var cn=(!c||c.end!==!1)&&s!==o.stdout&&s!==o.stderr,qn=cn?b:Z;X.endEmitted?o.nextTick(qn):J.once("end",qn),s.on("unpipe",d);var an=T(J);s.on("drain",an);var wo=!1;return J.on("data",I),l(s,"error",B),s.once("close",z),s.once("finish",ct),s.emit("pipe",J),X.flowing||(P("pipe resume"),J.resume()),s},f.prototype.unpipe=function(s){var c=this._readableState,d={hasUnpiped:!1};if(c.pipesCount===0)return this;if(c.pipesCount===1)return s&&s!==c.pipes?this:(s||(s=c.pipes),c.pipes=null,c.pipesCount=0,c.flowing=!1,s&&s.emit("unpipe",this,d),this);if(!s){var b=c.pipes,U=c.pipesCount;c.pipes=null,c.pipesCount=0,c.flowing=!1;for(var I=0;I<U;I++)b[I].emit("unpipe",this,{hasUnpiped:!1});return this}var B=ft(c.pipes,s);return B===-1?this:(c.pipes.splice(B,1),c.pipesCount-=1,c.pipesCount===1&&(c.pipes=c.pipes[0]),s.emit("unpipe",this,d),this)},f.prototype.on=function(s,c){var d=Qt.prototype.on.call(this,s,c),b=this._readableState;return s==="data"?(b.readableListening=0<this.listenerCount("readable"),b.flowing!==!1&&this.resume()):s=="readable"&&!b.endEmitted&&!b.readableListening&&(b.readableListening=b.needReadable=!0,b.flowing=!1,b.emittedReadable=!1,P("on readable",b.length,b.reading),b.length?_(this):!b.reading&&o.nextTick(E,this)),d},f.prototype.addListener=f.prototype.on,f.prototype.removeListener=function(s,c){var d=Qt.prototype.removeListener.call(this,s,c);return s==="readable"&&o.nextTick(O,this),d},f.prototype.removeAllListeners=function(s){var c=Qt.prototype.removeAllListeners.apply(this,arguments);return(s==="readable"||s===void 0)&&o.nextTick(O,this),c},f.prototype.resume=function(){var s=this._readableState;return s.flowing||(P("resume"),s.flowing=!s.readableListening,k(this,s)),s.paused=!1,this},f.prototype.pause=function(){return P("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(P("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},f.prototype.wrap=function(s){var c=this,d=this._readableState,b=!1;for(var U in s.on("end",function(){if(P("wrapped end"),d.decoder&&!d.ended){var B=d.decoder.end();B&&B.length&&c.push(B)}c.push(null)}),s.on("data",function(B){if(P("wrapped data"),d.decoder&&(B=d.decoder.write(B)),!(d.objectMode&&B==null)&&(d.objectMode||B&&B.length)){var z=c.push(B);z||(b=!0,s.pause())}}),s)this[U]===void 0&&typeof s[U]=="function"&&(this[U]=(function(B){return function(){return s[B].apply(s,arguments)}})(U));for(var I=0;I<Y.length;I++)s.on(Y[I],this.emit.bind(this,Y[I]));return this._read=function(B){P("wrapped _read",B),b&&(b=!1,s.resume())},this},typeof Symbol=="function"&&(f.prototype[Symbol.asyncIterator]=function(){return fe===void 0&&(fe=r("./internal/streams/async_iterator")),fe(this)}),Object.defineProperty(f.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(f.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(f.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(s){this._readableState&&(this._readableState.flowing=s)}}),f._fromList=q,Object.defineProperty(f.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(f.from=function(s,c){return Ue===void 0&&(Ue=r("./internal/streams/from")),Ue(f,s,c)})}).call(this)}).call(this,r("_process"),typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(r,i){"use strict";function o(v,R){var m=this._transformState;m.transforming=!1;var _=m.writecb;if(_===null)return this.emit("error",new f);m.writechunk=null,m.writecb=null,R!=null&&this.push(R),_(v);var x=this._readableState;x.reading=!1,(x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}function a(v){return this instanceof a?(w.call(this,v),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,v&&(typeof v.transform=="function"&&(this._transform=v.transform),typeof v.flush=="function"&&(this._flush=v.flush)),void this.on("prefinish",h)):new a(v)}function h(){var v=this;typeof this._flush!="function"||this._readableState.destroyed?g(this,null,null):this._flush(function(R,m){g(v,R,m)})}function g(v,R,m){if(R)return v.emit("error",R);if(m!=null&&v.push(m),v._writableState.length)throw new y;if(v._transformState.transforming)throw new p;return v.push(null)}i.exports=a;var l=r("../errors").codes,u=l.ERR_METHOD_NOT_IMPLEMENTED,f=l.ERR_MULTIPLE_CALLBACK,p=l.ERR_TRANSFORM_ALREADY_TRANSFORMING,y=l.ERR_TRANSFORM_WITH_LENGTH_0,w=r("./_stream_duplex");r("inherits")(a,w),a.prototype.push=function(v,R){return this._transformState.needTransform=!1,w.prototype.push.call(this,v,R)},a.prototype._transform=function(v,R,m){m(new u("_transform()"))},a.prototype._write=function(v,R,m){var _=this._transformState;if(_.writecb=m,_.writechunk=v,_.writeencoding=R,!_.transforming){var x=this._readableState;(_.needTransform||x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}},a.prototype._read=function(){var v=this._transformState;v.writechunk===null||v.transforming?v.needTransform=!0:(v.transforming=!0,this._transform(v.writechunk,v.writeencoding,v.afterTransform))},a.prototype._destroy=function(v,R){w.prototype._destroy.call(this,v,function(m){R(m)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(r,i){(function(o,a){(function(){"use strict";function h(A){var D=this;this.next=null,this.entry=null,this.finish=function(){W(D,A)}}function g(A){return P.from(A)}function l(A){return P.isBuffer(A)||A instanceof Dr}function u(){}function f(A,D,M){K=K||r("./_stream_duplex"),A=A||{},typeof M!="boolean"&&(M=D instanceof K),this.objectMode=!!A.objectMode,M&&(this.objectMode=this.objectMode||!!A.writableObjectMode),this.highWaterMark=rt(this,A,"writableHighWaterMark",M),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var F=A.decodeStrings===!1;this.decodeStrings=!F,this.defaultEncoding=A.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Y){C(D,Y)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=A.emitClose!==!1,this.autoDestroy=!!A.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new h(this)}function p(A){K=K||r("./_stream_duplex");var D=this instanceof K;return D||Pt.call(p,this)?(this._writableState=new f(A,this,D),this.writable=!0,A&&(typeof A.write=="function"&&(this._write=A.write),typeof A.writev=="function"&&(this._writev=A.writev),typeof A.destroy=="function"&&(this._destroy=A.destroy),typeof A.final=="function"&&(this._final=A.final)),void Ut.call(this)):new p(A)}function y(A,D){var M=new Pn;Rt(A,M),o.nextTick(D,M)}function w(A,D,M,F){var Y;return M===null?Y=new Zt:typeof M!="string"&&!D.objectMode&&(Y=new de("chunk",["string","Buffer"],M)),!Y||(Rt(A,Y),o.nextTick(F,Y),!1)}function v(A,D,M){return A.objectMode||A.decodeStrings===!1||typeof D!="string"||(D=P.from(D,M)),D}function R(A,D,M,F,Y,s){if(!M){var c=v(D,F,Y);F!==c&&(M=!0,Y="buffer",F=c)}var d=D.objectMode?1:F.length;D.length+=d;var b=D.length<D.highWaterMark;if(b||(D.needDrain=!0),D.writing||D.corked){var U=D.lastBufferedRequest;D.lastBufferedRequest={chunk:F,encoding:Y,isBuf:M,callback:s,next:null},U?U.next=D.lastBufferedRequest:D.bufferedRequest=D.lastBufferedRequest,D.bufferedRequestCount+=1}else m(A,D,!1,d,F,Y,s);return b}function m(A,D,M,F,Y,s,c){D.writelen=F,D.writecb=c,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new jn("write")):M?A._writev(Y,D.onwrite):A._write(Y,s,D.onwrite),D.sync=!1}function _(A,D,M,F,Y){--D.pendingcb,M?(o.nextTick(Y,F),o.nextTick(V,A,D),A._writableState.errorEmitted=!0,Rt(A,F)):(Y(F),A._writableState.errorEmitted=!0,Rt(A,F),V(A,D))}function x(A){A.writing=!1,A.writecb=null,A.length-=A.writelen,A.writelen=0}function C(A,D){var M=A._writableState,F=M.sync,Y=M.writecb;if(typeof Y!="function")throw new fe;if(x(M),D)_(A,M,F,D,Y);else{var s=E(M)||A.destroyed;s||M.corked||M.bufferProcessing||!M.bufferedRequest||O(A,M),F?o.nextTick(S,A,M,s,Y):S(A,M,s,Y)}}function S(A,D,M,F){M||T(A,D),D.pendingcb--,F(),V(A,D)}function T(A,D){D.length===0&&D.needDrain&&(D.needDrain=!1,A.emit("drain"))}function O(A,D){D.bufferProcessing=!0;var M=D.bufferedRequest;if(A._writev&&M&&M.next){var F=D.bufferedRequestCount,Y=Array(F),s=D.corkedRequestsFree;s.entry=M;for(var c=0,d=!0;M;)Y[c]=M,M.isBuf||(d=!1),M=M.next,c+=1;Y.allBuffers=d,m(A,D,!0,D.length,Y,"",s.finish),D.pendingcb++,D.lastBufferedRequest=null,s.next?(D.corkedRequestsFree=s.next,s.next=null):D.corkedRequestsFree=new h(D),D.bufferedRequestCount=0}else{for(;M;){var b=M.chunk,U=M.encoding,I=M.callback,B=D.objectMode?1:b.length;if(m(A,D,!1,B,b,U,I),M=M.next,D.bufferedRequestCount--,D.writing)break}M===null&&(D.lastBufferedRequest=null)}D.bufferedRequest=M,D.bufferProcessing=!1}function E(A){return A.ending&&A.length===0&&A.bufferedRequest===null&&!A.finished&&!A.writing}function k(A,D){A._final(function(M){D.pendingcb--,M&&Rt(A,M),D.prefinished=!0,A.emit("prefinish"),V(A,D)})}function L(A,D){D.prefinished||D.finalCalled||(typeof A._final!="function"||D.destroyed?(D.prefinished=!0,A.emit("prefinish")):(D.pendingcb++,D.finalCalled=!0,o.nextTick(k,A,D)))}function V(A,D){var M=E(D);if(M&&(L(A,D),D.pendingcb===0&&(D.finished=!0,A.emit("finish"),D.autoDestroy))){var F=A._readableState;(!F||F.autoDestroy&&F.endEmitted)&&A.destroy()}return M}function q(A,D,M){D.ending=!0,V(A,D),M&&(D.finished?o.nextTick(M):A.once("finish",M)),D.ended=!0,A.writable=!1}function W(A,D,M){var F=A.entry;for(A.entry=null;F;){var Y=F.callback;D.pendingcb--,Y(M),F=F.next}D.corkedRequestsFree.next=A}i.exports=p;var K;p.WritableState=f;var ft={deprecate:r("util-deprecate")},Ut=r("./internal/streams/stream"),P=r("buffer").Buffer,Dr=a.Uint8Array||function(){},ue=r("./internal/streams/destroy"),Qt=r("./internal/streams/state"),rt=Qt.getHighWaterMark,st=r("../errors").codes,de=st.ERR_INVALID_ARG_TYPE,jt=st.ERR_METHOD_NOT_IMPLEMENTED,fe=st.ERR_MULTIPLE_CALLBACK,Ue=st.ERR_STREAM_CANNOT_PIPE,jn=st.ERR_STREAM_DESTROYED,Zt=st.ERR_STREAM_NULL_VALUES,Pn=st.ERR_STREAM_WRITE_AFTER_END,$n=st.ERR_UNKNOWN_ENCODING,Rt=ue.errorOrDestroy;r("inherits")(p,Ut),f.prototype.getBuffer=function(){for(var A=this.bufferedRequest,D=[];A;)D.push(A),A=A.next;return D},(function(){try{Object.defineProperty(f.prototype,"buffer",{get:ft.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var Pt;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Pt=Function.prototype[Symbol.hasInstance],Object.defineProperty(p,Symbol.hasInstance,{value:function(A){return!!Pt.call(this,A)||this===p&&A&&A._writableState instanceof f}})):Pt=function(A){return A instanceof this},p.prototype.pipe=function(){Rt(this,new Ue)},p.prototype.write=function(A,D,M){var F=this._writableState,Y=!1,s=!F.objectMode&&l(A);return s&&!P.isBuffer(A)&&(A=g(A)),typeof D=="function"&&(M=D,D=null),s?D="buffer":!D&&(D=F.defaultEncoding),typeof M!="function"&&(M=u),F.ending?y(this,M):(s||w(this,F,A,M))&&(F.pendingcb++,Y=R(this,F,s,A,D,M)),Y},p.prototype.cork=function(){this._writableState.corked++},p.prototype.uncork=function(){var A=this._writableState;A.corked&&(A.corked--,!A.writing&&!A.corked&&!A.bufferProcessing&&A.bufferedRequest&&O(this,A))},p.prototype.setDefaultEncoding=function(A){if(typeof A=="string"&&(A=A.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((A+"").toLowerCase())))throw new $n(A);return this._writableState.defaultEncoding=A,this},Object.defineProperty(p.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),p.prototype._write=function(A,D,M){M(new jt("_write()"))},p.prototype._writev=null,p.prototype.end=function(A,D,M){var F=this._writableState;return typeof A=="function"?(M=A,A=null,D=null):typeof D=="function"&&(M=D,D=null),A!=null&&this.write(A,D),F.corked&&(F.corked=1,this.uncork()),F.ending||q(this,F,M),this},Object.defineProperty(p.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(A){this._writableState&&(this._writableState.destroyed=A)}}),p.prototype.destroy=ue.destroy,p.prototype._undestroy=ue.undestroy,p.prototype._destroy=function(A,D){D(A)}}).call(this)}).call(this,r("_process"),typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(r,i){(function(o){(function(){"use strict";function a(T,O,E){return O in T?Object.defineProperty(T,O,{value:E,enumerable:!0,configurable:!0,writable:!0}):T[O]=E,T}function h(T,O){return{value:T,done:O}}function g(T){var O=T[y];if(O!==null){var E=T[x].read();E!==null&&(T[m]=null,T[y]=null,T[w]=null,O(h(E,!1)))}}function l(T){o.nextTick(g,T)}function u(T,O){return function(E,k){T.then(function(){return O[R]?void E(h(void 0,!0)):void O[_](E,k)},k)}}var f,p=r("./end-of-stream"),y=Symbol("lastResolve"),w=Symbol("lastReject"),v=Symbol("error"),R=Symbol("ended"),m=Symbol("lastPromise"),_=Symbol("handlePromise"),x=Symbol("stream"),C=Object.getPrototypeOf(function(){}),S=Object.setPrototypeOf((f={get stream(){return this[x]},next:function(){var T=this,O=this[v];if(O!==null)return Promise.reject(O);if(this[R])return Promise.resolve(h(void 0,!0));if(this[x].destroyed)return new Promise(function(V,q){o.nextTick(function(){T[v]?q(T[v]):V(h(void 0,!0))})});var E,k=this[m];if(k)E=new Promise(u(k,this));else{var L=this[x].read();if(L!==null)return Promise.resolve(h(L,!1));E=new Promise(this[_])}return this[m]=E,E}},a(f,Symbol.asyncIterator,function(){return this}),a(f,"return",function(){var T=this;return new Promise(function(O,E){T[x].destroy(null,function(k){return k?void E(k):void O(h(void 0,!0))})})}),f),C);i.exports=function(T){var O,E=Object.create(S,(O={},a(O,x,{value:T,writable:!0}),a(O,y,{value:null,writable:!0}),a(O,w,{value:null,writable:!0}),a(O,v,{value:null,writable:!0}),a(O,R,{value:T._readableState.endEmitted,writable:!0}),a(O,_,{value:function(k,L){var V=E[x].read();V?(E[m]=null,E[y]=null,E[w]=null,k(h(V,!1))):(E[y]=k,E[w]=L)},writable:!0}),O));return E[m]=null,p(T,function(k){if(k&&k.code!=="ERR_STREAM_PREMATURE_CLOSE"){var L=E[w];return L!==null&&(E[m]=null,E[y]=null,E[w]=null,L(k)),void(E[v]=k)}var V=E[y];V!==null&&(E[m]=null,E[y]=null,E[w]=null,V(h(void 0,!0))),E[R]=!0}),T.on("readable",l.bind(null,E)),E}}).call(this)}).call(this,r("_process"))},{"./end-of-stream":24,_process:12}],22:[function(r,i){"use strict";function o(m,_){var x=Object.keys(m);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(m);_&&(C=C.filter(function(S){return Object.getOwnPropertyDescriptor(m,S).enumerable})),x.push.apply(x,C)}return x}function a(m){for(var _,x=1;x<arguments.length;x++)_=arguments[x]==null?{}:arguments[x],x%2?o(Object(_),!0).forEach(function(C){h(m,C,_[C])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(_)):o(Object(_)).forEach(function(C){Object.defineProperty(m,C,Object.getOwnPropertyDescriptor(_,C))});return m}function h(m,_,x){return _ in m?Object.defineProperty(m,_,{value:x,enumerable:!0,configurable:!0,writable:!0}):m[_]=x,m}function g(m,_){if(!(m instanceof _))throw new TypeError("Cannot call a class as a function")}function l(m,_){for(var x,C=0;C<_.length;C++)x=_[C],x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(m,x.key,x)}function u(m,_,x){return _&&l(m.prototype,_),x&&l(m,x),m}function f(m,_,x){y.prototype.copy.call(m,_,x)}var p=r("buffer"),y=p.Buffer,w=r("util"),v=w.inspect,R=v&&v.custom||"inspect";i.exports=(function(){function m(){g(this,m),this.head=null,this.tail=null,this.length=0}return u(m,[{key:"push",value:function(_){var x={data:_,next:null};0<this.length?this.tail.next=x:this.head=x,this.tail=x,++this.length}},{key:"unshift",value:function(_){var x={data:_,next:this.head};this.length===0&&(this.tail=x),this.head=x,++this.length}},{key:"shift",value:function(){if(this.length!==0){var _=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,_}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(_){if(this.length===0)return"";for(var x=this.head,C=""+x.data;x=x.next;)C+=_+x.data;return C}},{key:"concat",value:function(_){if(this.length===0)return y.alloc(0);for(var x=y.allocUnsafe(_>>>0),C=this.head,S=0;C;)f(C.data,x,S),S+=C.data.length,C=C.next;return x}},{key:"consume",value:function(_,x){var C;return _<this.head.data.length?(C=this.head.data.slice(0,_),this.head.data=this.head.data.slice(_)):_===this.head.data.length?C=this.shift():C=x?this._getString(_):this._getBuffer(_),C}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(_){var x=this.head,C=1,S=x.data;for(_-=S.length;x=x.next;){var T=x.data,O=_>T.length?T.length:_;if(S+=O===T.length?T:T.slice(0,_),_-=O,_===0){O===T.length?(++C,this.head=x.next?x.next:this.tail=null):(this.head=x,x.data=T.slice(O));break}++C}return this.length-=C,S}},{key:"_getBuffer",value:function(_){var x=y.allocUnsafe(_),C=this.head,S=1;for(C.data.copy(x),_-=C.data.length;C=C.next;){var T=C.data,O=_>T.length?T.length:_;if(T.copy(x,x.length-_,0,O),_-=O,_===0){O===T.length?(++S,this.head=C.next?C.next:this.tail=null):(this.head=C,C.data=T.slice(O));break}++S}return this.length-=S,x}},{key:R,value:function(_,x){return v(this,a({},x,{depth:0,customInspect:!1}))}}]),m})()},{buffer:3,util:2}],23:[function(r,i){(function(o){(function(){"use strict";function a(l,u){g(l,u),h(l)}function h(l){l._writableState&&!l._writableState.emitClose||l._readableState&&!l._readableState.emitClose||l.emit("close")}function g(l,u){l.emit("error",u)}i.exports={destroy:function(l,u){var f=this,p=this._readableState&&this._readableState.destroyed,y=this._writableState&&this._writableState.destroyed;return p||y?(u?u(l):l&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,o.nextTick(g,this,l)):o.nextTick(g,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(w){!u&&w?f._writableState?f._writableState.errorEmitted?o.nextTick(h,f):(f._writableState.errorEmitted=!0,o.nextTick(a,f,w)):o.nextTick(a,f,w):u?(o.nextTick(h,f),u(w)):o.nextTick(h,f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(l,u){var f=l._readableState,p=l._writableState;f&&f.autoDestroy||p&&p.autoDestroy?l.destroy(u):l.emit("error",u)}}}).call(this)}).call(this,r("_process"))},{_process:12}],24:[function(r,i){"use strict";function o(u){var f=!1;return function(){if(!f){f=!0;for(var p=arguments.length,y=Array(p),w=0;w<p;w++)y[w]=arguments[w];u.apply(this,y)}}}function a(){}function h(u){return u.setHeader&&typeof u.abort=="function"}function g(u,f,p){if(typeof f=="function")return g(u,null,f);f||(f={}),p=o(p||a);var y=f.readable||f.readable!==!1&&u.readable,w=f.writable||f.writable!==!1&&u.writable,v=function(){u.writable||m()},R=u._writableState&&u._writableState.finished,m=function(){w=!1,R=!0,y||p.call(u)},_=u._readableState&&u._readableState.endEmitted,x=function(){y=!1,_=!0,w||p.call(u)},C=function(O){p.call(u,O)},S=function(){var O;return y&&!_?(u._readableState&&u._readableState.ended||(O=new l),p.call(u,O)):w&&!R?(u._writableState&&u._writableState.ended||(O=new l),p.call(u,O)):void 0},T=function(){u.req.on("finish",m)};return h(u)?(u.on("complete",m),u.on("abort",S),u.req?T():u.on("request",T)):w&&!u._writableState&&(u.on("end",v),u.on("close",v)),u.on("end",x),u.on("finish",m),f.error!==!1&&u.on("error",C),u.on("close",S),function(){u.removeListener("complete",m),u.removeListener("abort",S),u.removeListener("request",T),u.req&&u.req.removeListener("finish",m),u.removeListener("end",v),u.removeListener("close",v),u.removeListener("finish",m),u.removeListener("end",x),u.removeListener("error",C),u.removeListener("close",S)}}var l=r("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;i.exports=g},{"../../../errors":15}],25:[function(r,i){i.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(r,i){"use strict";function o(R){var m=!1;return function(){m||(m=!0,R.apply(void 0,arguments))}}function a(R){if(R)throw R}function h(R){return R.setHeader&&typeof R.abort=="function"}function g(R,m,_,x){x=o(x);var C=!1;R.on("close",function(){C=!0}),p===void 0&&(p=r("./end-of-stream")),p(R,{readable:m,writable:_},function(T){return T?x(T):(C=!0,void x())});var S=!1;return function(T){if(!C)return S?void 0:(S=!0,h(R)?R.abort():typeof R.destroy=="function"?R.destroy():void x(T||new v("pipe")))}}function l(R){R()}function u(R,m){return R.pipe(m)}function f(R){return R.length&&typeof R[R.length-1]=="function"?R.pop():a}var p,y=r("../../../errors").codes,w=y.ERR_MISSING_ARGS,v=y.ERR_STREAM_DESTROYED;i.exports=function(){for(var R=arguments.length,m=Array(R),_=0;_<R;_++)m[_]=arguments[_];var x=f(m);if(Array.isArray(m[0])&&(m=m[0]),2>m.length)throw new w("streams");var C,S=m.map(function(T,O){var E=O<m.length-1;return g(T,E,0<O,function(k){C||(C=k),k&&S.forEach(l),E||(S.forEach(l),x(C))})});return m.reduce(u)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(r,i){"use strict";function o(h,g,l){return h.highWaterMark==null?g?h[l]:null:h.highWaterMark}var a=r("../../../errors").codes.ERR_INVALID_OPT_VALUE;i.exports={getHighWaterMark:function(h,g,l,u){var f=o(g,u,l);if(f!=null){if(!(isFinite(f)&&e(f)===f)||0>f){var p=u?l:"highWaterMark";throw new a(p,f)}return e(f)}return h.objectMode?16:16384}}},{"../../../errors":15}],28:[function(r,i){i.exports=r("events").EventEmitter},{events:7}],29:[function(r,i,o){o=i.exports=r("./lib/_stream_readable.js"),o.Stream=o,o.Readable=o,o.Writable=r("./lib/_stream_writable.js"),o.Duplex=r("./lib/_stream_duplex.js"),o.Transform=r("./lib/_stream_transform.js"),o.PassThrough=r("./lib/_stream_passthrough.js"),o.finished=r("./lib/internal/streams/end-of-stream.js"),o.pipeline=r("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(r,i,o){function a(u,f){for(var p in u)f[p]=u[p]}function h(u,f,p){return l(u,f,p)}var g=r("buffer"),l=g.Buffer;l.from&&l.alloc&&l.allocUnsafe&&l.allocUnsafeSlow?i.exports=g:(a(g,o),o.Buffer=h),h.prototype=Object.create(l.prototype),a(l,h),h.from=function(u,f,p){if(typeof u=="number")throw new TypeError("Argument must not be a number");return l(u,f,p)},h.alloc=function(u,f,p){if(typeof u!="number")throw new TypeError("Argument must be a number");var y=l(u);return f===void 0?y.fill(0):typeof p=="string"?y.fill(f,p):y.fill(f),y},h.allocUnsafe=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return l(u)},h.allocUnsafeSlow=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return g.SlowBuffer(u)}},{buffer:3}],31:[function(r,i,o){"use strict";function a(S){if(!S)return"utf8";for(var T;;)switch(S){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return S;default:if(T)return;S=(""+S).toLowerCase(),T=!0}}function h(S){var T=a(S);if(typeof T!="string"&&(x.isEncoding===C||!C(S)))throw new Error("Unknown encoding: "+S);return T||S}function g(S){this.encoding=h(S);var T;switch(this.encoding){case"utf16le":this.text=y,this.end=w,T=4;break;case"utf8":this.fillLast=p,T=4;break;case"base64":this.text=v,this.end=R,T=3;break;default:return this.write=m,void(this.end=_)}this.lastNeed=0,this.lastTotal=0,this.lastChar=x.allocUnsafe(T)}function l(S){return 127>=S?0:S>>5==6?2:S>>4==14?3:S>>3==30?4:S>>6==2?-1:-2}function u(S,T,O){var E=T.length-1;if(E<O)return 0;var k=l(T[E]);return 0<=k?(0<k&&(S.lastNeed=k-1),k):--E<O||k===-2?0:(k=l(T[E]),0<=k?(0<k&&(S.lastNeed=k-2),k):--E<O||k===-2?0:(k=l(T[E]),0<=k?(0<k&&(k===2?k=0:S.lastNeed=k-3),k):0))}function f(S,T){if((192&T[0])!=128)return S.lastNeed=0,"\uFFFD";if(1<S.lastNeed&&1<T.length){if((192&T[1])!=128)return S.lastNeed=1,"\uFFFD";if(2<S.lastNeed&&2<T.length&&(192&T[2])!=128)return S.lastNeed=2,"\uFFFD"}}function p(S){var T=this.lastTotal-this.lastNeed,O=f(this,S,T);return O===void 0?this.lastNeed<=S.length?(S.copy(this.lastChar,T,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(S.copy(this.lastChar,T,0,S.length),void(this.lastNeed-=S.length)):O}function y(S,T){if((S.length-T)%2==0){var O=S.toString("utf16le",T);if(O){var E=O.charCodeAt(O.length-1);if(55296<=E&&56319>=E)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1],O.slice(0,-1)}return O}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=S[S.length-1],S.toString("utf16le",T,S.length-1)}function w(S){var T=S&&S.length?this.write(S):"";if(this.lastNeed){var O=this.lastTotal-this.lastNeed;return T+this.lastChar.toString("utf16le",0,O)}return T}function v(S,T){var O=(S.length-T)%3;return O==0?S.toString("base64",T):(this.lastNeed=3-O,this.lastTotal=3,O==1?this.lastChar[0]=S[S.length-1]:(this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1]),S.toString("base64",T,S.length-O))}function R(S){var T=S&&S.length?this.write(S):"";return this.lastNeed?T+this.lastChar.toString("base64",0,3-this.lastNeed):T}function m(S){return S.toString(this.encoding)}function _(S){return S&&S.length?this.write(S):""}var x=r("safe-buffer").Buffer,C=x.isEncoding||function(S){switch(S=""+S,S&&S.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};o.StringDecoder=g,g.prototype.write=function(S){if(S.length===0)return"";var T,O;if(this.lastNeed){if(T=this.fillLast(S),T===void 0)return"";O=this.lastNeed,this.lastNeed=0}else O=0;return O<S.length?T?T+this.text(S,O):this.text(S,O):T||""},g.prototype.end=function(S){var T=S&&S.length?this.write(S):"";return this.lastNeed?T+"\uFFFD":T},g.prototype.text=function(S,T){var O=u(this,S,T);if(!this.lastNeed)return S.toString("utf8",T);this.lastTotal=O;var E=S.length-(O-this.lastNeed);return S.copy(this.lastChar,0,E),S.toString("utf8",T,E)},g.prototype.fillLast=function(S){return this.lastNeed<=S.length?(S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,S.length),void(this.lastNeed-=S.length))}},{"safe-buffer":30}],32:[function(r,i){(function(o){(function(){function a(h){try{if(!o.localStorage)return!1}catch{return!1}var g=o.localStorage[h];return g!=null&&(g+"").toLowerCase()==="true"}i.exports=function(h,g){function l(){if(!u){if(a("throwDeprecation"))throw new Error(g);a("traceDeprecation")?console.trace(g):console.warn(g),u=!0}return h.apply(this,arguments)}if(a("noDeprecation"))return h;var u=!1;return l}}).call(this)}).call(this,typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{}],"/":[function(r,i){function o(R){return R.replace(/a=ice-options:trickle\s\n/g,"")}function a(R){console.warn(R)}let h=r("debug")("simple-peer"),g=r("get-browser-rtc"),l=r("randombytes"),u=r("readable-stream"),f=r("queue-microtask"),p=r("err-code"),{Buffer:y}=r("buffer"),w=65536;class v extends u.Duplex{constructor(m){if(m=Object.assign({allowHalfOpen:!1},m),super(m),this._id=l(4).toString("hex").slice(0,7),this._debug("new peer %o",m),this.channelName=m.initiator?m.channelName||l(20).toString("hex"):null,this.initiator=m.initiator||!1,this.channelConfig=m.channelConfig||v.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},v.config,m.config),this.offerOptions=m.offerOptions||{},this.answerOptions=m.answerOptions||{},this.sdpTransform=m.sdpTransform||(_=>_),this.streams=m.streams||(m.stream?[m.stream]:[]),this.trickle=m.trickle===void 0||m.trickle,this.allowHalfTrickle=m.allowHalfTrickle!==void 0&&m.allowHalfTrickle,this.iceCompleteTimeout=m.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=m.wrtc&&typeof m.wrtc=="object"?m.wrtc:g(),!this._wrtc)throw p(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(_){return void this.destroy(p(_,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=_=>{this._onIceCandidate(_)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(_=>{this.destroy(p(_,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=_=>{this._setupData(_)},this.streams&&this.streams.forEach(_=>{this.addStream(_)}),this._pc.ontrack=_=>{this._onTrack(_)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(m){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof m=="string")try{m=JSON.parse(m)}catch{m={}}this._debug("signal()"),m.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),m.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(m.transceiverRequest.kind,m.transceiverRequest.init)),m.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(m.candidate):this._pendingCandidates.push(m.candidate)),m.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(m)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(_=>{this._addIceCandidate(_)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(_=>{this.destroy(p(_,"ERR_SET_REMOTE_DESCRIPTION"))}),m.sdp||m.candidate||m.renegotiate||m.transceiverRequest||this.destroy(p(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(m){let _=new this._wrtc.RTCIceCandidate(m);this._pc.addIceCandidate(_).catch(x=>{!_.address||_.address.endsWith(".local")?a("Ignoring unsupported ICE candidate."):this.destroy(p(x,"ERR_ADD_ICE_CANDIDATE"))})}send(m){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(m)}}addTransceiver(m,_){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(m,_),this._needsNegotiation()}catch(x){this.destroy(p(x,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:m,init:_}})}}addStream(m){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),m.getTracks().forEach(_=>{this.addTrack(_,m)})}}addTrack(m,_){if(this.destroying)return;if(this.destroyed)throw p(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");let x=this._senderMap.get(m)||new Map,C=x.get(_);if(!C)C=this._pc.addTrack(m,_),x.set(_,C),this._senderMap.set(m,x),this._needsNegotiation();else throw C.removed?p(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):p(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(m,_,x){if(this.destroying)return;if(this.destroyed)throw p(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");let C=this._senderMap.get(m),S=C?C.get(x):null;if(!S)throw p(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");_&&this._senderMap.set(_,C),S.replaceTrack==null?this.destroy(p(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):S.replaceTrack(_)}removeTrack(m,_){if(this.destroying)return;if(this.destroyed)throw p(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");let x=this._senderMap.get(m),C=x?x.get(_):null;if(!C)throw p(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{C.removed=!0,this._pc.removeTrack(C)}catch(S){S.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(C):this.destroy(p(S,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(m){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),m.getTracks().forEach(_=>{this.removeTrack(_,m)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,f(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(m){this._destroy(m,()=>{})}_destroy(m,_){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",m&&(m.message||m)),f(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",m&&(m.message||m)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,m&&this.emit("error",m),this.emit("close"),_()}))}_setupData(m){if(!m.channel)return this.destroy(p(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=m.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=w),this.channelName=this._channel.label,this._channel.onmessage=x=>{this._onChannelMessage(x)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=x=>{let C=x.error instanceof Error?x.error:new Error(`Datachannel error: ${x.message} ${x.filename}:${x.lineno}:${x.colno}`);this.destroy(p(C,"ERR_DATA_CHANNEL"))};let _=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(_&&this._onChannelClose(),_=!0):_=!1},5e3)}_read(){}_write(m,_,x){if(this.destroyed)return x(p(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(m)}catch(C){return this.destroy(p(C,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>w?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=x):x(null)}else this._debug("write before connect"),this._chunk=m,this._cb=x}_onFinish(){if(!this.destroyed){let m=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?m():this.once("connect",m)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(m=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(m.sdp=o(m.sdp)),m.sdp=this.sdpTransform(m.sdp);let _=()=>{if(!this.destroyed){let x=this._pc.localDescription||m;this._debug("signal"),this.emit("signal",{type:x.type,sdp:x.sdp})}};this._pc.setLocalDescription(m).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(x=>{this.destroy(p(x,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(m=>{this.destroy(p(m,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(m=>{m.mid||!m.sender.track||m.requested||(m.requested=!0,this.addTransceiver(m.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(m=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(m.sdp=o(m.sdp)),m.sdp=this.sdpTransform(m.sdp);let _=()=>{if(!this.destroyed){let x=this._pc.localDescription||m;this._debug("signal"),this.emit("signal",{type:x.type,sdp:x.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(m).then(()=>{this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(x=>{this.destroy(p(x,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(m=>{this.destroy(p(m,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(p(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;let m=this._pc.iceConnectionState,_=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",m,_),this.emit("iceStateChange",m,_),(m==="connected"||m==="completed")&&(this._pcReady=!0,this._maybeReady()),m==="failed"&&this.destroy(p(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),m==="closed"&&this.destroy(p(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(m){let _=x=>(Object.prototype.toString.call(x.values)==="[object Array]"&&x.values.forEach(C=>{Object.assign(x,C)}),x);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(x=>{let C=[];x.forEach(S=>{C.push(_(S))}),m(null,C)},x=>m(x)):0<this._pc.getStats.length?this._pc.getStats(x=>{if(this.destroyed)return;let C=[];x.result().forEach(S=>{let T={};S.names().forEach(O=>{T[O]=S.stat(O)}),T.id=S.id,T.type=S.type,T.timestamp=S.timestamp,C.push(_(T))}),m(null,C)},x=>m(x)):m(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let m=()=>{this.destroyed||this.getStats((_,x)=>{if(this.destroyed)return;_&&(x=[]);let C={},S={},T={},O=!1;x.forEach(k=>{(k.type==="remotecandidate"||k.type==="remote-candidate")&&(C[k.id]=k),(k.type==="localcandidate"||k.type==="local-candidate")&&(S[k.id]=k),(k.type==="candidatepair"||k.type==="candidate-pair")&&(T[k.id]=k)});let E=k=>{O=!0;let L=S[k.localCandidateId];L&&(L.ip||L.address)?(this.localAddress=L.ip||L.address,this.localPort=+L.port):L&&L.ipAddress?(this.localAddress=L.ipAddress,this.localPort=+L.portNumber):typeof k.googLocalAddress=="string"&&(L=k.googLocalAddress.split(":"),this.localAddress=L[0],this.localPort=+L[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let V=C[k.remoteCandidateId];V&&(V.ip||V.address)?(this.remoteAddress=V.ip||V.address,this.remotePort=+V.port):V&&V.ipAddress?(this.remoteAddress=V.ipAddress,this.remotePort=+V.portNumber):typeof k.googRemoteAddress=="string"&&(V=k.googRemoteAddress.split(":"),this.remoteAddress=V[0],this.remotePort=+V[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(x.forEach(k=>{k.type==="transport"&&k.selectedCandidatePairId&&E(T[k.selectedCandidatePairId]),(k.type==="googCandidatePair"&&k.googActiveConnection==="true"||(k.type==="candidatepair"||k.type==="candidate-pair")&&k.selected)&&E(k)}),!O&&(!Object.keys(T).length||Object.keys(S).length))return void setTimeout(m,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(L){return this.destroy(p(L,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');let k=this._cb;this._cb=null,k(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};m()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>w)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(m=>{this._pc.removeTrack(m),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(m){this.destroyed||(m.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:m.candidate.candidate,sdpMLineIndex:m.candidate.sdpMLineIndex,sdpMid:m.candidate.sdpMid}}):!m.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),m.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(m){if(this.destroyed)return;let _=m.data;_ instanceof ArrayBuffer&&(_=y.from(_)),this.push(_)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);let m=this._cb;this._cb=null,m(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(m){this.destroyed||m.streams.forEach(_=>{this._debug("on track"),this.emit("track",m.track,_),this._remoteTracks.push({track:m.track,stream:_}),this._remoteStreams.some(x=>x.id===_.id)||(this._remoteStreams.push(_),f(()=>{this._debug("on stream"),this.emit("stream",_)}))})}_debug(){let m=[].slice.call(arguments);m[0]="["+this._id+"] "+m[0],h.apply(null,m)}}v.WEBRTC_SUPPORT=!!g(),v.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},v.channelConfig={},i.exports=v},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})});var kr={};bo(kr,{AbsolutePosition:()=>bs,AbstractConnector:()=>Ai,AbstractStruct:()=>Dn,AbstractType:()=>ht,Array:()=>Ge,ContentAny:()=>ke,ContentBinary:()=>Qe,ContentDeleted:()=>On,ContentDoc:()=>Ze,ContentEmbed:()=>le,ContentFormat:()=>ut,ContentJSON:()=>Er,ContentString:()=>Ht,ContentType:()=>Vt,Doc:()=>ve,GC:()=>At,ID:()=>ce,Item:()=>et,Map:()=>Ke,PermanentUserData:()=>Ui,RelativePosition:()=>Rn,Skip:()=>St,Snapshot:()=>mr,Text:()=>In,Transaction:()=>xs,UndoManager:()=>Li,UpdateDecoderV1:()=>It,UpdateDecoderV2:()=>Tt,UpdateEncoderV1:()=>Jt,UpdateEncoderV2:()=>Ot,XmlElement:()=>Xe,XmlFragment:()=>Je,XmlHook:()=>Sr,XmlText:()=>Ts,YArrayEvent:()=>vs,YEvent:()=>ze,YMapEvent:()=>Cs,YTextEvent:()=>ks,YXmlEvent:()=>As,applyUpdate:()=>vr,applyUpdateV2:()=>Is,cleanupYTextFormatting:()=>va,compareIDs:()=>$e,compareRelativePositions:()=>su,convertUpdateFormatV1ToV2:()=>Cu,convertUpdateFormatV2ToV1:()=>ca,createAbsolutePositionFromRelativePosition:()=>ru,createDeleteSet:()=>Rs,createDeleteSetFromStructStore:()=>Fi,createDocFromSnapshot:()=>hu,createID:()=>$,createRelativePositionFromJSON:()=>Kh,createRelativePositionFromTypeIndex:()=>Xh,createSnapshot:()=>Yi,decodeRelativePosition:()=>eu,decodeSnapshot:()=>cu,decodeSnapshotV2:()=>Gc,decodeStateVector:()=>$i,decodeUpdate:()=>wu,decodeUpdateV2:()=>ea,diffUpdate:()=>Su,diffUpdateV2:()=>zi,emptySnapshot:()=>au,encodeRelativePosition:()=>Zh,encodeSnapshot:()=>ou,encodeSnapshotV2:()=>zc,encodeStateAsUpdate:()=>Ln,encodeStateAsUpdateV2:()=>Hc,encodeStateVector:()=>Hi,encodeStateVectorFromUpdate:()=>bu,encodeStateVectorFromUpdateV2:()=>ra,equalDeleteSets:()=>$c,equalSnapshots:()=>iu,findIndexSS:()=>Bt,findRootTypeKey:()=>Wi,getItem:()=>qe,getItemCleanEnd:()=>Di,getItemCleanStart:()=>kt,getState:()=>ot,getTypeChildren:()=>Uu,isDeleted:()=>tn,isParentOf:()=>gr,iterateDeletedStructs:()=>He,logType:()=>zh,logUpdate:()=>yu,logUpdateV2:()=>ta,mergeDeleteSets:()=>We,mergeUpdates:()=>na,mergeUpdatesV2:()=>wr,obfuscateUpdate:()=>Eu,obfuscateUpdateV2:()=>vu,parseUpdateMeta:()=>_u,parseUpdateMetaV2:()=>sa,readUpdate:()=>qh,readUpdateV2:()=>Pi,relativePositionToJSON:()=>Gh,snapshot:()=>lu,snapshotContainsUpdate:()=>du,transact:()=>tt,tryGc:()=>gu,typeListToArraySnapshot:()=>Ru,typeMapGetAllSnapshot:()=>ba,typeMapGetSnapshot:()=>Ou});var at=()=>new Map,Or=e=>{let t=at();return e.forEach((n,r)=>{t.set(r,n)}),t},lt=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},_o=(e,t)=>{let n=[];for(let[r,i]of e)n.push(t(i,r));return n},xo=(e,t)=>{for(let[n,r]of e)if(t(r,n))return!0;return!1};var Nt=()=>new Set;var Nr=e=>e[e.length-1];var So=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},$t=Array.from,Mr=(e,t)=>{for(let n=0;n<e.length;n++)if(!t(e[n],n,e))return!1;return!0},Wn=(e,t)=>{for(let n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1};var Eo=(e,t)=>{let n=new Array(e);for(let r=0;r<e;r++)n[r]=t(r,n);return n};var te=Array.isArray;var Wt=class{constructor(){this._observers=at()}on(t,n){return lt(this._observers,t,Nt).add(n),n}once(t,n){let r=(...i)=>{this.off(t,r),n(...i)};this.on(t,r)}off(t,n){let r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return $t((this._observers.get(t)||at()).values()).forEach(r=>r(...n))}destroy(){this._observers=at()}},pe=class{constructor(){this._observers=at()}on(t,n){lt(this._observers,t,Nt).add(n)}once(t,n){let r=(...i)=>{this.off(t,r),n(...i)};this.on(t,r)}off(t,n){let r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return $t((this._observers.get(t)||at()).values()).forEach(r=>r(...n))}destroy(){this._observers=at()}};var pt=Math.floor;var Ie=Math.abs;var vo=Math.log10;var ge=(e,t)=>e<t?e:t,ee=(e,t)=>e>t?e:t,Ld=Number.isNaN,Co=Math.pow;var Br=e=>e!==0?e<0:1/e<0;var un=Number.MAX_SAFE_INTEGER,Js=Number.MIN_SAFE_INTEGER,Nd=1<<31;var ko=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&pt(e)===e),Md=Number.isNaN,Bd=Number.parseInt;var zn=String.fromCharCode,bl=String.fromCodePoint,Vd=zn(65535),_l=e=>e.toLowerCase(),xl=/^\s*/g,Sl=e=>e.replace(xl,""),El=/([A-Z])/g,Qs=(e,t)=>Sl(e.replace(El,n=>`${t}${_l(n)}`));var vl=e=>{let t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.codePointAt(i);return r},fn=typeof TextEncoder<"u"?new TextEncoder:null,Cl=e=>fn.encode(e),Gn=fn?Cl:vl;var dn=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});dn&&dn.decode(new Uint8Array).length===1&&(dn=null);var Vr=(e,t)=>Eo(t,()=>e).join("");var Oe=class{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}},G=()=>new Oe;var jr=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t};var H=e=>{let t=new Uint8Array(jr(e)),n=0;for(let r=0;r<e.bufs.length;r++){let i=e.bufs[r];t.set(i,n),n+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},kl=(e,t)=>{let n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(ee(n,t)*2),e.cpos=0)},yt=(e,t)=>{let n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t};var re=yt;var N=(e,t)=>{for(;t>127;)yt(e,128|127&t),t=pt(t/128);yt(e,127&t)},Jn=(e,t)=>{let n=Br(t);for(n&&(t=-t),yt(e,(t>63?128:0)|(n?64:0)|63&t),t=pt(t/64);t>0;)yt(e,(t>127?128:0)|127&t),t=pt(t/128)},Zs=new Uint8Array(3e4),Al=Zs.length/3,Tl=(e,t)=>{if(t.length<Al){let n=fn.encodeInto(t,Zs).written||0;N(e,n);for(let r=0;r<n;r++)yt(e,Zs[r])}else Q(e,Gn(t))},Ul=(e,t)=>{let n=unescape(encodeURIComponent(t)),r=n.length;N(e,r);for(let i=0;i<r;i++)yt(e,n.codePointAt(i))},vt=fn&&fn.encodeInto?Tl:Ul;var Io=(e,t)=>mn(e,H(t)),mn=(e,t)=>{let n=e.cbuf.length,r=e.cpos,i=ge(n-r,t.length),o=t.length-i;e.cbuf.set(t.subarray(0,i),r),e.cpos+=i,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(ee(n*2,o)),e.cbuf.set(t.subarray(i)),e.cpos=o)},Q=(e,t)=>{N(e,t.byteLength),mn(e,t)},ti=(e,t)=>{kl(e,t);let n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},Rl=(e,t)=>ti(e,4).setFloat32(0,t,!1),Il=(e,t)=>ti(e,8).setFloat64(0,t,!1),Dl=(e,t)=>ti(e,8).setBigInt64(0,t,!1);var To=new DataView(new ArrayBuffer(4)),Ol=e=>(To.setFloat32(0,e),To.getFloat32(0)===e),me=(e,t)=>{switch(typeof t){case"string":yt(e,119),vt(e,t);break;case"number":ko(t)&&Ie(t)<=2147483647?(yt(e,125),Jn(e,t)):Ol(t)?(yt(e,124),Rl(e,t)):(yt(e,123),Il(e,t));break;case"bigint":yt(e,122),Dl(e,t);break;case"object":if(t===null)yt(e,126);else if(te(t)){yt(e,117),N(e,t.length);for(let n=0;n<t.length;n++)me(e,t[n])}else if(t instanceof Uint8Array)yt(e,116),Q(e,t);else{yt(e,118);let n=Object.keys(t);N(e,n.length);for(let r=0;r<n.length;r++){let i=n[r];vt(e,i),me(e,t[i])}}break;case"boolean":yt(e,t?120:121);break;default:yt(e,127)}},Kn=class extends Oe{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&N(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}};var Uo=e=>{e.count>0&&(Jn(e.encoder,e.count===1?e.s:-e.s),e.count>1&&N(e.encoder,e.count-2))},Le=class{constructor(){this.encoder=new Oe,this.s=0,this.count=0}write(t){this.s===t?this.count++:(Uo(this),this.count=1,this.s=t)}toUint8Array(){return Uo(this),H(this.encoder)}};var Ro=e=>{if(e.count>0){let t=e.diff*2+(e.count===1?0:1);Jn(e.encoder,t),e.count>1&&N(e.encoder,e.count-2)}},gn=class{constructor(){this.encoder=new Oe,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(Ro(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return Ro(this),H(this.encoder)}},Fr=class{constructor(){this.sarr=[],this.s="",this.lensE=new Le}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){let t=new Oe;return this.sarr.push(this.s),this.s="",vt(t,this.sarr.join("")),mn(t,this.lensE.toUint8Array()),H(t)}};var gt=e=>new Error(e),Dt=()=>{throw gt("Method unimplemented")},wt=()=>{throw gt("Unexpected case")};var Do=gt("Unexpected end of array"),Oo=gt("Integer out of Range"),bn=class{constructor(t){this.arr=t,this.pos=0}},nt=e=>new bn(e),ei=e=>e.pos!==e.arr.length;var Ll=(e,t)=>{let n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},it=e=>Ll(e,j(e));var se=e=>e.arr[e.pos++];var j=e=>{let t=0,n=1,r=e.arr.length;for(;e.pos<r;){let i=e.arr[e.pos++];if(t=t+(i&127)*n,n*=128,i<128)return t;if(t>un)throw Oo}throw Do},Qn=e=>{let t=e.arr[e.pos++],n=t&63,r=64,i=(t&64)>0?-1:1;if((t&128)===0)return i*n;let o=e.arr.length;for(;e.pos<o;){if(t=e.arr[e.pos++],n=n+(t&127)*r,r*=128,t<128)return i*n;if(n>un)throw Oo}throw Do};var Nl=e=>{let t=j(e);if(t===0)return"";{let n=String.fromCodePoint(se(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(se(e));else for(;t>0;){let r=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,i),t-=r}return decodeURIComponent(escape(n))}},Ml=e=>dn.decode(it(e)),_t=dn?Ml:Nl;var ni=(e,t)=>{let n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},Bl=e=>ni(e,4).getFloat32(0,!1),Vl=e=>ni(e,8).getFloat64(0,!1),Fl=e=>ni(e,8).getBigInt64(0,!1);var jl=[e=>{},e=>null,Qn,Bl,Vl,Fl,e=>!1,e=>!0,_t,e=>{let t=j(e),n={};for(let r=0;r<t;r++){let i=_t(e);n[i]=we(e)}return n},e=>{let t=j(e),n=[];for(let r=0;r<t;r++)n.push(we(e));return n},it],we=e=>jl[127-se(e)](e),Xn=class extends bn{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),ei(this)?this.count=j(this)+1:this.count=-1),this.count--,this.s}};var Ne=class extends bn{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=Qn(this);let t=Br(this.s);this.count=1,t&&(this.s=-this.s,this.count=j(this)+2)}return this.count--,this.s}};var _n=class extends bn{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){let t=Qn(this),n=t&1;this.diff=pt(t/2),this.count=1,n&&(this.count=j(this)+2)}return this.s+=this.diff,this.count--,this.s}},Pr=class{constructor(t){this.decoder=new Ne(t),this.str=_t(this.decoder),this.spos=0}read(){let t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}};var Pd=crypto.subtle,Lo=crypto.getRandomValues.bind(crypto);var No=Math.random,ri=()=>Lo(new Uint32Array(1))[0];var Pl="10000000-1000-4000-8000"+-1e11,$r=()=>Pl.replace(/[018]/g,e=>(e^ri()&15>>e/4).toString(16));var bt=Date.now;var ie=e=>new Promise(e);var $l=Promise.all.bind(Promise),Bo=e=>Promise.reject(e),tr=e=>Promise.resolve(e);var si=e=>e===void 0?null:e;var ii=class{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}},Vo=new ii,oi=!0;try{typeof localStorage<"u"&&localStorage&&(Vo=localStorage,oi=!1)}catch{}var qr=Vo,Fo=e=>oi||addEventListener("storage",e),jo=e=>oi||removeEventListener("storage",e);var Be=Symbol("Equality"),Hr=(e,t)=>e===t||!!e?.[Be]?.(t)||!1;var $o=e=>typeof e=="object",qo=Object.assign,Hl=Object.keys;var Ho=(e,t)=>{for(let n in e)t(e[n],n)},Wo=(e,t)=>{let n=[];for(let r in e)n.push(t(e[r],r));return n};var nr=e=>Hl(e).length;var Yo=e=>{for(let t in e)return!1;return!0},xn=(e,t)=>{for(let n in e)if(!t(e[n],n))return!1;return!0},rr=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),ai=(e,t)=>e===t||nr(e)===nr(t)&&xn(e,(n,r)=>(n!==void 0||rr(t,r))&&Hr(t[r],n)),Wl=Object.freeze,li=e=>{for(let t in e){let n=e[t];(typeof n=="object"||typeof n=="function")&&li(e[t])}return Wl(e)};var sr=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&sr(e,t,n+1)}},zo=()=>{};var hi=e=>e;var be=(e,t)=>{if(e===t)return!0;if(e==null||t==null||e.constructor!==t.constructor&&(e.constructor||Object)!==(t.constructor||Object))return!1;if(e[Be]!=null)return e[Be](t);switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:{if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break}case Set:{if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;break}case Map:{if(e.size!==t.size)return!1;for(let n of e.keys())if(!t.has(n)||!be(e.get(n),t.get(n)))return!1;break}case void 0:case Object:if(nr(e)!==nr(t))return!1;for(let n in e)if(!rr(e,n)||!be(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!be(e[n],t[n]))return!1;break;default:return!1}return!0},Go=(e,t)=>t.includes(e);var oe=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",Yr=typeof window<"u"&&typeof document<"u"&&!oe,Hd=typeof navigator<"u"?/Mac/.test(navigator.platform):!1,Yt,Yl=[],zl=()=>{if(Yt===void 0)if(oe){Yt=at();let e=process.argv,t=null;for(let n=0;n<e.length;n++){let r=e[n];r[0]==="-"?(t!==null&&Yt.set(t,""),t=r):t!==null?(Yt.set(t,r),t=null):Yl.push(r)}t!==null&&Yt.set(t,"")}else typeof location=="object"?(Yt=at(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){let[t,n]=e.split("=");Yt.set(`--${Qs(t,"-")}`,n),Yt.set(`-${Qs(t,"-")}`,n)}})):Yt=at();return Yt},ui=e=>zl().has(e);var Ve=e=>oe?si(process.env[e.toUpperCase().replaceAll("-","_")]):si(qr.getItem(e));var Ko=e=>ui("--"+e)||Ve(e)!==null,Jo=Ko("production"),Gl=oe&&Go(process.env.FORCE_COLOR,["true","1","2"]),Xo=Gl||!ui("--no-colors")&&!Ko("no-color")&&(!oe||process.stdout.isTTY)&&(!oe||ui("--color")||Ve("COLORTERM")!==null||(Ve("TERM")||"").includes("color"));var Qo=e=>new Uint8Array(e),Kl=(e,t,n)=>new Uint8Array(e,t,n),Zo=e=>new Uint8Array(e),Jl=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=zn(e[n]);return btoa(t)},Xl=e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),Ql=e=>{let t=atob(e),n=Qo(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},Zl=e=>{let t=Buffer.from(e,"base64");return Kl(t.buffer,t.byteOffset,t.byteLength)},zr=Yr?Jl:Xl,Gr=Yr?Ql:Zl;var tc=e=>{let t=Qo(e.byteLength);return t.set(e),t};var fi=class{constructor(t,n){this.left=t,this.right=n}},zt=(e,t)=>new fi(e,t);var pi=e=>e.next()>=.5,Kr=(e,t,n)=>pt(e.next()*(n+1-t)+t);var gi=(e,t,n)=>pt(e.next()*(n+1-t)+t);var mi=(e,t,n)=>gi(e,t,n);var eh=e=>zn(mi(e,97,122)),ec=(e,t=0,n=20)=>{let r=mi(e,t,n),i="";for(let o=0;o<r;o++)i+=eh(e);return i};var Jr=(e,t)=>t[mi(e,0,t.length-1)];var rh=Symbol("0schema"),yi=class{constructor(){this._rerrs=[]}extend(t,n,r,i=null){this._rerrs.push({path:t,expected:n,has:r,message:i})}toString(){let t=[];for(let n=this._rerrs.length-1;n>0;n--){let r=this._rerrs[n];t.push(Vr(" ",(this._rerrs.length-n)*2)+`${r.path!=null?`[${r.path}] `:""}${r.has} doesn't match ${r.expected}. ${r.message}`)}return t.join(`
`)}},wi=(e,t)=>e===t?!0:e==null||t==null||e.constructor!==t.constructor?!1:e[Be]?Hr(e,t):te(e)?Mr(e,n=>Wn(t,r=>wi(n,r))):$o(e)?xn(e,(n,r)=>wi(n,t[r])):!1,xt=class{static _dilutes=!1;extends(t){let[n,r]=[this.shape,t.shape];return this.constructor._dilutes&&([r,n]=[n,r]),wi(n,r)}equals(t){return this.constructor===t.constructor&&be(this.shape,t.shape)}[rh](){return!0}[Be](t){return this.equals(t)}validate(t){return this.check(t)}check(t,n){Dt()}get nullable(){return An(this,as)}get optional(){return new Xr(this)}cast(t){return nc(t,this),t}expect(t){return nc(t,this),t}},or=class extends xt{constructor(t,n){super(),this.shape=t,this._c=n}check(t,n=void 0){let r=t?.constructor===this.shape&&(this._c==null||this._c(t));return!r&&n?.extend(null,this.shape.name,t?.constructor.name,t?.constructor!==this.shape?"Constructor match failed":"Check failed"),r}},dt=(e,t=null)=>new or(e,t),Yd=dt(or),cr=class extends xt{constructor(t){super(),this.shape=t}check(t,n){let r=this.shape(t);return!r&&n?.extend(null,"custom prop",t?.constructor.name,"failed to check custom prop"),r}},mt=e=>new cr(e),zd=dt(cr),Cn=class extends xt{constructor(t){super(),this.shape=t}check(t,n){let r=this.shape.some(i=>i===t);return!r&&n?.extend(null,this.shape.join(" | "),t.toString()),r}},os=(...e)=>new Cn(e),rc=dt(Cn),sh=RegExp.escape||(e=>e.replace(/[().|&,$^[\]]/g,t=>"\\"+t)),sc=e=>{if(kn.check(e))return[sh(e)];if(rc.check(e))return e.shape.map(t=>t+"");if(lc.check(e))return["[+-]?\\d+.?\\d*"];if(hc.check(e))return[".*"];if(ss.check(e))return e.shape.map(sc).flat(1);wt()},bi=class extends xt{constructor(t){super(),this.shape=t,this._r=new RegExp("^"+t.map(sc).map(n=>`(${n.join("|")})`).join("")+"$")}check(t,n){let r=this._r.exec(t)!=null;return!r&&n?.extend(null,this._r.toString(),t.toString(),"String doesn't match string template."),r}};var Gd=dt(bi),ih=Symbol("optional"),Xr=class extends xt{constructor(t){super(),this.shape=t}check(t,n){let r=t===void 0||this.shape.check(t);return!r&&n?.extend(null,"undefined (optional)","()"),r}get[ih](){return!0}},oh=dt(Xr),Qr=class extends xt{check(t,n){return n?.extend(null,"never",typeof t),!1}},Kd=new Qr,Jd=dt(Qr),Zr=class e extends xt{constructor(t,n=!1){super(),this.shape=t,this._isPartial=n}static _dilutes=!0;get partial(){return new e(this.shape,!0)}check(t,n){return t==null?(n?.extend(null,"object","null"),!1):xn(this.shape,(r,i)=>{let o=this._isPartial&&!rr(t,i)||r.check(t[i],n);return!o&&n?.extend(i.toString(),r.toString(),typeof t[i],"Object property does not match"),o})}},ch=e=>new Zr(e),ah=dt(Zr),lh=mt(e=>e!=null&&(e.constructor===Object||e.constructor==null)),ts=class extends xt{constructor(t,n){super(),this.shape={keys:t,values:n}}check(t,n){return t!=null&&xn(t,(r,i)=>{let o=this.shape.keys.check(i,n);return!o&&n?.extend(i+"","Record",typeof t,o?"Key doesn't match schema":"Value doesn't match value"),o&&this.shape.values.check(r,n)})}},ic=(e,t)=>new ts(e,t),hh=dt(ts),es=class extends xt{constructor(t){super(),this.shape=t}check(t,n){return t!=null&&xn(this.shape,(r,i)=>{let o=r.check(t[i],n);return!o&&n?.extend(i.toString(),"Tuple",typeof r),o})}},uh=(...e)=>new es(e),Xd=dt(es),ns=class extends xt{constructor(t){super(),this.shape=t.length===1?t[0]:new ar(t)}check(t,n){let r=te(t)&&Mr(t,i=>this.shape.check(i));return!r&&n?.extend(null,"Array",""),r}},oc=(...e)=>new ns(e),dh=dt(ns),fh=mt(e=>te(e)),rs=class extends xt{constructor(t,n){super(),this.shape=t,this._c=n}check(t,n){let r=t instanceof this.shape&&(this._c==null||this._c(t));return!r&&n?.extend(null,this.shape.name,t?.constructor.name),r}},ph=(e,t=null)=>new rs(e,t),Qd=dt(rs),gh=ph(xt),_i=class extends xt{constructor(t){super(),this.len=t.length-1,this.args=uh(...t.slice(-1)),this.res=t[this.len]}check(t,n){let r=t.constructor===Function&&t.length<=this.len;return!r&&n?.extend(null,"function",typeof t),r}};var mh=dt(_i),yh=mt(e=>typeof e=="function"),xi=class extends xt{constructor(t){super(),this.shape=t}check(t,n){let r=Mr(this.shape,i=>i.check(t,n));return!r&&n?.extend(null,"Intersectinon",typeof t),r}};var Zd=dt(xi,e=>e.shape.length>0),ar=class extends xt{static _dilutes=!0;constructor(t){super(),this.shape=t}check(t,n){let r=Wn(this.shape,i=>i.check(t,n));return n?.extend(null,"Union",typeof t),r}},An=(...e)=>e.findIndex(t=>ss.check(t))>=0?An(...e.map(t=>lr(t)).map(t=>ss.check(t)?t.shape:[t]).flat(1)):e.length===1?e[0]:new ar(e),ss=dt(ar),cc=()=>!0,is=mt(cc),wh=dt(cr,e=>e.shape===cc),Ei=mt(e=>typeof e=="bigint"),bh=mt(e=>e===Ei),ac=mt(e=>typeof e=="symbol"),tf=mt(e=>e===ac),vn=mt(e=>typeof e=="number"),lc=mt(e=>e===vn),kn=mt(e=>typeof e=="string"),hc=mt(e=>e===kn),cs=mt(e=>typeof e=="boolean"),_h=mt(e=>e===cs),uc=os(void 0),ef=dt(Cn,e=>e.shape.length===1&&e.shape[0]===void 0),nf=os(void 0);var as=os(null),xh=dt(Cn,e=>e.shape.length===1&&e.shape[0]===null),rf=dt(Uint8Array),sf=dt(or,e=>e.shape===Uint8Array),Sh=An(vn,kn,as,uc,Ei,cs,ac),of=(()=>{let e=oc(is),t=ic(kn,is),n=An(vn,kn,as,cs,e,t);return e.shape=n,t.shape.values=n,n})(),lr=e=>{if(gh.check(e))return e;if(lh.check(e)){let t={};for(let n in e)t[n]=lr(e[n]);return ch(t)}else{if(fh.check(e))return An(...e.map(lr));if(Sh.check(e))return os(e);if(yh.check(e))return dt(e)}wt()},nc=Jo?()=>{}:(e,t)=>{let n=new yi;if(!t.check(e,n))throw gt(`Expected value to be of type ${t.constructor.name}.
${n.toString()}`)},Si=class{constructor(t){this.patterns=[],this.$state=t}if(t,n){return this.patterns.push({if:lr(t),h:n}),this}else(t){return this.if(is,t)}done(){return(t,n)=>{for(let r=0;r<this.patterns.length;r++){let i=this.patterns[r];if(i.if.check(t))return i.h(t,n)}throw gt("Unhandled pattern")}}},Eh=e=>new Si(e),dc=Eh(is).if(lc,(e,t)=>Kr(t,Js,un)).if(hc,(e,t)=>ec(t)).if(_h,(e,t)=>pi(t)).if(bh,(e,t)=>BigInt(Kr(t,Js,un))).if(ss,(e,t)=>En(t,Jr(t,e.shape))).if(ah,(e,t)=>{let n={};for(let r in e.shape){let i=e.shape[r];if(oh.check(i)){if(pi(t))continue;i=i.shape}n[r]=dc(i,t)}return n}).if(dh,(e,t)=>{let n=[],r=gi(t,0,42);for(let i=0;i<r;i++)n.push(En(t,e.shape));return n}).if(rc,(e,t)=>Jr(t,e.shape)).if(xh,(e,t)=>null).if(mh,(e,t)=>{let n=En(t,e.res);return()=>n}).if(wh,(e,t)=>En(t,Jr(t,[vn,kn,as,uc,Ei,cs,oc(vn),ic(An("a","b","c"),vn)]))).if(hh,(e,t)=>{let n={},r=Kr(t,0,3);for(let i=0;i<r;i++){let o=En(t,e.shape.keys),a=En(t,e.shape.values);n[o]=a}return n}).done(),En=(e,t)=>dc(lr(t),e);var Fe=typeof document<"u"?document:{};var cf=mt(e=>e.nodeType===Th);var af=typeof DOMParser<"u"?new DOMParser:null;var lf=mt(e=>e.nodeType===Ch);var hf=mt(e=>e.nodeType===kh);var fc=e=>_o(e,(t,n)=>`${n}:${t};`).join("");var Ch=Fe.ELEMENT_NODE,kh=Fe.TEXT_NODE,uf=Fe.CDATA_SECTION_NODE,df=Fe.COMMENT_NODE,Ah=Fe.DOCUMENT_NODE,ff=Fe.DOCUMENT_TYPE_NODE,Th=Fe.DOCUMENT_FRAGMENT_NODE,pf=mt(e=>e.nodeType===Ah);var pc=JSON.stringify;var Gt=Symbol;var Ct=Gt(),qt=Gt(),ls=Gt(),Tn=Gt(),hs=Gt(),hr=Gt(),us=Gt(),je=Gt(),Pe=Gt(),yc=e=>{e.length===1&&e[0]?.constructor===Function&&(e=e[0]());let t=[],n=[],r=0;for(;r<e.length;r++){let i=e[r];if(i===void 0)break;if(i.constructor===String||i.constructor===Number)t.push(i);else if(i.constructor===Object)break}for(r>0&&n.push(t.join(""));r<e.length;r++){let i=e[r];i instanceof Symbol||n.push(i)}return n},gc=[hs,us,je,ls],vi=0,mc=bt(),wc=(e,t)=>{let n=gc[vi],r=Ve("log"),i=r!==null&&(r==="*"||r==="true"||new RegExp(r,"gi").test(t));return vi=(vi+1)%gc.length,t+=": ",i?(...o)=>{o.length===1&&o[0]?.constructor===Function&&(o=o[0]());let a=bt(),h=a-mc;mc=a,e(n,t,Pe,...o.map(g=>{switch(g!=null&&g.constructor===Uint8Array&&(g=Array.from(g)),typeof g){case"string":case"symbol":return g;default:return pc(g)}}),n," +"+h+"ms")}:zo};var Oh={[Ct]:zt("font-weight","bold"),[qt]:zt("font-weight","normal"),[ls]:zt("color","blue"),[hs]:zt("color","green"),[Tn]:zt("color","grey"),[hr]:zt("color","red"),[us]:zt("color","purple"),[je]:zt("color","orange"),[Pe]:zt("color","black")},Lh=e=>{e.length===1&&e[0]?.constructor===Function&&(e=e[0]());let t=[],n=[],r=at(),i=[],o=0;for(;o<e.length;o++){let a=e[o],h=Oh[a];if(h!==void 0)r.set(h.left,h.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){let g=fc(r);o>0||g.length>0?(t.push("%c"+a),n.push(g)):t.push(a)}else break}}for(o>0&&(i=n,i.unshift(t.join("")));o<e.length;o++){let a=e[o];a instanceof Symbol||i.push(a)}return i},bc=Xo?Lh:yc,ur=(...e)=>{console.log(...bc(e)),_c.forEach(t=>t.print(e))},Ci=(...e)=>{console.warn(...bc(e)),e.unshift(je),_c.forEach(t=>t.print(e))};var _c=Nt();var xc=e=>wc(ur,e);var Ec=e=>({[Symbol.iterator](){return this},next:e}),vc=(e,t)=>Ec(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),ds=(e,t)=>Ec(()=>{let{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}});var Ai=class extends Wt{constructor(t,n){super(),this.doc=t,this.awareness=n}},fr=class{constructor(t,n){this.clock=t,this.len=n}},Ee=class{constructor(){this.clients=new Map}},He=(e,t,n)=>t.clients.forEach((r,i)=>{let o=e.doc.store.clients.get(i);if(o!=null){let a=o[o.length-1],h=a.id.clock+a.length;for(let g=0,l=r[g];g<r.length&&l.clock<h;l=r[++g])Jc(e,o,l.clock,l.len,n)}}),Vh=(e,t)=>{let n=0,r=e.length-1;for(;n<=r;){let i=pt((n+r)/2),o=e[i],a=o.clock;if(a<=t){if(t<a+o.len)return i;n=i+1}else r=i-1}return null},tn=(e,t)=>{let n=e.clients.get(t.client);return n!==void 0&&Vh(n,t.clock)!==null},Vi=e=>{e.clients.forEach(t=>{t.sort((i,o)=>i.clock-o.clock);let n,r;for(n=1,r=1;n<t.length;n++){let i=t[r-1],o=t[n];i.clock+i.len>=o.clock?i.len=ee(i.len,o.clock+o.len-i.clock):(r<n&&(t[r]=o),r++)}t.length=r})},We=e=>{let t=new Ee;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,i)=>{if(!t.clients.has(i)){let o=r.slice();for(let a=n+1;a<e.length;a++)So(o,e[a].clients.get(i)||[]);t.clients.set(i,o)}});return Vi(t),t},pr=(e,t,n,r)=>{lt(e.clients,t,()=>[]).push(new fr(n,r))},Rs=()=>new Ee,Fi=e=>{let t=Rs();return e.clients.forEach((n,r)=>{let i=[];for(let o=0;o<n.length;o++){let a=n[o];if(a.deleted){let h=a.id.clock,g=a.length;if(o+1<n.length)for(let l=n[o+1];o+1<n.length&&l.deleted;l=n[++o+1])g+=l.length;i.push(new fr(h,g))}}i.length>0&&t.clients.set(r,i)}),t},Kt=(e,t)=>{N(e.restEncoder,t.clients.size),$t(t.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{e.resetDsCurVal(),N(e.restEncoder,n);let i=r.length;N(e.restEncoder,i);for(let o=0;o<i;o++){let a=r[o];e.writeDsClock(a.clock),e.writeDsLen(a.len)}})},ae=e=>{let t=new Ee,n=j(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();let i=j(e.restDecoder),o=j(e.restDecoder);if(o>0){let a=lt(t.clients,i,()=>[]);for(let h=0;h<o;h++)a.push(new fr(e.readDsClock(),e.readDsLen()))}}return t},Ac=(e,t,n)=>{let r=new Ee,i=j(e.restDecoder);for(let o=0;o<i;o++){e.resetDsCurVal();let a=j(e.restDecoder),h=j(e.restDecoder),g=n.clients.get(a)||[],l=ot(n,a);for(let u=0;u<h;u++){let f=e.readDsClock(),p=f+e.readDsLen();if(f<l){l<p&&pr(r,a,l,p-l);let y=Bt(g,f),w=g[y];for(!w.deleted&&w.id.clock<f&&(g.splice(y+1,0,Us(t,w,f-w.id.clock)),y++);y<g.length&&(w=g[y++],w.id.clock<p);)w.deleted||(p<w.id.clock+w.length&&g.splice(y,0,Us(t,w,p-w.id.clock)),w.delete(t))}else pr(r,a,f,p-f)}}if(r.clients.size>0){let o=new Ot;return N(o.restEncoder,0),Kt(o,r),o.toUint8Array()}return null},$c=(e,t)=>{if(e.clients.size!==t.clients.size)return!1;for(let[n,r]of e.clients.entries()){let i=t.clients.get(n);if(i===void 0||r.length!==i.length)return!1;for(let o=0;o<r.length;o++){let a=r[o],h=i[o];if(a.clock!==h.clock||a.len!==h.len)return!1}}return!0},qc=ri,ve=class e extends Wt{constructor({guid:t=$r(),collectionid:n=null,gc:r=!0,gcFilter:i=()=>!0,meta:o=null,autoLoad:a=!1,shouldLoad:h=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=qc(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new _s,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=h,this.autoLoad=a,this.meta=o,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=ie(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})});let g=()=>ie(l=>{let u=f=>{(f===void 0||f===!0)&&(this.off("sync",u),l())};this.on("sync",u)});this.on("sync",l=>{l===!1&&this.isSynced&&(this.whenSynced=g()),this.isSynced=l===void 0||l===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=g()}load(){let t=this._item;t!==null&&!this.shouldLoad&&tt(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set($t(this.subdocs).map(t=>t.guid))}transact(t,n=null){return tt(this,t,n)}get(t,n=ht){let r=lt(this.share,t,()=>{let o=new n;return o._integrate(this,null),o}),i=r.constructor;if(n!==ht&&i!==n)if(i===ht){let o=new n;o._map=r._map,r._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=o}),o._start=r._start;for(let a=o._start;a!==null;a=a.right)a.parent=o;return o._length=r._length,this.share.set(t,o),o._integrate(this,null),o}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,Ge)}getText(t=""){return this.get(t,In)}getMap(t=""){return this.get(t,Ke)}getXmlElement(t=""){return this.get(t,Xe)}getXmlFragment(t=""){return this.get(t,Je)}toJSON(){let t={};return this.share.forEach((n,r)=>{t[r]=n.toJSON()}),t}destroy(){this.isDestroyed=!0,$t(this.subdocs).forEach(n=>n.destroy());let t=this._item;if(t!==null){this._item=null;let n=t.content;n.doc=new e({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=t,tt(t.parent.doc,r=>{let i=n.doc;t.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}},Ye=class{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return j(this.restDecoder)}readDsLen(){return j(this.restDecoder)}},It=class extends Ye{readLeftID(){return $(j(this.restDecoder),j(this.restDecoder))}readRightID(){return $(j(this.restDecoder),j(this.restDecoder))}readClient(){return j(this.restDecoder)}readInfo(){return se(this.restDecoder)}readString(){return _t(this.restDecoder)}readParentInfo(){return j(this.restDecoder)===1}readTypeRef(){return j(this.restDecoder)}readLen(){return j(this.restDecoder)}readAny(){return we(this.restDecoder)}readBuf(){return tc(it(this.restDecoder))}readJSON(){return JSON.parse(_t(this.restDecoder))}readKey(){return _t(this.restDecoder)}},ws=class{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=j(this.restDecoder),this.dsCurrVal}readDsLen(){let t=j(this.restDecoder)+1;return this.dsCurrVal+=t,t}},Tt=class extends ws{constructor(t){super(t),this.keys=[],j(t),this.keyClockDecoder=new _n(it(t)),this.clientDecoder=new Ne(it(t)),this.leftClockDecoder=new _n(it(t)),this.rightClockDecoder=new _n(it(t)),this.infoDecoder=new Xn(it(t),se),this.stringDecoder=new Pr(it(t)),this.parentInfoDecoder=new Xn(it(t),se),this.typeRefDecoder=new Ne(it(t)),this.lenDecoder=new Ne(it(t))}readLeftID(){return new ce(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ce(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return we(this.restDecoder)}readBuf(){return it(this.restDecoder)}readJSON(){return we(this.restDecoder)}readKey(){let t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{let n=this.stringDecoder.read();return this.keys.push(n),n}}},Ce=class{constructor(){this.restEncoder=G()}toUint8Array(){return H(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){N(this.restEncoder,t)}writeDsLen(t){N(this.restEncoder,t)}},Jt=class extends Ce{writeLeftID(t){N(this.restEncoder,t.client),N(this.restEncoder,t.clock)}writeRightID(t){N(this.restEncoder,t.client),N(this.restEncoder,t.clock)}writeClient(t){N(this.restEncoder,t)}writeInfo(t){re(this.restEncoder,t)}writeString(t){vt(this.restEncoder,t)}writeParentInfo(t){N(this.restEncoder,t?1:0)}writeTypeRef(t){N(this.restEncoder,t)}writeLen(t){N(this.restEncoder,t)}writeAny(t){me(this.restEncoder,t)}writeBuf(t){Q(this.restEncoder,t)}writeJSON(t){vt(this.restEncoder,JSON.stringify(t))}writeKey(t){vt(this.restEncoder,t)}},Un=class{constructor(){this.restEncoder=G(),this.dsCurrVal=0}toUint8Array(){return H(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){let n=t-this.dsCurrVal;this.dsCurrVal=t,N(this.restEncoder,n)}writeDsLen(t){t===0&&wt(),N(this.restEncoder,t-1),this.dsCurrVal+=t}},Ot=class extends Un{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new gn,this.clientEncoder=new Le,this.leftClockEncoder=new gn,this.rightClockEncoder=new gn,this.infoEncoder=new Kn(re),this.stringEncoder=new Fr,this.parentInfoEncoder=new Kn(re),this.typeRefEncoder=new Le,this.lenEncoder=new Le}toUint8Array(){let t=G();return N(t,0),Q(t,this.keyClockEncoder.toUint8Array()),Q(t,this.clientEncoder.toUint8Array()),Q(t,this.leftClockEncoder.toUint8Array()),Q(t,this.rightClockEncoder.toUint8Array()),Q(t,H(this.infoEncoder)),Q(t,this.stringEncoder.toUint8Array()),Q(t,H(this.parentInfoEncoder)),Q(t,this.typeRefEncoder.toUint8Array()),Q(t,this.lenEncoder.toUint8Array()),mn(t,H(this.restEncoder)),H(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){me(this.restEncoder,t)}writeBuf(t){Q(this.restEncoder,t)}writeJSON(t){me(this.restEncoder,t)}writeKey(t){let n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}},Fh=(e,t,n,r)=>{r=ee(r,t[0].id.clock);let i=Bt(t,r);N(e.restEncoder,t.length-i),e.writeClient(n),N(e.restEncoder,r);let o=t[i];o.write(e,r-o.id.clock);for(let a=i+1;a<t.length;a++)t[a].write(e,0)},ji=(e,t,n)=>{let r=new Map;n.forEach((i,o)=>{ot(t,o)>i&&r.set(o,i)}),Cr(t).forEach((i,o)=>{n.has(o)||r.set(o,0)}),N(e.restEncoder,r.size),$t(r.entries()).sort((i,o)=>o[0]-i[0]).forEach(([i,o])=>{Fh(e,t.clients.get(i),i,o)})},jh=(e,t)=>{let n=at(),r=j(e.restDecoder);for(let i=0;i<r;i++){let o=j(e.restDecoder),a=new Array(o),h=e.readClient(),g=j(e.restDecoder);n.set(h,{i:0,refs:a});for(let l=0;l<o;l++){let u=e.readInfo();switch(31&u){case 0:{let f=e.readLen();a[l]=new At($(h,g),f),g+=f;break}case 10:{let f=j(e.restDecoder);a[l]=new St($(h,g),f),g+=f;break}default:{let f=(u&192)===0,p=new et($(h,g),null,(u&128)===128?e.readLeftID():null,null,(u&64)===64?e.readRightID():null,f?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,f&&(u&32)===32?e.readString():null,Aa(e,u));a[l]=p,g+=p.length}}}}return n},Ph=(e,t,n)=>{let r=[],i=$t(n.keys()).sort((y,w)=>y-w);if(i.length===0)return null;let o=()=>{if(i.length===0)return null;let y=n.get(i[i.length-1]);for(;y.refs.length===y.i;)if(i.pop(),i.length>0)y=n.get(i[i.length-1]);else return null;return y},a=o();if(a===null)return null;let h=new _s,g=new Map,l=(y,w)=>{let v=g.get(y);(v==null||v>w)&&g.set(y,w)},u=a.refs[a.i++],f=new Map,p=()=>{for(let y of r){let w=y.id.client,v=n.get(w);v?(v.i--,h.clients.set(w,v.refs.slice(v.i)),n.delete(w),v.i=0,v.refs=[]):h.clients.set(w,[y]),i=i.filter(R=>R!==w)}r.length=0};for(;;){if(u.constructor!==St){let w=lt(f,u.id.client,()=>ot(t,u.id.client))-u.id.clock;if(w<0)r.push(u),l(u.id.client,u.id.clock-1),p();else{let v=u.getMissing(e,t);if(v!==null){r.push(u);let R=n.get(v)||{refs:[],i:0};if(R.refs.length===R.i)l(v,ot(t,v)),p();else{u=R.refs[R.i++];continue}}else(w===0||w<u.length)&&(u.integrate(e,w),f.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(a!==null&&a.i<a.refs.length)u=a.refs[a.i++];else{if(a=o(),a===null)break;u=a.refs[a.i++]}}if(h.clients.size>0){let y=new Ot;return ji(y,h,new Map),N(y.restEncoder,0),{missing:g,update:y.toUint8Array()}}return null},$h=(e,t)=>ji(e,t.doc.store,t.beforeState),Pi=(e,t,n,r=new Tt(e))=>tt(t,i=>{i.local=!1;let o=!1,a=i.doc,h=a.store,g=jh(r,a),l=Ph(i,h,g),u=h.pendingStructs;if(u){for(let[p,y]of u.missing)if(y<ot(h,p)){o=!0;break}if(l){for(let[p,y]of l.missing){let w=u.missing.get(p);(w==null||w>y)&&u.missing.set(p,y)}u.update=wr([u.update,l.update])}}else h.pendingStructs=l;let f=Ac(r,i,h);if(h.pendingDs){let p=new Tt(nt(h.pendingDs));j(p.restDecoder);let y=Ac(p,i,h);f&&y?h.pendingDs=wr([f,y]):h.pendingDs=f||y}else h.pendingDs=f;if(o){let p=h.pendingStructs.update;h.pendingStructs=null,Is(i.doc,p)}},n,!1),qh=(e,t,n)=>Pi(e,t,n,new It(e)),Is=(e,t,n,r=Tt)=>{let i=nt(t);Pi(i,e,n,new r(i))},vr=(e,t,n)=>Is(e,t,n,It),Hh=(e,t,n=new Map)=>{ji(e,t.store,n),Kt(e,Fi(t.store))},Hc=(e,t=new Uint8Array([0]),n=new Ot)=>{let r=$i(t);Hh(n,e,r);let i=[n.toUint8Array()];if(e.store.pendingDs&&i.push(e.store.pendingDs),e.store.pendingStructs&&i.push(zi(e.store.pendingStructs.update,t)),i.length>1){if(n.constructor===Jt)return na(i.map((o,a)=>a===0?o:ca(o)));if(n.constructor===Ot)return wr(i)}return i[0]},Ln=(e,t)=>Hc(e,t,new Jt),Wc=e=>{let t=new Map,n=j(e.restDecoder);for(let r=0;r<n;r++){let i=j(e.restDecoder),o=j(e.restDecoder);t.set(i,o)}return t},$i=e=>Wc(new Ye(nt(e))),qi=(e,t)=>(N(e.restEncoder,t.size),$t(t.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{N(e.restEncoder,n),N(e.restEncoder,r)}),e),Wh=(e,t)=>qi(e,Cr(t.store)),Yh=(e,t=new Un)=>(e instanceof Map?qi(t,e):Wh(t,e),t.toUint8Array()),Hi=e=>Yh(e,new Ce),Ti=class{constructor(){this.l=[]}},Tc=()=>new Ti,Uc=(e,t)=>e.l.push(t),Rc=(e,t)=>{let n=e.l,r=n.length;e.l=n.filter(i=>t!==i),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Yc=(e,t,n)=>sr(e.l,[t,n]),ce=class{constructor(t,n){this.client=t,this.clock=n}},$e=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,$=(e,t)=>new ce(e,t),Ic=(e,t)=>{N(e,t.client),N(e,t.clock)},Dc=e=>$(j(e),j(e)),Wi=e=>{for(let[t,n]of e.doc.share.entries())if(n===e)return t;throw wt()},gr=(e,t)=>{for(;t!==null;){if(t.parent===e)return!0;t=t.parent._item}return!1},zh=e=>{let t=[],n=e._start;for(;n;)t.push(n),n=n.right;console.log("Children: ",t),console.log("Children content: ",t.filter(r=>!r.deleted).map(r=>r.content))},Ui=class{constructor(t,n=t.getMap("users")){let r=new Map;this.yusers=n,this.doc=t,this.clients=new Map,this.dss=r;let i=(o,a)=>{let h=o.get("ds"),g=o.get("ids"),l=u=>this.clients.set(u,a);h.observe(u=>{u.changes.added.forEach(f=>{f.content.getContent().forEach(p=>{p instanceof Uint8Array&&this.dss.set(a,We([this.dss.get(a)||Rs(),ae(new Ye(nt(p)))]))})})}),this.dss.set(a,We(h.map(u=>ae(new Ye(nt(u)))))),g.observe(u=>u.changes.added.forEach(f=>f.content.getContent().forEach(l))),g.forEach(l)};n.observe(o=>{o.keysChanged.forEach(a=>i(n.get(a),a))}),n.forEach(i)}setUserMapping(t,n,r,{filter:i=()=>!0}={}){let o=this.yusers,a=o.get(r);a||(a=new Ke,a.set("ids",new Ge),a.set("ds",new Ge),o.set(r,a)),a.get("ids").push([n]),o.observe(h=>{setTimeout(()=>{let g=o.get(r);if(g!==a){a=g,this.clients.forEach((f,p)=>{r===f&&a.get("ids").push([p])});let l=new Ce,u=this.dss.get(r);u&&(Kt(l,u),a.get("ds").push([l.toUint8Array()]))}},0)}),t.on("afterTransaction",h=>{setTimeout(()=>{let g=a.get("ds"),l=h.deleteSet;if(h.local&&l.clients.size>0&&i(h,l)){let u=new Ce;Kt(u,l),g.push([u.toUint8Array()])}})})}getUserByClientId(t){return this.clients.get(t)||null}getUserByDeletedId(t){for(let[n,r]of this.dss.entries())if(tn(r,t))return n;return null}},Rn=class{constructor(t,n,r,i=0){this.type=t,this.tname=n,this.item=r,this.assoc=i}},Gh=e=>{let t={};return e.type&&(t.type=e.type),e.tname&&(t.tname=e.tname),e.item&&(t.item=e.item),e.assoc!=null&&(t.assoc=e.assoc),t},Kh=e=>new Rn(e.type==null?null:$(e.type.client,e.type.clock),e.tname??null,e.item==null?null:$(e.item.client,e.item.clock),e.assoc==null?0:e.assoc),bs=class{constructor(t,n,r=0){this.type=t,this.index=n,this.assoc=r}},Jh=(e,t,n=0)=>new bs(e,t,n),fs=(e,t,n)=>{let r=null,i=null;return e._item===null?i=Wi(e):r=$(e._item.id.client,e._item.id.clock),new Rn(r,i,t,n)},Xh=(e,t,n=0)=>{let r=e._start;if(n<0){if(t===0)return fs(e,null,n);t--}for(;r!==null;){if(!r.deleted&&r.countable){if(r.length>t)return fs(e,$(r.id.client,r.id.clock+t),n);t-=r.length}if(r.right===null&&n<0)return fs(e,r.lastId,n);r=r.right}return fs(e,null,n)},Qh=(e,t)=>{let{type:n,tname:r,item:i,assoc:o}=t;if(i!==null)N(e,0),Ic(e,i);else if(r!==null)re(e,1),vt(e,r);else if(n!==null)re(e,2),Ic(e,n);else throw wt();return Jn(e,o),e},Zh=e=>{let t=G();return Qh(t,e),H(t)},tu=e=>{let t=null,n=null,r=null;switch(j(e)){case 0:r=Dc(e);break;case 1:n=_t(e);break;case 2:t=Dc(e)}let i=ei(e)?Qn(e):0;return new Rn(t,n,r,i)},eu=e=>tu(nt(e)),nu=(e,t)=>{let n=qe(e,t),r=t.clock-n.id.clock;return{item:n,diff:r}},ru=(e,t,n=!0)=>{let r=t.store,i=e.item,o=e.type,a=e.tname,h=e.assoc,g=null,l=0;if(i!==null){if(ot(r,i.client)<=i.clock)return null;let u=n?Mi(r,i):nu(r,i),f=u.item;if(!(f instanceof et))return null;if(g=f.parent,g._item===null||!g._item.deleted){l=f.deleted||!f.countable?0:u.diff+(h>=0?0:1);let p=f.left;for(;p!==null;)!p.deleted&&p.countable&&(l+=p.length),p=p.left}}else{if(a!==null)g=t.get(a);else if(o!==null){if(ot(r,o.client)<=o.clock)return null;let{item:u}=n?Mi(r,o):{item:qe(r,o)};if(u instanceof et&&u.content instanceof Vt)g=u.content.type;else return null}else throw wt();h>=0?l=g._length:l=0}return Jh(g,l,e.assoc)},su=(e,t)=>e===t||e!==null&&t!==null&&e.tname===t.tname&&$e(e.item,t.item)&&$e(e.type,t.type)&&e.assoc===t.assoc,mr=class{constructor(t,n){this.ds=t,this.sv=n}},iu=(e,t)=>{let n=e.ds.clients,r=t.ds.clients,i=e.sv,o=t.sv;if(i.size!==o.size||n.size!==r.size)return!1;for(let[a,h]of i.entries())if(o.get(a)!==h)return!1;for(let[a,h]of n.entries()){let g=r.get(a)||[];if(h.length!==g.length)return!1;for(let l=0;l<h.length;l++){let u=h[l],f=g[l];if(u.clock!==f.clock||u.len!==f.len)return!1}}return!0},zc=(e,t=new Un)=>(Kt(t,e.ds),qi(t,e.sv),t.toUint8Array()),ou=e=>zc(e,new Ce),Gc=(e,t=new ws(nt(e)))=>new mr(ae(t),Wc(t)),cu=e=>Gc(e,new Ye(nt(e))),Yi=(e,t)=>new mr(e,t),au=Yi(Rs(),new Map),lu=e=>Yi(Fi(e.store),Cr(e.store)),_e=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!tn(t.ds,e.id),Ri=(e,t)=>{let n=lt(e.meta,Ri,Nt),r=e.doc.store;n.has(t)||(t.sv.forEach((i,o)=>{i<ot(r,o)&&kt(e,$(o,i))}),He(e,t.ds,i=>{}),n.add(t))},hu=(e,t,n=new ve)=>{if(e.gc)throw new Error("Garbage-collection must be disabled in `originDoc`!");let{sv:r,ds:i}=t,o=new Ot;return e.transact(a=>{let h=0;r.forEach(g=>{g>0&&h++}),N(o.restEncoder,h);for(let[g,l]of r){if(l===0)continue;l<ot(e.store,g)&&kt(a,$(g,l));let u=e.store.clients.get(g)||[],f=Bt(u,l-1);N(o.restEncoder,f+1),o.writeClient(g),N(o.restEncoder,0);for(let p=0;p<=f;p++)u[p].write(o,0)}Kt(o,i)}),Is(n,o.toUint8Array(),"snapshot"),n},uu=(e,t,n=Tt)=>{let r=new n(nt(t)),i=new Xt(r,!1);for(let a=i.curr;a!==null;a=i.next())if((e.sv.get(a.id.client)||0)<a.id.clock+a.length)return!1;let o=We([e.ds,ae(r)]);return $c(e.ds,o)},du=(e,t)=>uu(e,t,It),_s=class{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}},Cr=e=>{let t=new Map;return e.clients.forEach((n,r)=>{let i=n[n.length-1];t.set(r,i.id.clock+i.length)}),t},ot=(e,t)=>{let n=e.clients.get(t);if(n===void 0)return 0;let r=n[n.length-1];return r.id.clock+r.length},Kc=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{let r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw wt()}n.push(t)},Bt=(e,t)=>{let n=0,r=e.length-1,i=e[r],o=i.id.clock;if(o===t)return r;let a=pt(t/(o+i.length-1)*r);for(;n<=r;){if(i=e[a],o=i.id.clock,o<=t){if(t<o+i.length)return a;n=a+1}else r=a-1;a=pt((n+r)/2)}throw wt()},fu=(e,t)=>{let n=e.clients.get(t.client);return n[Bt(n,t.clock)]},qe=fu,Ii=(e,t,n)=>{let r=Bt(t,n),i=t[r];return i.id.clock<n&&i instanceof et?(t.splice(r+1,0,Us(e,i,n-i.id.clock)),r+1):r},kt=(e,t)=>{let n=e.doc.store.clients.get(t.client);return n[Ii(e,n,t.clock)]},Di=(e,t,n)=>{let r=t.clients.get(n.client),i=Bt(r,n.clock),o=r[i];return n.clock!==o.id.clock+o.length-1&&o.constructor!==At&&r.splice(i+1,0,Us(e,o,n.clock-o.id.clock+1)),o},pu=(e,t,n)=>{let r=e.clients.get(t.id.client);r[Bt(r,t.id.clock)]=n},Jc=(e,t,n,r,i)=>{if(r===0)return;let o=n+r,a=Ii(e,t,n),h;do h=t[a++],o<h.id.clock+h.length&&Ii(e,t,o),i(h);while(a<t.length&&t[a].id.clock<o)},xs=class{constructor(t,n,r){this.doc=t,this.deleteSet=new Ee,this.beforeState=Cr(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}},Oc=(e,t)=>t.deleteSet.clients.size===0&&!xo(t.afterState,(n,r)=>t.beforeState.get(r)!==n)?!1:(Vi(t.deleteSet),$h(e,t),Kt(e,t.deleteSet),!0),Lc=(e,t,n)=>{let r=t._item;(r===null||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&lt(e.changed,t,Nt).add(n)},ms=(e,t)=>{let n=e[t],r=e[t-1],i=t;for(;i>0;n=r,r=e[--i-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof et&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}let o=t-i;return o&&e.splice(t+1-o,o),o},Xc=(e,t,n)=>{for(let[r,i]of e.clients.entries()){let o=t.clients.get(r);for(let a=i.length-1;a>=0;a--){let h=i[a],g=h.clock+h.len;for(let l=Bt(o,h.clock),u=o[l];l<o.length&&u.id.clock<g;u=o[++l]){let f=o[l];if(h.clock+h.len<=f.id.clock)break;f instanceof et&&f.deleted&&!f.keep&&n(f)&&f.gc(t,!1)}}}},Qc=(e,t)=>{e.clients.forEach((n,r)=>{let i=t.clients.get(r);for(let o=n.length-1;o>=0;o--){let a=n[o],h=ge(i.length-1,1+Bt(i,a.clock+a.len-1));for(let g=h,l=i[g];g>0&&l.id.clock>=a.clock;l=i[g])g-=1+ms(i,g)}})},gu=(e,t,n)=>{Xc(e,t,n),Qc(e,t)},Zc=(e,t)=>{if(t<e.length){let n=e[t],r=n.doc,i=r.store,o=n.deleteSet,a=n._mergeStructs;try{Vi(o),n.afterState=Cr(n.doc.store),r.emit("beforeObserverCalls",[n,r]);let h=[];n.changed.forEach((g,l)=>h.push(()=>{(l._item===null||!l._item.deleted)&&l._callObserver(n,g)})),h.push(()=>{n.changedParentTypes.forEach((g,l)=>{l._dEH.l.length>0&&(l._item===null||!l._item.deleted)&&(g=g.filter(u=>u.target._item===null||!u.target._item.deleted),g.forEach(u=>{u.currentTarget=l,u._path=null}),g.sort((u,f)=>u.path.length-f.path.length),h.push(()=>{Yc(l._dEH,g,n)}))}),h.push(()=>r.emit("afterTransaction",[n,r])),h.push(()=>{n._needFormattingCleanup&&Bu(n)})}),sr(h,[])}finally{r.gc&&Xc(o,i,r.gcFilter),Qc(o,i),n.afterState.forEach((u,f)=>{let p=n.beforeState.get(f)||0;if(p!==u){let y=i.clients.get(f),w=ee(Bt(y,p),1);for(let v=y.length-1;v>=w;)v-=1+ms(y,v)}});for(let u=a.length-1;u>=0;u--){let{client:f,clock:p}=a[u].id,y=i.clients.get(f),w=Bt(y,p);w+1<y.length&&ms(y,w+1)>1||w>0&&ms(y,w)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(ur(je,Ct,"[yjs] ",qt,hr,"Changed the client-id because another client seems to be using it."),r.clientID=qc()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){let u=new Jt;Oc(u,n)&&r.emit("update",[u.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){let u=new Ot;Oc(u,n)&&r.emit("updateV2",[u.toUint8Array(),n.origin,r,n])}let{subdocsAdded:h,subdocsLoaded:g,subdocsRemoved:l}=n;(h.size>0||l.size>0||g.size>0)&&(h.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),l.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:g,added:h,removed:l},r,n]),l.forEach(u=>u.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):Zc(e,t+1)}}},tt=(e,t,n=null,r=!0)=>{let i=e._transactionCleanups,o=!1,a=null;e._transaction===null&&(o=!0,e._transaction=new xs(e,n,r),i.push(e._transaction),i.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{a=t(e._transaction)}finally{if(o){let h=e._transaction===i[0];e._transaction=null,h&&Zc(i,0)}}return a},Oi=class{constructor(t,n){this.insertions=n,this.deletions=t,this.meta=new Map}},Nc=(e,t,n)=>{He(e,n.deletions,r=>{r instanceof et&&t.scope.some(i=>i===e.doc||gr(i,r))&&Qi(r,!1)})},Mc=(e,t,n)=>{let r=null,i=e.doc,o=e.scope;tt(i,h=>{for(;t.length>0&&e.currStackItem===null;){let g=i.store,l=t.pop(),u=new Set,f=[],p=!1;He(h,l.insertions,y=>{if(y instanceof et){if(y.redone!==null){let{item:w,diff:v}=Mi(g,y.id);v>0&&(w=kt(h,$(w.id.client,w.id.clock+v))),y=w}!y.deleted&&o.some(w=>w===h.doc||gr(w,y))&&f.push(y)}}),He(h,l.deletions,y=>{y instanceof et&&o.some(w=>w===h.doc||gr(w,y))&&!tn(l.insertions,y.id)&&u.add(y)}),u.forEach(y=>{p=ka(h,y,u,l.insertions,e.ignoreRemoteMapChanges,e)!==null||p});for(let y=f.length-1;y>=0;y--){let w=f[y];e.deleteFilter(w)&&(w.delete(h),p=!0)}e.currStackItem=p?l:null}h.changed.forEach((g,l)=>{g.has(null)&&l._searchMarker&&(l._searchMarker.length=0)}),r=h},e);let a=e.currStackItem;if(a!=null){let h=r.changedParentTypes;e.emit("stack-item-popped",[{stackItem:a,type:n,changedParentTypes:h,origin:e},e]),e.currStackItem=null}return a},Li=class extends Wt{constructor(t,{captureTimeout:n=500,captureTransaction:r=g=>!0,deleteFilter:i=()=>!0,trackedOrigins:o=new Set([null]),ignoreRemoteMapChanges:a=!1,doc:h=te(t)?t[0].doc:t instanceof ve?t:t.doc}={}){super(),this.scope=[],this.doc=h,this.addToScope(t),this.deleteFilter=i,o.add(this),this.trackedOrigins=o,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=a,this.captureTimeout=n,this.afterTransactionHandler=g=>{if(!this.captureTransaction(g)||!this.scope.some(R=>g.changedParentTypes.has(R)||R===this.doc)||!this.trackedOrigins.has(g.origin)&&(!g.origin||!this.trackedOrigins.has(g.origin.constructor)))return;let l=this.undoing,u=this.redoing,f=l?this.redoStack:this.undoStack;l?this.stopCapturing():u||this.clear(!1,!0);let p=new Ee;g.afterState.forEach((R,m)=>{let _=g.beforeState.get(m)||0,x=R-_;x>0&&pr(p,m,_,x)});let y=bt(),w=!1;if(this.lastChange>0&&y-this.lastChange<this.captureTimeout&&f.length>0&&!l&&!u){let R=f[f.length-1];R.deletions=We([R.deletions,g.deleteSet]),R.insertions=We([R.insertions,p])}else f.push(new Oi(g.deleteSet,p)),w=!0;!l&&!u&&(this.lastChange=y),He(g,g.deleteSet,R=>{R instanceof et&&this.scope.some(m=>m===g.doc||gr(m,R))&&Qi(R,!0)});let v=[{stackItem:f[f.length-1],origin:g.origin,type:l?"redo":"undo",changedParentTypes:g.changedParentTypes},this];w?this.emit("stack-item-added",v):this.emit("stack-item-updated",v)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){let n=new Set(this.scope);t=te(t)?t:[t],t.forEach(r=>{n.has(r)||(n.add(r),(r instanceof ht?r.doc!==this.doc:r!==this.doc)&&Ci("[yjs#509] Not same Y.Doc"),this.scope.push(r))})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,n=!0){(t&&this.canUndo()||n&&this.canRedo())&&this.doc.transact(r=>{t&&(this.undoStack.forEach(i=>Nc(r,this,i)),this.undoStack=[]),n&&(this.redoStack.forEach(i=>Nc(r,this,i)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:n}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let t;try{t=Mc(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){this.redoing=!0;let t;try{t=Mc(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}};function*mu(e){let t=j(e.restDecoder);for(let n=0;n<t;n++){let r=j(e.restDecoder),i=e.readClient(),o=j(e.restDecoder);for(let a=0;a<r;a++){let h=e.readInfo();if(h===10){let g=j(e.restDecoder);yield new St($(i,o),g),o+=g}else if((31&h)!==0){let g=(h&192)===0,l=new et($(i,o),null,(h&128)===128?e.readLeftID():null,null,(h&64)===64?e.readRightID():null,g?e.readParentInfo()?e.readString():e.readLeftID():null,g&&(h&32)===32?e.readString():null,Aa(e,h));yield l,o+=l.length}else{let g=e.readLen();yield new At($(i,o),g),o+=g}}}}var Xt=class{constructor(t,n){this.gen=mu(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===St);return this.curr}},yu=e=>ta(e,It),ta=(e,t=Tt)=>{let n=[],r=new t(nt(e)),i=new Xt(r,!1);for(let a=i.curr;a!==null;a=i.next())n.push(a);ur("Structs: ",n);let o=ae(r);ur("DeleteSet: ",o)},wu=e=>ea(e,It),ea=(e,t=Tt)=>{let n=[],r=new t(nt(e)),i=new Xt(r,!1);for(let o=i.curr;o!==null;o=i.next())n.push(o);return{structs:n,ds:ae(r)}},yr=class{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}},na=e=>wr(e,It,Jt),ra=(e,t=Un,n=Tt)=>{let r=new t,i=new Xt(new n(nt(e)),!1),o=i.curr;if(o!==null){let a=0,h=o.id.client,g=o.id.clock!==0,l=g?0:o.id.clock+o.length;for(;o!==null;o=i.next())h!==o.id.client&&(l!==0&&(a++,N(r.restEncoder,h),N(r.restEncoder,l)),h=o.id.client,l=0,g=o.id.clock!==0),o.constructor===St&&(g=!0),g||(l=o.id.clock+o.length);l!==0&&(a++,N(r.restEncoder,h),N(r.restEncoder,l));let u=G();return N(u,a),Io(u,r.restEncoder),r.restEncoder=u,r.toUint8Array()}else return N(r.restEncoder,0),r.toUint8Array()},bu=e=>ra(e,Ce,It),sa=(e,t=Tt)=>{let n=new Map,r=new Map,i=new Xt(new t(nt(e)),!1),o=i.curr;if(o!==null){let a=o.id.client,h=o.id.clock;for(n.set(a,h);o!==null;o=i.next())a!==o.id.client&&(r.set(a,h),n.set(o.id.client,o.id.clock),a=o.id.client),h=o.id.clock+o.length;r.set(a,h)}return{from:n,to:r}},_u=e=>sa(e,It),xu=(e,t)=>{if(e.constructor===At){let{client:n,clock:r}=e.id;return new At($(n,r+t),e.length-t)}else if(e.constructor===St){let{client:n,clock:r}=e.id;return new St($(n,r+t),e.length-t)}else{let n=e,{client:r,clock:i}=n.id;return new et($(r,i+t),null,$(r,i+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},wr=(e,t=Tt,n=Ot)=>{if(e.length===1)return e[0];let r=e.map(u=>new t(nt(u))),i=r.map(u=>new Xt(u,!0)),o=null,a=new n,h=new yr(a);for(;i=i.filter(p=>p.curr!==null),i.sort((p,y)=>{if(p.curr.id.client===y.curr.id.client){let w=p.curr.id.clock-y.curr.id.clock;return w===0?p.curr.constructor===y.curr.constructor?0:p.curr.constructor===St?1:-1:w}else return y.curr.id.client-p.curr.id.client}),i.length!==0;){let u=i[0],f=u.curr.id.client;if(o!==null){let p=u.curr,y=!1;for(;p!==null&&p.id.clock+p.length<=o.struct.id.clock+o.struct.length&&p.id.client>=o.struct.id.client;)p=u.next(),y=!0;if(p===null||p.id.client!==f||y&&p.id.clock>o.struct.id.clock+o.struct.length)continue;if(f!==o.struct.id.client)xe(h,o.struct,o.offset),o={struct:p,offset:0},u.next();else if(o.struct.id.clock+o.struct.length<p.id.clock)if(o.struct.constructor===St)o.struct.length=p.id.clock+p.length-o.struct.id.clock;else{xe(h,o.struct,o.offset);let w=p.id.clock-o.struct.id.clock-o.struct.length;o={struct:new St($(f,o.struct.id.clock+o.struct.length),w),offset:0}}else{let w=o.struct.id.clock+o.struct.length-p.id.clock;w>0&&(o.struct.constructor===St?o.struct.length-=w:p=xu(p,w)),o.struct.mergeWith(p)||(xe(h,o.struct,o.offset),o={struct:p,offset:0},u.next())}}else o={struct:u.curr,offset:0},u.next();for(let p=u.curr;p!==null&&p.id.client===f&&p.id.clock===o.struct.id.clock+o.struct.length&&p.constructor!==St;p=u.next())xe(h,o.struct,o.offset),o={struct:p,offset:0}}o!==null&&(xe(h,o.struct,o.offset),o=null),Gi(h);let g=r.map(u=>ae(u)),l=We(g);return Kt(a,l),a.toUint8Array()},zi=(e,t,n=Tt,r=Ot)=>{let i=$i(t),o=new r,a=new yr(o),h=new n(nt(e)),g=new Xt(h,!1);for(;g.curr;){let u=g.curr,f=u.id.client,p=i.get(f)||0;if(g.curr.constructor===St){g.next();continue}if(u.id.clock+u.length>p)for(xe(a,u,ee(p-u.id.clock,0)),g.next();g.curr&&g.curr.id.client===f;)xe(a,g.curr,0),g.next();else for(;g.curr&&g.curr.id.client===f&&g.curr.id.clock+g.curr.length<=p;)g.next()}Gi(a);let l=ae(h);return Kt(o,l),o.toUint8Array()},Su=(e,t)=>zi(e,t,It,Jt),ia=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:H(e.encoder.restEncoder)}),e.encoder.restEncoder=G(),e.written=0)},xe=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&ia(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),N(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},Gi=e=>{ia(e);let t=e.encoder.restEncoder;N(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){let r=e.clientStructs[n];N(t,r.written),mn(t,r.restEncoder)}},Ds=(e,t,n,r)=>{let i=new n(nt(e)),o=new Xt(i,!1),a=new r,h=new yr(a);for(let l=o.curr;l!==null;l=o.next())xe(h,t(l),0);Gi(h);let g=ae(i);return Kt(a,g),a.toUint8Array()},oa=({formatting:e=!0,subdocs:t=!0,yxml:n=!0}={})=>{let r=0,i=at(),o=at(),a=at(),h=at();return h.set(null,null),g=>{switch(g.constructor){case At:case St:return g;case et:{let l=g,u=l.content;switch(u.constructor){case On:break;case Vt:{if(n){let f=u.type;f instanceof Xe&&(f.nodeName=lt(o,f.nodeName,()=>"node-"+r)),f instanceof Sr&&(f.hookName=lt(o,f.hookName,()=>"hook-"+r))}break}case ke:{let f=u;f.arr=f.arr.map(()=>r);break}case Qe:{let f=u;f.content=new Uint8Array([r]);break}case Ze:{let f=u;t&&(f.opts={},f.doc.guid=r+"");break}case le:{let f=u;f.embed={};break}case ut:{let f=u;e&&(f.key=lt(a,f.key,()=>r+""),f.value=lt(h,f.value,()=>({i:r})));break}case Er:{let f=u;f.arr=f.arr.map(()=>r);break}case Ht:{let f=u;f.str=Vr(r%10+"",f.str.length);break}default:wt()}return l.parentSub&&(l.parentSub=lt(i,l.parentSub,()=>r+"")),r++,g}default:wt()}}},Eu=(e,t)=>Ds(e,oa(t),It,Jt),vu=(e,t)=>Ds(e,oa(t),Tt,Ot),Cu=e=>Ds(e,hi,It,Ot),ca=e=>Ds(e,hi,Tt,Jt),Bc="You must not compute changes after the event-handler fired.",ze=class{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=ku(this.currentTarget,this.target))}deletes(t){return tn(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw gt(Bc);let t=new Map,n=this.target;this.transaction.changed.get(n).forEach(i=>{if(i!==null){let o=n._map.get(i),a,h;if(this.adds(o)){let g=o.left;for(;g!==null&&this.adds(g);)g=g.left;if(this.deletes(o))if(g!==null&&this.deletes(g))a="delete",h=Nr(g.content.getContent());else return;else g!==null&&this.deletes(g)?(a="update",h=Nr(g.content.getContent())):(a="add",h=void 0)}else if(this.deletes(o))a="delete",h=Nr(o.content.getContent());else return;t.set(i,{action:a,oldValue:h})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw gt(Bc);let n=this.target,r=Nt(),i=Nt(),o=[];if(t={added:r,deleted:i,delta:o,keys:this.keys},this.transaction.changed.get(n).has(null)){let h=null,g=()=>{h&&o.push(h)};for(let l=n._start;l!==null;l=l.right)l.deleted?this.deletes(l)&&!this.adds(l)&&((h===null||h.delete===void 0)&&(g(),h={delete:0}),h.delete+=l.length,i.add(l)):this.adds(l)?((h===null||h.insert===void 0)&&(g(),h={insert:[]}),h.insert=h.insert.concat(l.content.getContent()),r.add(l)):((h===null||h.retain===void 0)&&(g(),h={retain:0}),h.retain+=l.length);h!==null&&h.retain===void 0&&g()}this._changes=t}return t}},ku=(e,t)=>{let n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let r=0,i=t._item.parent._start;for(;i!==t._item&&i!==null;)!i.deleted&&i.countable&&(r+=i.length),i=i.right;n.unshift(r)}t=t._item.parent}return n},Et=()=>{Ci("Invalid access: Add Yjs type to a document before reading data.")},aa=80,Ki=0,Ni=class{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=Ki++}},Au=e=>{e.timestamp=Ki++},la=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=Ki++},Tu=(e,t,n)=>{if(e.length>=aa){let r=e.reduce((i,o)=>i.timestamp<o.timestamp?i:o);return la(r,t,n),r}else{let r=new Ni(t,n);return e.push(r),r}},Os=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;let n=e._searchMarker.length===0?null:e._searchMarker.reduce((o,a)=>Ie(t-o.index)<Ie(t-a.index)?o:a),r=e._start,i=0;for(n!==null&&(r=n.p,i=n.index,Au(n));r.right!==null&&i<t;){if(!r.deleted&&r.countable){if(t<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>t;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return n!==null&&Ie(n.index-i)<r.parent.length/aa?(la(n,r,i),n):Tu(e._searchMarker,r,i)},br=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){let i=e[r];if(n>0){let o=i.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)o=o.left,o&&!o.deleted&&o.countable&&(i.index-=o.length);if(o===null||o.marker===!0){e.splice(r,1);continue}i.p=o,o.marker=!0}(t<i.index||n>0&&t===i.index)&&(i.index=ee(t,i.index+n))}},Uu=e=>{e.doc??Et();let t=e._start,n=[];for(;t;)n.push(t),t=t.right;return n},Ls=(e,t,n)=>{let r=e,i=t.changedParentTypes;for(;lt(i,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;Yc(r._eH,n,t)},ht=class{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Tc(),this._dEH=Tc(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw Dt()}clone(){throw Dt()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){Uc(this._eH,t)}observeDeep(t){Uc(this._dEH,t)}unobserve(t){Rc(this._eH,t)}unobserveDeep(t){Rc(this._dEH,t)}toJSON(){}},ha=(e,t,n)=>{e.doc??Et(),t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t,i=[],o=e._start;for(;o!==null&&r>0;){if(o.countable&&!o.deleted){let a=o.content.getContent();if(a.length<=t)t-=a.length;else{for(let h=t;h<a.length&&r>0;h++)i.push(a[h]),r--;t=0}}o=o.right}return i},ua=e=>{e.doc??Et();let t=[],n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){let r=n.content.getContent();for(let i=0;i<r.length;i++)t.push(r[i])}n=n.right}return t},Ru=(e,t)=>{let n=[],r=e._start;for(;r!==null;){if(r.countable&&_e(r,t)){let i=r.content.getContent();for(let o=0;o<i.length;o++)n.push(i[o])}r=r.right}return n},_r=(e,t)=>{let n=0,r=e._start;for(e.doc??Et();r!==null;){if(r.countable&&!r.deleted){let i=r.content.getContent();for(let o=0;o<i.length;o++)t(i[o],n++,e)}r=r.right}},da=(e,t)=>{let n=[];return _r(e,(r,i)=>{n.push(t(r,i,e))}),n},Iu=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}let i=n[r++];return n.length<=r&&(n=null),{done:!1,value:i}}}},fa=(e,t)=>{e.doc??Et();let n=Os(e,t),r=e._start;for(n!==null&&(r=n.p,t-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Ss=(e,t,n,r)=>{let i=n,o=e.doc,a=o.clientID,h=o.store,g=n===null?t._start:n.right,l=[],u=()=>{l.length>0&&(i=new et($(a,ot(h,a)),i,i&&i.lastId,g,g&&g.id,t,null,new ke(l)),i.integrate(e,0),l=[])};r.forEach(f=>{if(f===null)l.push(f);else switch(f.constructor){case Number:case Object:case Boolean:case Array:case String:l.push(f);break;default:switch(u(),f.constructor){case Uint8Array:case ArrayBuffer:i=new et($(a,ot(h,a)),i,i&&i.lastId,g,g&&g.id,t,null,new Qe(new Uint8Array(f))),i.integrate(e,0);break;case ve:i=new et($(a,ot(h,a)),i,i&&i.lastId,g,g&&g.id,t,null,new Ze(f)),i.integrate(e,0);break;default:if(f instanceof ht)i=new et($(a,ot(h,a)),i,i&&i.lastId,g,g&&g.id,t,null,new Vt(f)),i.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},pa=()=>gt("Length exceeded!"),ga=(e,t,n,r)=>{if(n>t._length)throw pa();if(n===0)return t._searchMarker&&br(t._searchMarker,n,r.length),Ss(e,t,null,r);let i=n,o=Os(t,n),a=t._start;for(o!==null&&(a=o.p,n-=o.index,n===0&&(a=a.prev,n+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(n<=a.length){n<a.length&&kt(e,$(a.id.client,a.id.clock+n));break}n-=a.length}return t._searchMarker&&br(t._searchMarker,i,r.length),Ss(e,t,a,r)},Du=(e,t,n)=>{let i=(t._searchMarker||[]).reduce((o,a)=>a.index>o.index?a:o,{index:0,p:t._start}).p;if(i)for(;i.right;)i=i.right;return Ss(e,t,i,n)},ma=(e,t,n,r)=>{if(r===0)return;let i=n,o=r,a=Os(t,n),h=t._start;for(a!==null&&(h=a.p,n-=a.index);h!==null&&n>0;h=h.right)!h.deleted&&h.countable&&(n<h.length&&kt(e,$(h.id.client,h.id.clock+n)),n-=h.length);for(;r>0&&h!==null;)h.deleted||(r<h.length&&kt(e,$(h.id.client,h.id.clock+r)),h.delete(e),r-=h.length),h=h.right;if(r>0)throw pa();t._searchMarker&&br(t._searchMarker,i,-o+r)},Es=(e,t,n)=>{let r=t._map.get(n);r!==void 0&&r.delete(e)},Ji=(e,t,n,r)=>{let i=t._map.get(n)||null,o=e.doc,a=o.clientID,h;if(r==null)h=new ke([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:h=new ke([r]);break;case Uint8Array:h=new Qe(r);break;case ve:h=new Ze(r);break;default:if(r instanceof ht)h=new Vt(r);else throw new Error("Unexpected content type")}new et($(a,ot(o.store,a)),i,i&&i.lastId,null,null,t,n,h).integrate(e,0)},Xi=(e,t)=>{e.doc??Et();let n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},ya=e=>{let t={};return e.doc??Et(),e._map.forEach((n,r)=>{n.deleted||(t[r]=n.content.getContent()[n.length-1])}),t},wa=(e,t)=>{e.doc??Et();let n=e._map.get(t);return n!==void 0&&!n.deleted},Ou=(e,t,n)=>{let r=e._map.get(t)||null;for(;r!==null&&(!n.sv.has(r.id.client)||r.id.clock>=(n.sv.get(r.id.client)||0));)r=r.left;return r!==null&&_e(r,n)?r.content.getContent()[r.length-1]:void 0},ba=(e,t)=>{let n={};return e._map.forEach((r,i)=>{let o=r;for(;o!==null&&(!t.sv.has(o.id.client)||o.id.clock>=(t.sv.get(o.id.client)||0));)o=o.left;o!==null&&_e(o,t)&&(n[i]=o.content.getContent()[o.length-1])}),n},ps=e=>(e.doc??Et(),vc(e._map.entries(),t=>!t[1].deleted)),vs=class extends ze{},Ge=class e extends ht{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){let n=new e;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new e}clone(){let t=new e;return t.insert(0,this.toArray().map(n=>n instanceof ht?n.clone():n)),t}get length(){return this.doc??Et(),this._length}_callObserver(t,n){super._callObserver(t,n),Ls(this,t,new vs(this,t))}insert(t,n){this.doc!==null?tt(this.doc,r=>{ga(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?tt(this.doc,n=>{Du(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?tt(this.doc,r=>{ma(r,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return fa(this,t)}toArray(){return ua(this)}slice(t=0,n=this.length){return ha(this,t,n)}toJSON(){return this.map(t=>t instanceof ht?t.toJSON():t)}map(t){return da(this,t)}forEach(t){_r(this,t)}[Symbol.iterator](){return Iu(this)}_write(t){t.writeTypeRef(td)}},Lu=e=>new Ge,Cs=class extends ze{constructor(t,n,r){super(t,n),this.keysChanged=r}},Ke=class e extends ht{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new e}clone(){let t=new e;return this.forEach((n,r)=>{t.set(r,n instanceof ht?n.clone():n)}),t}_callObserver(t,n){Ls(this,t,new Cs(this,t,n))}toJSON(){this.doc??Et();let t={};return this._map.forEach((n,r)=>{if(!n.deleted){let i=n.content.getContent()[n.length-1];t[r]=i instanceof ht?i.toJSON():i}}),t}get size(){return[...ps(this)].length}keys(){return ds(ps(this),t=>t[0])}values(){return ds(ps(this),t=>t[1].content.getContent()[t[1].length-1])}entries(){return ds(ps(this),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this.doc??Et(),this._map.forEach((n,r)=>{n.deleted||t(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?tt(this.doc,n=>{Es(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?tt(this.doc,r=>{Ji(r,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return Xi(this,t)}has(t){return wa(this,t)}clear(){this.doc!==null?tt(this.doc,t=>{this.forEach(function(n,r,i){Es(t,i,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(ed)}},Nu=e=>new Ke,Se=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&ai(e,t),xr=class{constructor(t,n,r,i){this.left=t,this.right=n,this.index=r,this.currentAttributes=i}forward(){this.right===null&&wt(),this.right.content.constructor===ut?this.right.deleted||Nn(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}},Vc=(e,t,n)=>{for(;t.right!==null&&n>0;)t.right.content.constructor===ut?t.right.deleted||Nn(t.currentAttributes,t.right.content):t.right.deleted||(n<t.right.length&&kt(e,$(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length),t.left=t.right,t.right=t.right.right;return t},gs=(e,t,n,r)=>{let i=new Map,o=r?Os(t,n):null;if(o){let a=new xr(o.p.left,o.p,o.index,i);return Vc(e,a,n-o.index)}else{let a=new xr(null,t._start,0,i);return Vc(e,a,n)}},_a=(e,t,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===ut&&Se(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();let i=e.doc,o=i.clientID;r.forEach((a,h)=>{let g=n.left,l=n.right,u=new et($(o,ot(i.store,o)),g,g&&g.lastId,l,l&&l.id,t,null,new ut(h,a));u.integrate(e,0),n.right=u,n.forward()})},Nn=(e,t)=>{let{key:n,value:r}=t;r===null?e.delete(n):e.set(n,r)},xa=(e,t)=>{for(;e.right!==null;){if(!(e.right.deleted||e.right.content.constructor===ut&&Se(t[e.right.content.key]??null,e.right.content.value)))break;e.forward()}},Sa=(e,t,n,r)=>{let i=e.doc,o=i.clientID,a=new Map;for(let h in r){let g=r[h],l=n.currentAttributes.get(h)??null;if(!Se(l,g)){a.set(h,l);let{left:u,right:f}=n;n.right=new et($(o,ot(i.store,o)),u,u&&u.lastId,f,f&&f.id,t,null,new ut(h,g)),n.right.integrate(e,0),n.forward()}}return a},ki=(e,t,n,r,i)=>{n.currentAttributes.forEach((p,y)=>{i[y]===void 0&&(i[y]=null)});let o=e.doc,a=o.clientID;xa(n,i);let h=Sa(e,t,n,i),g=r.constructor===String?new Ht(r):r instanceof ht?new Vt(r):new le(r),{left:l,right:u,index:f}=n;t._searchMarker&&br(t._searchMarker,n.index,g.getLength()),u=new et($(a,ot(o.store,a)),l,l&&l.lastId,u,u&&u.id,t,null,g),u.integrate(e,0),n.right=u,n.index=f,n.forward(),_a(e,t,n,h)},Fc=(e,t,n,r,i)=>{let o=e.doc,a=o.clientID;xa(n,i);let h=Sa(e,t,n,i);t:for(;n.right!==null&&(r>0||h.size>0&&(n.right.deleted||n.right.content.constructor===ut));){if(!n.right.deleted)switch(n.right.content.constructor){case ut:{let{key:g,value:l}=n.right.content,u=i[g];if(u!==void 0){if(Se(u,l))h.delete(g);else{if(r===0)break t;h.set(g,l)}n.right.delete(e)}else n.currentAttributes.set(g,l);break}default:r<n.right.length&&kt(e,$(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let g="";for(;r>0;r--)g+=`
`;n.right=new et($(a,ot(o.store,a)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new Ht(g)),n.right.integrate(e,0),n.forward()}_a(e,t,n,h)},Ea=(e,t,n,r,i)=>{let o=t,a=at();for(;o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===ut){let l=o.content;a.set(l.key,l)}o=o.right}let h=0,g=!1;for(;t!==o;){if(n===t&&(g=!0),!t.deleted){let l=t.content;if(l.constructor===ut){let{key:u,value:f}=l,p=r.get(u)??null;(a.get(u)!==l||p===f)&&(t.delete(e),h++,!g&&(i.get(u)??null)===f&&p!==f&&(p===null?i.delete(u):i.set(u,p))),!g&&!t.deleted&&Nn(i,l)}}t=t.right}return h},Mu=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;let n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===ut){let r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},va=e=>{let t=0;return tt(e.doc,n=>{let r=e._start,i=e._start,o=at(),a=Or(o);for(;i;)i.deleted===!1&&(i.content.constructor===ut?Nn(a,i.content):(t+=Ea(n,r,i,o,a),o=Or(a),r=i)),i=i.right}),t},Bu=e=>{let t=new Set,n=e.doc;for(let[r,i]of e.afterState.entries()){let o=e.beforeState.get(r)||0;i!==o&&Jc(e,n.store.clients.get(r),o,i,a=>{!a.deleted&&a.content.constructor===ut&&a.constructor!==At&&t.add(a.parent)})}tt(n,r=>{He(e,e.deleteSet,i=>{if(i instanceof At||!i.parent._hasFormatting||t.has(i.parent))return;let o=i.parent;i.content.constructor===ut?t.add(o):Mu(r,i)});for(let i of t)va(i)})},jc=(e,t,n)=>{let r=n,i=Or(t.currentAttributes),o=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case Vt:case le:case Ht:n<t.right.length&&kt(e,$(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}o&&Ea(e,o,t.right,i,t.currentAttributes);let a=(t.left||t.right).parent;return a._searchMarker&&br(a._searchMarker,t.index,-r+n),t},ks=class extends ze{constructor(t,n,r){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){let t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){let t=this.target.doc,n=[];tt(t,r=>{let i=new Map,o=new Map,a=this.target._start,h=null,g={},l="",u=0,f=0,p=()=>{if(h!==null){let y=null;switch(h){case"delete":f>0&&(y={delete:f}),f=0;break;case"insert":(typeof l=="object"||l.length>0)&&(y={insert:l},i.size>0&&(y.attributes={},i.forEach((w,v)=>{w!==null&&(y.attributes[v]=w)}))),l="";break;case"retain":u>0&&(y={retain:u},Yo(g)||(y.attributes=qo({},g))),u=0;break}y&&n.push(y),h=null}};for(;a!==null;){switch(a.content.constructor){case Vt:case le:this.adds(a)?this.deletes(a)||(p(),h="insert",l=a.content.getContent()[0],p()):this.deletes(a)?(h!=="delete"&&(p(),h="delete"),f+=1):a.deleted||(h!=="retain"&&(p(),h="retain"),u+=1);break;case Ht:this.adds(a)?this.deletes(a)||(h!=="insert"&&(p(),h="insert"),l+=a.content.str):this.deletes(a)?(h!=="delete"&&(p(),h="delete"),f+=a.length):a.deleted||(h!=="retain"&&(p(),h="retain"),u+=a.length);break;case ut:{let{key:y,value:w}=a.content;if(this.adds(a)){if(!this.deletes(a)){let v=i.get(y)??null;Se(v,w)?w!==null&&a.delete(r):(h==="retain"&&p(),Se(w,o.get(y)??null)?delete g[y]:g[y]=w)}}else if(this.deletes(a)){o.set(y,w);let v=i.get(y)??null;Se(v,w)||(h==="retain"&&p(),g[y]=v)}else if(!a.deleted){o.set(y,w);let v=g[y];v!==void 0&&(Se(v,w)?v!==null&&a.delete(r):(h==="retain"&&p(),w===null?delete g[y]:g[y]=w))}a.deleted||(h==="insert"&&p(),Nn(i,a.content));break}}a=a.right}for(p();n.length>0;){let y=n[n.length-1];if(y.retain!==void 0&&y.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}},In=class e extends ht{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Et(),this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new e}clone(){let t=new e;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);let r=new ks(this,t,n);Ls(this,t,r),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){this.doc??Et();let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===Ht&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?tt(this.doc,r=>{let i=new xr(null,this._start,0,new Map);for(let o=0;o<t.length;o++){let a=t[o];if(a.insert!==void 0){let h=!n&&typeof a.insert=="string"&&o===t.length-1&&i.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof h!="string"||h.length>0)&&ki(r,this,i,h,a.attributes||{})}else a.retain!==void 0?Fc(r,this,i,a.retain,a.attributes||{}):a.delete!==void 0&&jc(r,i,a.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,r){this.doc??Et();let i=[],o=new Map,a=this.doc,h="",g=this._start;function l(){if(h.length>0){let f={},p=!1;o.forEach((w,v)=>{p=!0,f[v]=w});let y={insert:h};p&&(y.attributes=f),i.push(y),h=""}}let u=()=>{for(;g!==null;){if(_e(g,t)||n!==void 0&&_e(g,n))switch(g.content.constructor){case Ht:{let f=o.get("ychange");t!==void 0&&!_e(g,t)?(f===void 0||f.user!==g.id.client||f.type!=="removed")&&(l(),o.set("ychange",r?r("removed",g.id):{type:"removed"})):n!==void 0&&!_e(g,n)?(f===void 0||f.user!==g.id.client||f.type!=="added")&&(l(),o.set("ychange",r?r("added",g.id):{type:"added"})):f!==void 0&&(l(),o.delete("ychange")),h+=g.content.str;break}case Vt:case le:{l();let f={insert:g.content.getContent()[0]};if(o.size>0){let p={};f.attributes=p,o.forEach((y,w)=>{p[w]=y})}i.push(f);break}case ut:_e(g,t)&&(l(),Nn(o,g.content));break}g=g.right}l()};return t||n?tt(a,f=>{t&&Ri(f,t),n&&Ri(f,n),u()},"cleanup"):u(),i}insert(t,n,r){if(n.length<=0)return;let i=this.doc;i!==null?tt(i,o=>{let a=gs(o,this,t,!r);r||(r={},a.currentAttributes.forEach((h,g)=>{r[g]=h})),ki(o,this,a,n,r)}):this._pending.push(()=>this.insert(t,n,r))}insertEmbed(t,n,r){let i=this.doc;i!==null?tt(i,o=>{let a=gs(o,this,t,!r);ki(o,this,a,n,r||{})}):this._pending.push(()=>this.insertEmbed(t,n,r||{}))}delete(t,n){if(n===0)return;let r=this.doc;r!==null?tt(r,i=>{jc(i,gs(i,this,t,!0),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,r){if(n===0)return;let i=this.doc;i!==null?tt(i,o=>{let a=gs(o,this,t,!1);a.right!==null&&Fc(o,this,a,n,r)}):this._pending.push(()=>this.format(t,n,r))}removeAttribute(t){this.doc!==null?tt(this.doc,n=>{Es(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?tt(this.doc,r=>{Ji(r,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return Xi(this,t)}getAttributes(){return ya(this)}_write(t){t.writeTypeRef(nd)}},Vu=e=>new In,dr=class{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0,t.doc??Et()}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===Xe||n.constructor===Je)&&n._start!==null)t=n._start;else for(;t!==null;){let r=t.next;if(r!==null){t=r;break}else t.parent===this._root?t=null:t=t.parent._item}while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}},Je=class e extends ht{constructor(){super(),this._prelimContent=[]}get firstChild(){let t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new e}clone(){let t=new e;return t.insert(0,this.toArray().map(n=>n instanceof ht?n.clone():n)),t}get length(){return this.doc??Et(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new dr(this,t)}querySelector(t){t=t.toUpperCase();let r=new dr(this,i=>i.nodeName&&i.nodeName.toUpperCase()===t).next();return r.done?null:r.value}querySelectorAll(t){return t=t.toUpperCase(),$t(new dr(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){Ls(this,t,new As(this,n,t))}toString(){return da(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},r){let i=t.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),_r(this,o=>{i.insertBefore(o.toDOM(t,n,r),null)}),i}insert(t,n){this.doc!==null?tt(this.doc,r=>{ga(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)tt(this.doc,r=>{let i=t&&t instanceof ht?t._item:t;Ss(r,this,i,n)});else{let r=this._prelimContent,i=t===null?0:r.findIndex(o=>o===t)+1;if(i===0&&t!==null)throw gt("Reference item not found");r.splice(i,0,...n)}}delete(t,n=1){this.doc!==null?tt(this.doc,r=>{ma(r,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return ua(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return fa(this,t)}slice(t=0,n=this.length){return ha(this,t,n)}forEach(t){_r(this,t)}_write(t){t.writeTypeRef(sd)}},Fu=e=>new Je,Xe=class e extends Je{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){let t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){let t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new e(this.nodeName)}clone(){let t=new e(this.nodeName),n=this.getAttributes();return Ho(n,(r,i)=>{t.setAttribute(i,r)}),t.insert(0,this.toArray().map(r=>r instanceof ht?r.clone():r)),t}toString(){let t=this.getAttributes(),n=[],r=[];for(let h in t)r.push(h);r.sort();let i=r.length;for(let h=0;h<i;h++){let g=r[h];n.push(g+'="'+t[g]+'"')}let o=this.nodeName.toLocaleLowerCase(),a=n.length>0?" "+n.join(" "):"";return`<${o}${a}>${super.toString()}</${o}>`}removeAttribute(t){this.doc!==null?tt(this.doc,n=>{Es(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?tt(this.doc,r=>{Ji(r,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return Xi(this,t)}hasAttribute(t){return wa(this,t)}getAttributes(t){return t?ba(this,t):ya(this)}toDOM(t=document,n={},r){let i=t.createElement(this.nodeName),o=this.getAttributes();for(let a in o){let h=o[a];typeof h=="string"&&i.setAttribute(a,h)}return _r(this,a=>{i.appendChild(a.toDOM(t,n,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(t){t.writeTypeRef(rd),t.writeKey(this.nodeName)}},ju=e=>new Xe(e.readKey()),As=class extends ze{constructor(t,n,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}},Sr=class e extends Ke{constructor(t){super(),this.hookName=t}_copy(){return new e(this.hookName)}clone(){let t=new e(this.hookName);return this.forEach((n,r)=>{t.set(r,n)}),t}toDOM(t=document,n={},r){let i=n[this.hookName],o;return i!==void 0?o=i.createDom(this):o=document.createElement(this.hookName),o.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(o,this),o}_write(t){t.writeTypeRef(id),t.writeKey(this.hookName)}},Pu=e=>new Sr(e.readKey()),Ts=class e extends In{get nextSibling(){let t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){let t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new e}clone(){let t=new e;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,r){let i=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(t=>{let n=[];for(let i in t.attributes){let o=[];for(let a in t.attributes[i])o.push({key:a,value:t.attributes[i][a]});o.sort((a,h)=>a.key<h.key?-1:1),n.push({nodeName:i,attrs:o})}n.sort((i,o)=>i.nodeName<o.nodeName?-1:1);let r="";for(let i=0;i<n.length;i++){let o=n[i];r+=`<${o.nodeName}`;for(let a=0;a<o.attrs.length;a++){let h=o.attrs[a];r+=` ${h.key}="${h.value}"`}r+=">"}r+=t.insert;for(let i=n.length-1;i>=0;i--)r+=`</${n[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(od)}},$u=e=>new Ts,Dn=class{constructor(t,n){this.id=t,this.length=n}get deleted(){throw Dt()}mergeWith(t){return!1}write(t,n,r){throw Dt()}integrate(t,n){throw Dt()}},qu=0,At=class extends Dn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),Kc(t.doc.store,this)}write(t,n){t.writeInfo(qu),t.writeLen(this.length-n)}getMissing(t,n){return null}},Qe=class e{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new e(this.content)}splice(t){throw Dt()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}},Hu=e=>new Qe(e.readBuf()),On=class e{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new e(this.len)}splice(t){let n=new e(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){pr(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}},Wu=e=>new On(e.readLen()),Ca=(e,t)=>new ve({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1}),Ze=class e{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;let n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new e(Ca(this.doc.guid,this.opts))}splice(t){throw Dt()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}},Yu=e=>new Ze(Ca(e.readString(),e.readAny())),le=class e{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new e(this.embed)}splice(t){throw Dt()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}},zu=e=>new le(e.readJSON()),ut=class e{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new e(this.key,this.value)}splice(t){throw Dt()}mergeWith(t){return!1}integrate(t,n){let r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}},Gu=e=>new ut(e.readKey(),e.readJSON()),Er=class e{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new e(this.arr)}splice(t){let n=new e(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){let r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){let o=this.arr[i];t.writeString(o===void 0?"undefined":JSON.stringify(o))}}getRef(){return 2}},Ku=e=>{let t=e.readLen(),n=[];for(let r=0;r<t;r++){let i=e.readString();i==="undefined"?n.push(void 0):n.push(JSON.parse(i))}return new Er(n)},Ju=Ve("node_env")==="development",ke=class e{constructor(t){this.arr=t,Ju&&li(t)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new e(this.arr)}splice(t){let n=new e(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){let r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){let o=this.arr[i];t.writeAny(o)}}getRef(){return 8}},Xu=e=>{let t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new ke(n)},Ht=class e{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new e(this.str)}splice(t){let n=new e(this.str.slice(t));this.str=this.str.slice(0,t);let r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",n.str="\uFFFD"+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}},Qu=e=>new Ht(e.readString()),Zu=[Lu,Nu,Vu,ju,Fu,Pu,$u],td=0,ed=1,nd=2,rd=3,sd=4,id=5,od=6,Vt=class e{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new e(this.type._copy())}splice(t){throw Dt()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(t.beforeState.get(n.id.client)||0)&&t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(t.beforeState.get(r.id.client)||0)&&t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}},cd=e=>new Vt(Zu[e.readTypeRef()](e)),Mi=(e,t)=>{let n=t,r=0,i;do r>0&&(n=$(n.client,n.clock+r)),i=qe(e,n),r=n.clock-i.id.clock,n=i.redone;while(n!==null&&i instanceof et);return{item:i,diff:r}},Qi=(e,t)=>{for(;e!==null&&e.keep!==t;)e.keep=t,e=e.parent._item},Us=(e,t,n)=>{let{client:r,clock:i}=t.id,o=new et($(r,i+n),t,$(r,i+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&o.markDeleted(),t.keep&&(o.keep=!0),t.redone!==null&&(o.redone=$(t.redone.client,t.redone.clock+n)),t.right=o,o.right!==null&&(o.right.left=o),e._mergeStructs.push(o),o.parentSub!==null&&o.right===null&&o.parent._map.set(o.parentSub,o),t.length=n,o},Pc=(e,t)=>Wn(e,n=>tn(n.deletions,t)),ka=(e,t,n,r,i,o)=>{let a=e.doc,h=a.store,g=a.clientID,l=t.redone;if(l!==null)return kt(e,l);let u=t.parent._item,f=null,p;if(u!==null&&u.deleted===!0){if(u.redone===null&&(!n.has(u)||ka(e,u,n,r,i,o)===null))return null;for(;u.redone!==null;)u=kt(e,u.redone)}let y=u===null?t.parent:u.content.type;if(t.parentSub===null){for(f=t.left,p=t;f!==null;){let m=f;for(;m!==null&&m.parent._item!==u;)m=m.redone===null?null:kt(e,m.redone);if(m!==null&&m.parent._item===u){f=m;break}f=f.left}for(;p!==null;){let m=p;for(;m!==null&&m.parent._item!==u;)m=m.redone===null?null:kt(e,m.redone);if(m!==null&&m.parent._item===u){p=m;break}p=p.right}}else if(p=null,t.right&&!i){for(f=t;f!==null&&f.right!==null&&(f.right.redone||tn(r,f.right.id)||Pc(o.undoStack,f.right.id)||Pc(o.redoStack,f.right.id));)for(f=f.right;f.redone;)f=kt(e,f.redone);if(f&&f.right!==null)return null}else f=y._map.get(t.parentSub)||null;let w=ot(h,g),v=$(g,w),R=new et(v,f,f&&f.lastId,p,p&&p.id,y,t.parentSub,t.content.copy());return t.redone=v,Qi(R,!0),R.integrate(e,0),R},et=class e extends Dn{constructor(t,n,r,i,o,a,h,g){super(t,g.getLength()),this.origin=r,this.left=n,this.right=i,this.rightOrigin=o,this.parent=a,this.parentSub=h,this.redone=null,this.content=g,this.info=this.content.isCountable()?2:0}set marker(t){(this.info&8)>0!==t&&(this.info^=8)}get marker(){return(this.info&8)>0}get keep(){return(this.info&1)>0}set keep(t){this.keep!==t&&(this.info^=1)}get countable(){return(this.info&2)>0}get deleted(){return(this.info&4)>0}set deleted(t){this.deleted!==t&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ot(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ot(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ce&&this.id.client!==this.parent.client&&this.parent.clock>=ot(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Di(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=kt(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===At||this.right&&this.right.constructor===At)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===e?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===e&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===ce){let r=qe(n,this.parent);r.constructor===At?this.parent=null:this.parent=r.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=Di(t,t.doc.store,$(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;let o=new Set,a=new Set;for(;i!==null&&i!==this.right;){if(a.add(i),o.add(i),$e(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,o.clear();else if($e(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&a.has(qe(t.doc.store,i.origin)))o.has(qe(t.doc.store,i.origin))||(r=i,o.clear());else break;i=i.right}this.left=r}if(this.left!==null){let r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Kc(t.doc.store,this),this.content.integrate(t,this),Lc(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new At(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:$(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&$e(t.origin,this.lastId)&&this.right===t&&$e(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){let n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){let n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),pr(t.deleteSet,this.id.client,this.id.clock,this.length),Lc(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw wt();this.content.gc(t),n?pu(t,this,new At(this.id,this.length)):this.content=new On(this.length)}write(t,n){let r=n>0?$(this.id.client,this.id.clock+n-1):this.origin,i=this.rightOrigin,o=this.parentSub,a=this.content.getRef()&31|(r===null?0:128)|(i===null?0:64)|(o===null?0:32);if(t.writeInfo(a),r!==null&&t.writeLeftID(r),i!==null&&t.writeRightID(i),r===null&&i===null){let h=this.parent;if(h._item!==void 0){let g=h._item;if(g===null){let l=Wi(h);t.writeParentInfo(!0),t.writeString(l)}else t.writeParentInfo(!1),t.writeLeftID(g.id)}else h.constructor===String?(t.writeParentInfo(!0),t.writeString(h)):h.constructor===ce?(t.writeParentInfo(!1),t.writeLeftID(h)):wt();o!==null&&t.writeString(o)}this.content.write(t,n)}},Aa=(e,t)=>ad[t&31](e),ad=[()=>{wt()},Wu,Ku,Hu,Qu,zu,Gu,cd,Xu,Yu,()=>{wt()}],ld=10,St=class extends Dn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){wt()}write(t,n){t.writeInfo(ld),N(t.restEncoder,this.length-n)}getMissing(t,n){return null}},Ta=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},Ua="__ $YJS$ __";Ta[Ua]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Ta[Ua]=!0;var en=e=>ie((t,n)=>{e.onerror=r=>n(new Error(r.target.error)),e.onsuccess=r=>t(r.target.result)}),Ra=(e,t)=>ie((n,r)=>{let i=indexedDB.open(e);i.onupgradeneeded=o=>t(o.target.result),i.onerror=o=>r(gt(o.target.error)),i.onsuccess=o=>{let a=o.target.result;a.onversionchange=()=>{a.close()},n(a)}}),Ia=e=>en(indexedDB.deleteDatabase(e)),Da=(e,t)=>t.forEach(n=>e.createObjectStore.apply(e,n)),Mn=(e,t,n="readwrite")=>{let r=e.transaction(t,n);return t.map(i=>fd(r,i))},Zi=(e,t)=>en(e.count(t)),Oa=(e,t)=>en(e.get(t)),to=(e,t)=>en(e.delete(t)),La=(e,t,n)=>en(e.put(t,n));var Ns=(e,t)=>en(e.add(t)),Na=(e,t,n)=>en(e.getAll(t,n));var hd=(e,t,n)=>{let r=null;return dd(e,t,i=>(r=i,!1),n).then(()=>r)},Ma=(e,t=null)=>hd(e,t,"prev");var ud=(e,t)=>ie((n,r)=>{e.onerror=r,e.onsuccess=async i=>{let o=i.target.result;if(o===null||await t(o)===!1)return n();o.continue()}});var dd=(e,t,n,r="next")=>ud(e.openKeyCursor(t,r),i=>n(i.key)),fd=(e,t)=>e.objectStore(t);var Ba=(e,t)=>IDBKeyRange.upperBound(e,t),Va=(e,t)=>IDBKeyRange.lowerBound(e,t);var eo="custom",Fa="updates",ja=500,Pa=(e,t=()=>{},n=()=>{})=>{let[r]=Mn(e.db,[Fa]);return Na(r,Va(e._dbref,!1)).then(i=>{e._destroyed||(t(r),tt(e.doc,()=>{i.forEach(o=>vr(e.doc,o))},e,!1),n(r))}).then(()=>Ma(r).then(i=>{e._dbref=i+1})).then(()=>Zi(r).then(i=>{e._dbsize=i})).then(()=>r)},gd=(e,t=!0)=>Pa(e).then(n=>{(t||e._dbsize>=ja)&&Ns(n,Ln(e.doc)).then(()=>to(n,Ba(e._dbref,!0))).then(()=>Zi(n).then(r=>{e._dbsize=r}))});var Ms=class extends pe{constructor(t,n){super(),this.doc=n,this.name=t,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=Ra(t,r=>Da(r,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=ie(r=>this.on("synced",()=>r(this))),this._db.then(r=>{this.db=r,Pa(this,a=>Ns(a,Ln(n)),()=>{if(this._destroyed)return this;this.synced=!0,this.emit("synced",[this])})}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(r,i)=>{if(this.db&&i!==this){let[o]=Mn(this.db,[Fa]);Ns(o,r),++this._dbsize>=ja&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{gd(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},n.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),n.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(t=>{t.close()})}clearData(){return this.destroy().then(()=>{Ia(this.name)})}get(t){return this._db.then(n=>{let[r]=Mn(n,[eo],"readonly");return Oa(r,t)})}set(t,n){return this._db.then(r=>{let[i]=Mn(r,[eo]);return La(i,n,t)})}del(t){return this._db.then(n=>{let[r]=Mn(n,[eo]);return to(r,t)})}};var md=1200,yd=2500,Bs=3e4,no=e=>{if(e.shouldConnect&&e.ws===null){let t=new WebSocket(e.url),n=e.binaryType,r=null;n&&(t.binaryType=n),e.ws=t,e.connecting=!0,e.connected=!1,t.onmessage=a=>{e.lastMessageReceived=bt();let h=a.data,g=typeof h=="string"?JSON.parse(h):h;g&&g.type==="pong"&&(clearTimeout(r),r=setTimeout(o,Bs/2)),e.emit("message",[g,e])};let i=a=>{e.ws!==null&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:a},e])):e.unsuccessfulReconnects++,setTimeout(no,ge(vo(e.unsuccessfulReconnects+1)*md,yd),e)),clearTimeout(r)},o=()=>{e.ws===t&&e.send({type:"ping"})};t.onclose=()=>i(null),t.onerror=a=>i(a),t.onopen=()=>{e.lastMessageReceived=bt(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),r=setTimeout(o,Bs/2)}}},Vs=class extends pe{constructor(t,{binaryType:n}={}){super(),this.url=t,this.ws=null,this.binaryType=n||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&Bs<bt()-this.lastMessageReceived&&this.ws.close()},Bs/2),no(this)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&no(this)}};var $a=new Map,ro=class{constructor(t){this.room=t,this.onmessage=null,this._onChange=n=>n.key===t&&this.onmessage!==null&&this.onmessage({data:Gr(n.newValue||"")}),Fo(this._onChange)}postMessage(t){qr.setItem(this.room,zr(Zo(t)))}close(){jo(this._onChange)}},bd=typeof BroadcastChannel>"u"?ro:BroadcastChannel,so=e=>lt($a,e,()=>{let t=Nt(),n=new bd(e);return n.onmessage=r=>t.forEach(i=>i(r.data,"broadcastchannel")),{bc:n,subs:t}}),Fs=(e,t)=>(so(e).subs.add(t),t),js=(e,t)=>{let n=so(e),r=n.subs.delete(t);return r&&n.subs.size===0&&(n.bc.close(),$a.delete(e)),r},he=(e,t,n=null)=>{let r=so(e);r.bc.postMessage(t),r.subs.forEach(i=>i(t,n))};var Ha=()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else n!==void 0&&n()}};var tl=wl(Ya(),1);var Ps=0,Bn=1,za=2,nn=(e,t)=>{N(e,Ps);let n=Hi(t);Q(e,n)},Ar=(e,t,n)=>{N(e,Bn),Q(e,Ln(t,n))},_d=(e,t,n)=>Ar(t,n,it(e)),Ga=(e,t,n,r)=>{try{vr(t,it(e),n)}catch(i){r?.(i),console.error("Caught error while handling a Yjs update",i)}},$s=(e,t)=>{N(e,za),Q(e,t)},xd=Ga,qs=(e,t,n,r,i)=>{let o=j(e);switch(o){case Ps:_d(e,t,n);break;case Bn:Ga(e,n,r,i);break;case za:xd(e,n,r,i);break;default:throw new Error("Unknown message type")}return o};var Ur={};bo(Ur,{Awareness:()=>rn,applyAwarenessUpdate:()=>Tr,encodeAwarenessUpdate:()=>Ft,modifyAwarenessUpdate:()=>Sd,outdatedTimeout:()=>Hs,removeAwarenessStates:()=>Ae});var Hs=3e4,rn=class extends pe{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{let n=bt();this.getLocalState()!==null&&Hs/2<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());let r=[];this.meta.forEach((i,o)=>{o!==this.clientID&&Hs<=n-i.lastUpdated&&this.states.has(o)&&r.push(o)}),r.length>0&&Ae(this,r,"timeout")},pt(Hs/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){let n=this.clientID,r=this.meta.get(n),i=r===void 0?0:r.clock+1,o=this.states.get(n);t===null?this.states.delete(n):this.states.set(n,t),this.meta.set(n,{clock:i,lastUpdated:bt()});let a=[],h=[],g=[],l=[];t===null?l.push(n):o==null?t!=null&&a.push(n):(h.push(n),be(o,t)||g.push(n)),(a.length>0||g.length>0||l.length>0)&&this.emit("change",[{added:a,updated:g,removed:l},"local"]),this.emit("update",[{added:a,updated:h,removed:l},"local"])}setLocalStateField(t,n){let r=this.getLocalState();r!==null&&this.setLocalState({...r,[t]:n})}getStates(){return this.states}},Ae=(e,t,n)=>{let r=[];for(let i=0;i<t.length;i++){let o=t[i];if(e.states.has(o)){if(e.states.delete(o),o===e.clientID){let a=e.meta.get(o);e.meta.set(o,{clock:a.clock+1,lastUpdated:bt()})}r.push(o)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},n]),e.emit("update",[{added:[],updated:[],removed:r},n]))},Ft=(e,t,n=e.states)=>{let r=t.length,i=G();N(i,r);for(let o=0;o<r;o++){let a=t[o],h=n.get(a)||null,g=e.meta.get(a).clock;N(i,a),N(i,g),vt(i,JSON.stringify(h))}return H(i)},Sd=(e,t)=>{let n=nt(e),r=G(),i=j(n);N(r,i);for(let o=0;o<i;o++){let a=j(n),h=j(n),g=JSON.parse(_t(n)),l=t(g);N(r,a),N(r,h),vt(r,JSON.stringify(l))}return H(r)},Tr=(e,t,n)=>{let r=nt(t),i=bt(),o=[],a=[],h=[],g=[],l=j(r);for(let u=0;u<l;u++){let f=j(r),p=j(r),y=JSON.parse(_t(r)),w=e.meta.get(f),v=e.states.get(f),R=w===void 0?0:w.clock;(R<p||R===p&&y===null&&e.states.has(f))&&(y===null?f===e.clientID&&e.getLocalState()!=null?p++:e.states.delete(f):e.states.set(f,y),e.meta.set(f,{clock:p,lastUpdated:i}),w===void 0&&y!==null?o.push(f):w!==void 0&&y===null?g.push(f):y!==null&&(be(y,v)||h.push(f),a.push(f)))}(o.length>0||h.length>0||g.length>0)&&e.emit("change",[{added:o,updated:h,removed:g},n]),(o.length>0||a.length>0||g.length>0)&&e.emit("update",[{added:o,updated:a,removed:g},n])};var Ja=(e,t)=>{let n=Gn(e).buffer,r=Gn(t).buffer;return crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]).then(i=>crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},oo=(e,t)=>{if(!t)return tr(e);let n=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,e).then(r=>{let i=G();return vt(i,"AES-GCM"),Q(i,n),Q(i,new Uint8Array(r)),H(i)})},Xa=(e,t)=>{let n=G();return me(n,e),oo(H(n),t)},co=(e,t)=>{if(!t)return tr(e);let n=nt(e);_t(n)!=="AES-GCM"&&Bo(gt("Unknown encryption algorithm"));let i=it(n),o=it(n);return crypto.subtle.decrypt({name:"AES-GCM",iv:i},t,o).then(a=>new Uint8Array(a))},Qa=(e,t)=>co(e,t).then(n=>we(nt(new Uint8Array(n))));var Lt=xc("y-webrtc"),Vn=0,el=3,Rr=1,po=4,Ws=new Map,sn=new Map,nl=e=>{let t=!0;e.webrtcConns.forEach(n=>{n.synced||(t=!1)}),(!t&&e.synced||t&&!e.synced)&&(e.synced=t,e.provider.emit("synced",[{synced:t}]),Lt("synced ",Ct,e.name,qt," with all peers"))},rl=(e,t,n)=>{let r=nt(t),i=G(),o=j(r);if(e===void 0)return null;let a=e.awareness,h=e.doc,g=!1;switch(o){case Vn:{N(i,Vn);let l=qs(r,i,h,e);l===Bn&&!e.synced&&n(),l===Ps&&(g=!0);break}case el:N(i,Rr),Q(i,Ft(a,Array.from(a.getStates().keys()))),g=!0;break;case Rr:Tr(a,it(r),e);break;case po:{let l=se(r)===1,u=_t(r);if(u!==e.peerId&&(e.bcConns.has(u)&&!l||!e.bcConns.has(u)&&l)){let f=[],p=[];l?(e.bcConns.add(u),p.push(u)):(e.bcConns.delete(u),f.push(u)),e.provider.emit("peers",[{added:p,removed:f,webrtcPeers:Array.from(e.webrtcConns.keys()),bcPeers:Array.from(e.bcConns)}]),sl(e)}break}default:return console.error("Unable to compute message"),i}return g?i:null},vd=(e,t)=>{let n=e.room;return Lt("received message from ",Ct,e.remotePeerId,Tn," (",n.name,")",qt,Pe),rl(n,t,()=>{e.synced=!0,Lt("synced ",Ct,n.name,qt," with ",Ct,e.remotePeerId),nl(n)})},ao=(e,t)=>{Lt("send message to ",Ct,e.remotePeerId,qt,Tn," (",e.room.name,")",Pe);try{e.peer.send(H(t))}catch{}},Cd=(e,t)=>{Lt("broadcast message in ",Ct,e.name,qt),e.webrtcConns.forEach(n=>{try{n.peer.send(t)}catch{}})},Ys=class{constructor(t,n,r,i){Lt("establishing connection to ",Ct,r),this.room=i,this.remotePeerId=r,this.glareToken=void 0,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new tl.default({initiator:n,...i.provider.peerOpts}),this.peer.on("signal",o=>{this.glareToken===void 0&&(this.glareToken=Date.now()+Math.random()),go(t,i,{to:r,from:i.peerId,type:"signal",token:this.glareToken,signal:o})}),this.peer.on("connect",()=>{Lt("connected to ",Ct,r),this.connected=!0;let a=i.provider.doc,h=i.awareness,g=G();N(g,Vn),nn(g,a),ao(this,g);let l=h.getStates();if(l.size>0){let u=G();N(u,Rr),Q(u,Ft(h,Array.from(l.keys()))),ao(this,u)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,i.webrtcConns.has(this.remotePeerId)&&(i.webrtcConns.delete(this.remotePeerId),i.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}])),nl(i),this.peer.destroy(),Lt("closed connection to ",Ct,r),ho(i)}),this.peer.on("error",o=>{Lt("Error in connection to ",Ct,r,": ",o),ho(i)}),this.peer.on("data",o=>{let a=vd(this,o);a!==null&&ao(this,a)})}destroy(){this.peer.destroy()}},Te=(e,t)=>oo(t,e.key).then(n=>e.mux(()=>he(e.name,n))),Za=(e,t)=>{e.bcconnected&&Te(e,t),Cd(e,t)},ho=e=>{Ws.forEach(t=>{t.connected&&(t.send({type:"subscribe",topics:[e.name]}),e.webrtcConns.size<e.provider.maxConns&&go(t,e,{type:"announce",from:e.peerId}))})},sl=e=>{if(e.provider.filterBcConns){let t=G();N(t,po),re(t,1),vt(t,e.peerId),Te(e,H(t))}},uo=class{constructor(t,n,r,i){this.peerId=$r(),this.doc=t,this.awareness=n.awareness,this.provider=n,this.synced=!1,this.name=r,this.key=i,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=Ha(),this.bcconnected=!1,this._bcSubscriber=o=>co(new Uint8Array(o),i).then(a=>this.mux(()=>{let h=rl(this,a,()=>{});h&&Te(this,H(h))})),this._docUpdateHandler=(o,a)=>{let h=G();N(h,Vn),$s(h,o),Za(this,H(h))},this._awarenessUpdateHandler=({added:o,updated:a,removed:h},g)=>{let l=o.concat(a).concat(h),u=G();N(u,Rr),Q(u,Ft(this.awareness,l)),Za(this,H(u))},this._beforeUnloadHandler=()=>{Ae(this.awareness,[t.clientID],"window unload"),sn.forEach(o=>{o.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),ho(this);let t=this.name;Fs(t,this._bcSubscriber),this.bcconnected=!0,sl(this);let n=G();N(n,Vn),nn(n,this.doc),Te(this,H(n));let r=G();N(r,Vn),Ar(r,this.doc),Te(this,H(r));let i=G();N(i,el),Te(this,H(i));let o=G();N(o,Rr),Q(o,Ft(this.awareness,[this.doc.clientID])),Te(this,H(o))}disconnect(){Ws.forEach(n=>{n.connected&&n.send({type:"unsubscribe",topics:[this.name]})}),Ae(this.awareness,[this.doc.clientID],"disconnect");let t=G();N(t,po),re(t,0),vt(t,this.peerId),Te(this,H(t)),js(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(n=>n.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}},kd=(e,t,n,r)=>{if(sn.has(n))throw gt(`A Yjs Doc connected to room "${n}" already exists!`);let i=new uo(e,t,n,r);return sn.set(n,i),i},go=(e,t,n)=>{t.key?Xa(n,t.key).then(r=>{e.send({type:"publish",topic:t.name,data:zr(r)})}):e.send({type:"publish",topic:t.name,data:n})},fo=class extends Vs{constructor(t){super(t),this.providers=new Set,this.on("connect",()=>{Lt(`connected (${t})`);let n=Array.from(sn.keys());this.send({type:"subscribe",topics:n}),sn.forEach(r=>go(this,r,{type:"announce",from:r.peerId}))}),this.on("message",n=>{switch(n.type){case"publish":{let r=n.topic,i=sn.get(r);if(i==null||typeof r!="string")return;let o=a=>{let h=i.webrtcConns,g=i.peerId;if(a==null||a.from===g||a.to!==void 0&&a.to!==g||i.bcConns.has(a.from))return;let l=h.has(a.from)?()=>{}:()=>i.provider.emit("peers",[{removed:[],added:[a.from],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}]);switch(a.type){case"announce":h.size<i.provider.maxConns&&(lt(h,a.from,()=>new Ys(this,!0,a.from,i)),l());break;case"signal":if(a.signal.type==="offer"){let u=h.get(a.from);if(u){let f=a.token,p=u.glareToken;if(p&&p>f){Lt("offer rejected: ",a.from);return}u.glareToken=void 0}}if(a.signal.type==="answer"){Lt("offer answered by: ",a.from);let u=h.get(a.from);u.glareToken=void 0}a.to===g&&(lt(h,a.from,()=>new Ys(this,!1,a.from,i)).peer.signal(a.signal),l());break}};i.key?typeof n.data=="string"&&Qa(Gr(n.data),i.key).then(o):o(n.data)}}}),this.on("disconnect",()=>Lt(`disconnect (${t})`))}},lo=e=>{e.emit("status",[{connected:e.connected}])},zs=class extends Wt{constructor(t,n,{signaling:r=["wss://y-webrtc-eu.fly.dev"],password:i=null,awareness:o=new rn(n),maxConns:a=20+pt(No()*15),filterBcConns:h=!0,peerOpts:g={}}={}){super(),this.roomName=t,this.doc=n,this.filterBcConns=h,this.awareness=o,this.shouldConnect=!1,this.signalingUrls=r,this.signalingConns=[],this.maxConns=a,this.peerOpts=g,this.key=i?Ja(i,t):tr(null),this.room=null,this.key.then(l=>{this.room=kd(n,this,t,l),this.shouldConnect?this.room.connect():this.room.disconnect(),lo(this)}),this.connect(),this.destroy=this.destroy.bind(this),n.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{let n=lt(Ws,t,()=>new fo(t));this.signalingConns.push(n),n.providers.add(this)}),this.room&&(this.room.connect(),lo(this))}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(t=>{t.providers.delete(this),t.providers.size===0&&(t.destroy(),Ws.delete(t.url))}),this.room&&(this.room.disconnect(),lo(this))}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),sn.delete(this.roomName)}),super.destroy()}};var Ad=0;var il=(e,t,n)=>{j(e)===Ad&&n(t,_t(e))};var ol=e=>Wo(e,(t,n)=>`${encodeURIComponent(n)}=${encodeURIComponent(t)}`).join("&");var on=0,al=3,Fn=1,Rd=2,Ir=[];Ir[on]=(e,t,n,r,i)=>{N(e,on);let o=qs(t,e,n.doc,n);r&&o===Bn&&!n.synced&&(n.synced=!0)};Ir[al]=(e,t,n,r,i)=>{N(e,Fn),Q(e,Ft(n.awareness,Array.from(n.awareness.getStates().keys())))};Ir[Fn]=(e,t,n,r,i)=>{Tr(n.awareness,it(t),n)};Ir[Rd]=(e,t,n,r,i)=>{il(t,n.doc,(o,a)=>Id(n,a))};var cl=3e4,Id=(e,t)=>console.warn(`Permission denied to access ${e.url}.
${t}`),ll=(e,t,n)=>{let r=nt(t),i=G(),o=j(r),a=e.messageHandlers[o];return a?a(i,r,e,n,o):console.error("Unable to compute message"),i},yo=(e,t,n)=>{t===e.ws&&(e.emit("connection-close",[n,e]),e.ws=null,t.close(),e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,Ae(e.awareness,Array.from(e.awareness.getStates().keys()).filter(r=>r!==e.doc.clientID),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,setTimeout(hl,ge(Co(2,e.wsUnsuccessfulReconnects)*100,e.maxBackoffTime),e))},hl=e=>{if(e.shouldConnect&&e.ws===null){let t=new e._WS(e.url,e.protocols);t.binaryType="arraybuffer",e.ws=t,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,t.onmessage=n=>{e.wsLastMessageReceived=bt();let r=ll(e,new Uint8Array(n.data),!0);jr(r)>1&&t.send(H(r))},t.onerror=n=>{e.emit("connection-error",[n,e])},t.onclose=n=>{yo(e,t,n)},t.onopen=()=>{e.wsLastMessageReceived=bt(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);let n=G();if(N(n,on),nn(n,e.doc),t.send(H(n)),e.awareness.getLocalState()!==null){let r=G();N(r,Fn),Q(r,Ft(e.awareness,[e.doc.clientID])),t.send(H(r))}},e.emit("status",[{status:"connecting"}])}},mo=(e,t)=>{let n=e.ws;e.wsconnected&&n&&n.readyState===n.OPEN&&n.send(t),e.bcconnected&&he(e.bcChannel,t,e)},Gs=class extends Wt{constructor(t,n,r,{connect:i=!0,awareness:o=new rn(r),params:a={},protocols:h=[],WebSocketPolyfill:g=WebSocket,resyncInterval:l=-1,maxBackoffTime:u=2500,disableBc:f=!1}={}){for(super();t[t.length-1]==="/";)t=t.slice(0,t.length-1);this.serverUrl=t,this.bcChannel=t+"/"+n,this.maxBackoffTime=u,this.params=a,this.protocols=h,this.roomname=n,this.doc=r,this._WS=g,this.awareness=o,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.disableBc=f,this.wsUnsuccessfulReconnects=0,this.messageHandlers=Ir.slice(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=i,this._resyncInterval=0,l>0&&(this._resyncInterval=setInterval(()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){let p=G();N(p,on),nn(p,r),this.ws.send(H(p))}},l)),this._bcSubscriber=(p,y)=>{if(y!==this){let w=ll(this,new Uint8Array(p),!1);jr(w)>1&&he(this.bcChannel,H(w),this)}},this._updateHandler=(p,y)=>{if(y!==this){let w=G();N(w,on),$s(w,p),mo(this,H(w))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:p,updated:y,removed:w},v)=>{let R=p.concat(y).concat(w),m=G();N(m,Fn),Q(m,Ft(o,R)),mo(this,H(m))},this._exitHandler=()=>{Ae(this.awareness,[r.clientID],"app closed")},oe&&typeof process<"u"&&process.on("exit",this._exitHandler),o.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval(()=>{this.wsconnected&&cl<bt()-this.wsLastMessageReceived&&yo(this,this.ws,null)},cl/10),i&&this.connect()}get url(){let t=ol(this.params);return this.serverUrl+"/"+this.roomname+(t.length===0?"":"?"+t)}get synced(){return this._synced}set synced(t){this._synced!==t&&(this._synced=t,this.emit("synced",[t]),this.emit("sync",[t]))}destroy(){this._resyncInterval!==0&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),oe&&typeof process<"u"&&process.off("exit",this._exitHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){if(this.disableBc)return;this.bcconnected||(Fs(this.bcChannel,this._bcSubscriber),this.bcconnected=!0);let t=G();N(t,on),nn(t,this.doc),he(this.bcChannel,H(t),this);let n=G();N(n,on),Ar(n,this.doc),he(this.bcChannel,H(n),this);let r=G();N(r,al),he(this.bcChannel,H(r),this);let i=G();N(i,Fn),Q(i,Ft(this.awareness,[this.doc.clientID])),he(this.bcChannel,H(i),this)}disconnectBc(){let t=G();N(t,Fn),Q(t,Ft(this.awareness,[this.doc.clientID],new Map)),mo(this,H(t)),this.bcconnected&&(js(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),this.ws!==null&&yo(this,this.ws,null)}connect(){this.shouldConnect=!0,!this.wsconnected&&this.ws===null&&(hl(this),this.connectBc())}};window.Y=kr;window.IndexeddbPersistence=Ms;window.WebrtcProvider=zs;window.WebsocketProvider=Gs;window.awarenessProtocol=Ur;window.yjsModulesLoaded=!0;window.dispatchEvent(new Event("yjsModulesLoaded"));})();
/*! Bundled license information:

simple-peer/simplepeer.min.js:
  (*!
  * The buffer module from node.js, for the browser.
  *
  * @author   Feross Aboukhadijeh <https://feross.org>
  * @license  MIT
  *)
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
